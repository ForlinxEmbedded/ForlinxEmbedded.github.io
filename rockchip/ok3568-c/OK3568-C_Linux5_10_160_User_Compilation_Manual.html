

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>00_OK3568-C_Linux5.10.160+QT5.15.8用户编译手册 &mdash; Forlinx Embedded RK3568 Documentation  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/theme-switcher.css?v=a3c71d8a" />

  
    <link rel="shortcut icon" href="_static/forlinx.png"/>
    <link rel="canonical" href="https://forlinxembedded.github.io/rockchip/ok3568-c/OK3568-C_Linux5_10_160_User_Compilation_Manual.html" />
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/theme-switcher.js?v=950663c4"></script>
      <script src="_static/logo-link.js?v=d4af6ba6"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Linux5.10.160_User’s Manual" href="OK3568-C_Linux5_10_160_User_Manual.html" />
   

  <!-- Load Font Awesome from CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-N8EJPNL8NR"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-N8EJPNL8NR');
  </script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/forlinx-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">SOFTWARE</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="OK3568-C_Linux5_10_160_User_Manual.html">Linux5.10.160_User’s Manual</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">00_OK3568-C_Linux5.10.160+QT5.15.8用户编译手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="#id1"><font style="color:#000000;">概  述</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="#id2"><font style="color:#000000;">更新记录</font></a></li>
<li class="toctree-l1"><a class="reference internal" href="#vmware">01_VMware虚拟机软件安装</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id3">1.1 VMware软件的下载与购买</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id4">1.2 VMware软件的安装</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#ubuntu">02_加载已有ubuntu开发环境</a></li>
<li class="toctree-l1"><a class="reference internal" href="#id5">03_搭建新的ubuntu开发环境</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id6">3.1 ubuntu系统搭建</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id7">3.1.1 创建ubuntu虚拟机</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id8">3.1.2 系统安装</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">3.1.3 Ubuntu的基本配置</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id10">3.1.4 Ubuntu的网络设置</a></li>
<li class="toctree-l3"><a class="reference internal" href="#u">3.1.5 U盘的加载</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id11">3.1.6 虚拟机基本库安装</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ok3568-linux">3.1.7 编译OK3568 Linux源码必要库安装</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id12">3.1.8 增大交换分区</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#qt-creator">3.2 Qt Creator安装</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#id13">04_相关代码编译</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id14">4.1编译前准备</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id15">4.1.1 环境说明</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id16">4.1.2 拷贝源码</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id17">4.2 内核编译</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id18">4.2.1 全编译测试</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id19">4.2.2 单独编译测试</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id20">4.2.3 交叉编译链位置</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#image">4.3 Image文件的使用</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id21">4.4 Qt Creator环境配置</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id22">4.4.1 交叉编译器配置</a></li>
<li class="toctree-l3"><a class="reference internal" href="#qt-versions">4.4.2 Qt Versions 配置</a></li>
<li class="toctree-l3"><a class="reference internal" href="#kits">4.4.3 Kits 配置</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id23">4.5 应用程序编译及运行</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id24">4.5.1 编译并运行命令行应用</a></li>
<li class="toctree-l3"><a class="reference internal" href="#qt">4.5.2 编译并运行QT应用程序</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Forlinx Embedded RK3568 Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">00_OK3568-C_Linux5.10.160+QT5.15.8用户编译手册</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="ok3568-c-linux5-10-160-qt5-15-8">
<h1>00_OK3568-C_Linux5.10.160+QT5.15.8用户编译手册<a class="headerlink" href="#ok3568-c-linux5-10-160-qt5-15-8" title="Link to this heading"></a></h1>
<p><font style="color:#000000;">免责声明</font></p>
<p><font style="color:#000000;">本手册版权归保定飞凌嵌入式技术有限公司所有。未经本公司的书面许可，任何单位和个人无权以任何形式复制、传播、转载本手册的任何部分，违者将被追究法律责任。</font></p>
<p><font style="color:#000000;">保定飞凌嵌入式有限公司所提供的所有服务内容旨在协助用户加速产品的研发进度，在服务过程中所提供的任何程序、文档、测试结果、方案、支持等资料和信息，都仅供参考，用户有权不使用或自行参考修改，本公司不提供任何的完整性、可靠性等保证，若在用户使用过程中因任何原因造成的特别的、偶然的或间接的损失，本公司不承担任何责任。 </font></p>
</section>
<section id="id1">
<h1><font style="color:#000000;">概  述</font><a class="headerlink" href="#id1" title="Link to this heading"></a></h1>
<p><font style="color:#333333;">本手册是为了让使用飞凌嵌入式开发板的人员能够快速了解飞凌产品的编译过程，熟悉飞凌产品的编译方式。应用程序需要在</font><font style="color:#000000;">linux操作系统</font><font style="color:#333333;">上先进行交叉编译，才能在开发板上运行，</font><font style="color:#000000;">按照编译手册上的方法，通过实际操作，用户能够完成自己软件代码的编译。</font></p>
<p><font style="color:#000000;">手册会从环境搭建进行说明，环境搭建过程可能会出现一些不可预见的问题，建议初学者直接使用我们搭建好的开发环境，可以快速上手，缩短开发时间。</font></p>
<p><font style="color:#000000;">Linux系统通常情况下有三种安装方式：真机双系统、真机单系统、虚拟机。不同安装方式都有其优缺点，本文仅提供在虚拟机中搭建ubuntu的方法。</font><font style="color:#000000;">计算机硬件要求：建议内存至少在6GB及以上，这样在给虚拟机分一部内存运行的同时（虚拟机建议2GB以上），还可以在Windows做其他操作，否则会影响到Windows的操作。</font></p>
<ul class="simple">
<li><p><font style="color:#000000;">在内容上手册主要分为4个章节描述：</font></p></li>
<li><p><font style="color:#000000;">第一章主要是VMware的安装，选用的版本为VMware</font>®<font style="color:#000000;"> Workstation 15 Pro15.1.0，用户在使用ubuntu开发环境之前要先安装VMware 。</font></p></li>
<li><p><font style="color:#000000;">第二章主要是加载飞凌提供的ubuntu开发环境的方法，开发环境为64位ubuntu20.04。</font></p></li>
<li><p><font style="color:#000000;">第三章主要是搭建新的ubuntu开发环境的方法。本节选用的64位ubuntu20.04为例，描述了ubuntu的创建，由于电脑配置不同，搭建过程可能会出现预料之外的问题，建议初学者直接使用我们搭建好的环境。</font></p></li>
<li><p><font style="color:#000000;">第四章主要是开发板相关源码编译方法。</font></p></li>
<li><p><font style="color:#000000;">本手册中一些符号及格式的相关说明：</font></p></li>
</ul>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p><strong>表现形式</strong></p></th>
<th class="head"><p><strong>含义</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>⁉️</p></td>
<td><p><font style="color:#000000;">注意或者是需要特别关注的信息，一定要仔细阅读</font></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>📚</p></td>
<td><p><font style="color:#000000;">对测试章节做的相关说明</font></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>🛤️</p></td>
<td><p><font style="color:#000000;">表示相关路径</font></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><font style="color:blue;">蓝色字体</font></p></td>
<td><p><font style="color:#000000;">指在命令行输入的命令，需要手动输入</font></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><font style="color:black;">黑色字体</font></p></td>
<td><p>输入命令后的串口输出信息</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><strong><font style="color:black;">黑色加粗</font></strong></p></td>
<td><p><font style="color:#000000;">串口输出信息中的关键信息</font></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><font style="color:#000000;">//</font></p></td>
<td><p><font style="color:#000000;">对输入指令或输出信息的解释内容</font></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><font style="color:#000000;">用户名&#64;主机名</font></p></td>
<td><p><font style="color:#000000;">root&#64;ok3568 ：开发板串口登录账户信息，</font><br/><font style="color:#000000;">forlinx&#64;ok3568：开发板网络登录账户信息</font><br/><font style="color:#000000;">forlinx&#64;ubuntu  ：开发环境ubuntu账户信息</font><br/><font style="color:#000000;">用户可通过该信息确定功能操作的环境</font></p></td>
</tr>
</tbody>
</table>
<p><font style="color:#000000;">例：打包文件系统后，使用ls查看生成文件的操作</font></p>
<div class="highlight-markdown notranslate"><div class="highlight"><pre><span></span>forlinx@ubuntu:~/3568$ ls                                  //列出该目录下的文件
OK3568_Linux_fs  OK3568_Linux_fs.tar.bz2.00 OK3568_Linux_fs.tar.bz2.01 OK3568_Linux_fs.tar.bz2.02 OK3568_Linux_fs.tar.bz2.03
</pre></div>
</div>
<ul class="simple">
<li><p><font style="color:#000000;">forlinx&#64;ubuntu：用户名为forlinx，主机名为ubuntu，表示在开发环境ubuntu中进行操作。</font></p></li>
<li><p><font style="color:#000000;">// ：对操作指令的解释说明内容，不需要输入</font></p></li>
<li><p><font style="color:#0000FF;">ls</font><font style="color:#000000;">：灰底蓝色字体，表示需要手动输入的相关命令</font></p></li>
<li><p><strong>OK3568_Linux_fs：</strong><font style="color:#000000;">底黑色字体为输入命令后的输出信息，加粗字体为关键信息，此处为打包后的文件系统。</font></p></li>
</ul>
</section>
<section id="id2">
<h1><font style="color:#000000;">更新记录</font><a class="headerlink" href="#id2" title="Link to this heading"></a></h1>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p><font style="color:#000000;">日期</font></p></th>
<th class="head text-center"><p><font style="color:#000000;">手册版本</font></p></th>
<th class="head"><p><font style="color:#000000;">更新记录</font></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><font style="color:#000000;">2023.10.21</font></p></td>
<td class="text-center"><p><font style="color:#000000;">V1.0</font></p></td>
<td><p><font style="color:#000000;">OK3568用户编译手册第一版；</font><br/><font style="color:#000000;">注：本编译手册只适用于飞凌公司的OK3568 开发板</font></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><font style="color:#000000;">2023.12.11</font></p></td>
<td class="text-center"><p><font style="color:#000000;">V1.1</font></p></td>
<td><p><font style="color:#000000;">更新单独编译buildroot 的指令</font></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p><font style="color:#000000;">2024.03.01</font></p></td>
<td class="text-center"><p><font style="color:#000000;">V1.2</font></p></td>
<td><p><font style="color:#000000;">修复手册内路径问题</font></p></td>
</tr>
</tbody>
</table>
</section>
<section id="vmware">
<h1>01_VMware虚拟机软件安装<a class="headerlink" href="#vmware" title="Link to this heading"></a></h1>
<p>本章主要介绍VMware虚拟机的安装，以VMware workstation 15 Pro v15.1.0为例展示操作系统的安装配置过程。</p>
<section id="id3">
<h2>1.1 VMware软件的下载与购买<a class="headerlink" href="#id3" title="Link to this heading"></a></h2>
<p><a class="reference external" href="https://www.vmware.com/cn.html">登陆VMware官网https://www.vmware.com/cn.h</a><a class="reference external" href="https://www.vmware.com/cn.html">tml下载</a>Workstation Pro并获取产品密匙。VMware是付费软件，需要自行购买，或者使用VMware提供的试用版本。</p>
<p><img alt="Image" src="_images/1719278513268_e1e3d73c_ea58_4db6_86b2_2bcb430bf195.png" /></p>
<p>等待下载完成后双击启动文件启动安装程序。</p>
</section>
<section id="id4">
<h2>1.2 VMware软件的安装<a class="headerlink" href="#id4" title="Link to this heading"></a></h2>
<p>双击启动程序进入安装向导。</p>
<p><img alt="Image" src="_images/1719278513453_fcba4324_b61c_4700_a5a0_0dffae59dbbd.png" /></p>
<p>点击“下一步”。</p>
<p><img alt="Image" src="_images/1719278513616_4d573560_c60f_4f95_a2bf_7b0a38394f83.png" /></p>
<p>勾选我接受许可协议中的条款，点击“下一步”。</p>
<p><img alt="Image" src="_images/1719278513807_4fea4ba5_6c3f_4774_9046_4ac308ae7838.png" /></p>
<p>修改安装位置，装到自己电脑安装软件的分区，点击“下一步”。</p>
<p><img alt="Image" src="_images/1719278513983_81c57db7_35b1_4416_bb29_36120e02a747.png" /></p>
<p>勾选，点击“下一步”。</p>
<p><img alt="Image" src="_images/1719278514135_8b46b82c_621d_44fc_89d8_d33018b427f4.png" /></p>
<p>勾选添加快捷方式，点击“下一步”。</p>
<p><img alt="Image" src="_images/1719278514310_369d17b9_d01f_4d95_a676_04fb377558fd.png" /></p>
<p>点击“安装”。</p>
<p><img alt="Image" src="_images/1719278514482_82865f12_b42f_4c32_aca1_30a96a2fa309.png" /></p>
<p>等待安装完成。</p>
<p><img alt="Image" src="_images/1719278514655_325d6ab7_c6cd_4de5_a879_6248cd24fcde.png" /></p>
<p>点击完成后可进行试用。若用户需要长期使用，需要到官方购买，填写许可证。</p>
</section>
</section>
<section id="ubuntu">
<h1>02_加载已有ubuntu开发环境<a class="headerlink" href="#ubuntu" title="Link to this heading"></a></h1>
<p><font style="color:rgb(0, 0, 0);background-color:rgb(218, 234, 252);">⁉️</font><strong>注意：</strong></p>
<ul class="simple">
<li><p><strong>建议初学者直接使用飞凌搭建好的虚拟机环境。了解完该章节后可以直接跳转到编译章节。</strong></p></li>
<li><p><strong>提供开发环境的账户为：forlinx，密码为：forlinx</strong></p></li>
</ul>
<p>在VMware下使用虚拟机的环境有两种方式，一种是直接加载已有的环境，另一种是新建一个环境，我们先来说说如何加载一个已经存在的环境。</p>
<p>首先，下载飞凌提供的开发环境，开发环境资料中有MD5校验文件，用户下载完开发环境资料，先对开发环境压缩包进行MD5校验（MD5校验可以在网络上选择MD5在线工具校验，也可以下载MD5校验工具进行校验，可根据实际情况选择），查看校验码和校验文件中校验码是否一致，若一致则下载文件正常；若不一致，则文件可能有破损，需要重新下载。</p>
<p>选中压缩包一起解压</p>
<p><img alt="Image" src="_images/1719278548687_41fb4543_911d_4ce3_9b88_09f7fb114c01.png" /></p>
<p>解压完成后选中.vmx为虚拟机要打开的文件。</p>
<p>打开虚拟机，选择解压出来的3588开发环境.vmx</p>
<p><img alt="Image" src="_images/1719278548894_5a126d86_d30f_4f1c_906b_1d615fdf2e0a.png" /></p>
<p>加载完成后点击开启此虚拟机，即可运行，进入系统的界面。</p>
<p><img alt="Image" src="_images/1719278549103_fbe0d3f1_43ad_4b37_aa46_27fd9fc4a526.png" /></p>
<p><img alt="Image" src="_images/1719278549304_2128d94e_45fa_4091_83c8_678157602b7b.png" /></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>提供开发环境的账户为forlinx，密码为forlinx，填好密码后选择Sign in登录。
</pre></div>
</div>
<p><img alt="Image" src="_images/1719278549464_41fc41e5_d024_4e97_a993_d6b193bc8aae.png" /></p>
<p><img alt="Image" src="_images/1719278549733_cae28152_e433_4a1e_90ab_8a2479049af5.png" /></p>
</section>
<section id="id5">
<h1>03_搭建新的ubuntu开发环境<a class="headerlink" href="#id5" title="Link to this heading"></a></h1>
<p><font style="color:rgb(0, 0, 0);background-color:rgb(218, 234, 252);">⁉️</font><strong>注意：初学者不建议自己搭建系统，建议使用已有虚拟机环境，不需要搭建环境的此节可以跳过本章节主要讲解了ubuntu系统的搭建过程。</strong></p>
<section id="id6">
<h2>3.1 ubuntu系统搭建<a class="headerlink" href="#id6" title="Link to this heading"></a></h2>
<section id="id7">
<h3>3.1.1 创建ubuntu虚拟机<a class="headerlink" href="#id7" title="Link to this heading"></a></h3>
<p>打开VMware软件，点击创建新的虚拟机。进入以下界面：</p>
<p><img alt="Image" src="_images/1719278531825_28237039_37c8_4a5f_8597_f64b71e7e312.png" /></p>
<p>选择自定义，点击“下一步”。</p>
<p><img alt="Image" src="_images/1719278532008_920d71ea_3371_425c_9b27_a15b1789fdf9.png" /></p>
<p>选择对应VMware版本的兼容性，版本可在帮助-&gt;关于VMware Workstation中查看，点击“下一步”。</p>
<p><img alt="Image" src="_images/1719278532173_48b35578_2a3d_4aff_9888_513f9b66eaaf.png" /></p>
<p>选择稍后安装操作系统，点击“下一步”。</p>
<p><img alt="Image" src="_images/1719278532371_cd7442c7_21c1_4c8a_8463_24ea3de5f6c1.png" /></p>
<p>保持默认，点击“下一步”。</p>
<p><img alt="Image" src="_images/1719278532534_39687568_6ee3_4284_b373_2104df01f0fb.png" /></p>
<p>修改虚拟机名称及安装位置，点击“下一步”。</p>
<p><img alt="Image" src="_images/1719278532718_2cd2ea2a_0f97_46d5_ad8b_4f004e889a20.png" /></p>
<p>按照实际情况设置处理器数量。</p>
<p><img alt="Image" src="_images/1719278532900_dd3f7357_07c5_4dc4_9fd1_7d367c7a7111.png" /></p>
<p>同样按照实际情况设置内存大小，建议使用16G。</p>
<p><img alt="Image" src="_images/1719278533112_8f49bb5a_64b5_47df_8798_044888bfa83b.png" /></p>
<p>设置网络类型，默认为NAT模式，点击下一步。后面的步骤保持默认值，直到指定磁盘容量步骤。</p>
<p><img alt="Image" src="_images/1719278533381_8dc68236_561d_4840_abb7_3512def5cecf.png" /></p>
<p>IO控制器类型这里默认选择LSI就可以：</p>
<p><img alt="Image" src="_images/1719278533635_d54cda44_50e2_4643_b3d3_54dc41a1bfa6.png" /></p>
<p>这里同样是默认选择SCSI。</p>
<p><img alt="Image" src="_images/1719278533807_86b2d601_916f_4f7d_b7c0_4a672e97d659.png" /></p>
<p>这里选择创建新的虚拟磁盘：</p>
<p><img alt="Image" src="_images/1719278534036_c400a9dc_bdac_4dde_bd52_d4e721fb4ccd.png" /></p>
<p>设置磁盘大小为200G，并选择磁盘的存在形式，然后点击“下一步”完成。</p>
<p><img alt="Image" src="_images/1719278534210_b2fc7391_1c76_4148_80c8_855cd9174698.png" /></p>
<p>指定磁盘文件，这里默认即可。</p>
<p><img alt="Image" src="_images/1719278534358_9585162d_5c54_42eb_be37_f9361aebf91d.png" /></p>
<p>默认点击“完成”即可。</p>
<p><img alt="Image" src="_images/1719278534538_0cb90337_6bc8_4fc5_8009_267ab1d2617c.png" /></p>
<p>至此，虚拟机创建完成。</p>
<p>下一小节中我们介绍Ubuntu系统在虚拟机中的安装，其在真机中的安装方法与虚拟机类似。这里我们介绍在虚拟机中安装Ubuntu系统的方法。</p>
</section>
<section id="id8">
<h3>3.1.2 系统安装<a class="headerlink" href="#id8" title="Link to this heading"></a></h3>
<p>我们选择安装的Ubuntu 版本是20.04，首先去Ubuntu官网获取Ubuntu20.04 64位镜像，下载地址为：<a class="reference external" href="http://sources.ubuntu.com/20.04/">http://sources.ubuntu</a><a class="reference external" href="http://sources.ubuntu.com/20.04/">.com/20.04/</a>下载“ubuntu-20.04.6-desktop-amd64.iso”这个版本。</p>
<p><img alt="Image" src="_images/1719278534726_3aa57e5a_99a5_4638_a835_5b80b82fc03d.png" /></p>
<p>右击刚创建完成的Ubuntu64位 在弹出菜单中选择设置：</p>
<p><img alt="Image" src="_images/1719278534926_94943ef2_c4d9_4ddd_91e9_50c5088dfacc.png" /></p>
<p>弹出“虚拟机设置菜单”根据如下图：</p>
<p><img alt="Image" src="_images/1719278535121_beaef4c9_b729_4a86_8299_02e28a716d2d.png" /></p>
<p>点击CD/DVD（SATA），选择使用ISO映像文件，浏览选择前面下载的Ubuntu镜像，然后确定。</p>
<p><img alt="Image" src="_images/1719278535409_a8fcb60d_f0a2_428c_8be7_0e124dcbc137.png" /></p>
<p>设置好镜像后，保证网络可用，然后开启虚拟机，进行Ubuntu镜像的安装。</p>
<p><img alt="Image" src="_images/1719278535587_6fcfdee5_51f1_4e1c_9906_d39fc0048711.png" /></p>
<p>开启虚拟机后，等待出现安装界面如下：</p>
<p><img alt="Image" src="_images/1719278535793_fd516f0e_e8ab_4dee_9119_5ad4232b0450.png" /></p>
<p>如图左侧选择语言后,点击“Install  Ubuntu”后弹出选择语言界面。Ubuntu默认语言是英文的，当然，也可以选择中文，默认选择的语言在后期也是可以重新设置的，选择完成后continue。</p>
<p><img alt="Image" src="_images/1719278536000_eb047135_c38a_4252_8c28_ab4160903086.png" /></p>
<p>接下来，默认选择continue继续安装，安装过程会很慢，然后点击“continue”：</p>
<p><img alt="Image" src="_images/1719278536210_5beb2cde_35d4_44aa_b6b6_4e9c8e760b06.png" /></p>
<p>默认，点击Install Now，会弹出下图，点击“continue”即可。</p>
<p><img alt="Image" src="_images/1719278536401_c42c25c7_6384_4061_a7e2_76c6349c64be.png" /></p>
<p><img alt="Image" src="_images/1719278536688_120370eb_2370_46c6_805f_a2041fe0149c.png" /></p>
<p>接下来选择时区，这里点击上海时区或输入Shanghai即可（不同时区根据实际情况选择即可），点击“继续”。最后设置用户名和密码，点击“continue”就会自动安装：</p>
<p><img alt="Image" src="_images/1719278537143_ccb45ffe_9c1d_42e6_a4ae_0da143112cbf.png" /></p>
<p>安装过程下图，网络不好可以Skip跳过，不影响安装。</p>
<p><img alt="Image" src="_images/1719278537449_a7f018e6_bdb2_4867_9e95_42fa1c7d2cb1.png" /></p>
<p>安装完成后显示如下图，点击“Restart Now”重启（或者点击“重新启动客户机”）：</p>
<p><img alt="Image" src="_images/1719278537830_e34fbcf1_8a51_4008_af9d_7f58d0899130.png" /></p>
<p><img alt="Image" src="_images/1719278538153_32d91128_59b7_4c50_9745_84b3186f5a51.png" /></p>
<p>重启完成登录后系统界面如下图：</p>
<p><img alt="Image" src="_images/1719278538378_ec2e5454_98ce_4802_820d_82c55f5ae9a8.png" /></p>
</section>
<section id="id9">
<h3>3.1.3 Ubuntu的基本配置<a class="headerlink" href="#id9" title="Link to this heading"></a></h3>
<p>安装好Ubuntu20.04操作系统后，要进行一些配置。</p>
<ul class="simple">
<li><p><strong>VMware Tools安装：</strong></p></li>
</ul>
<p>接下来安装VMware Tools，如果不安装该工具，在Windows主机和虚拟机之间无法使用复制粘贴、文件拖拽。首先点击VMware 导航栏上的“虚拟机”，然后在下拉框中点击“安装VMware Tools”：</p>
<p><img alt="Image" src="_images/1719278538688_9700b495_f48a_4190_9391_8d970fdb36ec.png" /></p>
<p>完成后进入Ubuntu，桌面会出现VMware Tools的光盘图标，点击进入其中：</p>
<p><img alt="Image" src="_images/1719278538895_1625dbb7_305b_4f49_ac94_850a3b19510e.png" /></p>
<p>双击VMwareTools图标，进入后看到一个压缩文件VMwareTools-10.3.10-12406962.tar.gz（不同的虚拟机版本可能会不同），</p>
<p><img alt="Image" src="_images/1719278539134_a41b7a36_aa5c_4523_a560_8cfce32569f6.png" /></p>
<p>复制文件到主目录下面（即home 个人用户名的目录下）：</p>
<p><img alt="Image" src="_images/1719278539323_74442df4_84e4_492a_8633_8ed6f333949c.png" /></p>
<p><img alt="Image" src="_images/1719278539510_050c7a0a_ec54_4cd5_85a1_9f5e81e426fa.png" /></p>
<p>按键盘【Ctrl+Alt+T】调出终端命令界面，使用tar命令对VMwareTools安装包解压（使用sudo命令会提示输入密码，根据提示直接输入密码回车即可，Linux系统密码输入无回显，确保输入的密码正确后按回车确认即可）：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>forlinx@ubuntu:~$ sudo tar -xvf VMwareTools-10.3.10-12406962.tar.gz 
[sudo] password for forlinx:
</pre></div>
</div>
<p>执行完解压命令后，使用ls查看，会出现一个vmware-tools-distrib的文件目录， 进入到该目录</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>forlinx@ubuntu:~$ ls
Desktop   examples.desktop   nfs   snap   tftp   VMwareTools-10.3.10-12406962.tar.gz  vmware-tools-distrib   work
forlinx@ubuntu:~$ cd vmware-tools-distrib/	                      //使用cd命令进入该目录
forlinx@ubuntu:~/vmware-tools-distrib$ ls                         //查看该目录下的文件
bin   caf   doc   etc   FILES   INSTALL   installer   lib   vgauth   vmware-install.pl
</pre></div>
</div>
<p>在当前目录下，输入sudo ./vmware-install.pl，进行安装，回车后输入密码，然后就开始安装，遇到[yes]/[no]就输入yes，其他一律回车默认安装就可以。</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>forlinx@ubuntu:~/vmware-tools-distrib$ sudo ./vmware-install.pl
[sudo] password for forlinx: 		     //输入forlinx账户的密码，无回显，无法看到输入内容
</pre></div>
</div>
<p>安装过程信息较长，此处省略</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>open-vm-tools packages are available from the OS vendor and VMware recommends 
using open-vm-tools packages. See http://kb.vmware.com/kb/2073803 for more 
information.
Do you still want to proceed with this installation? [no] yes			//输入yes
... ...		
</pre></div>
</div>
<p>VMware tools工具完成后，可以实现Windows和Ubuntu之间的文件复制粘贴，虚拟机自适应全显等功能。如果虚拟机不能够全屏显示，可以通过点击查看，选择自动调整大小，点击自动适应客户机，即可实现虚拟的全屏问题，VMware tools安装成功。</p>
<p><img alt="Image" src="_images/1719278539710_8c366a71_823a_4180_8309_32189be7ce07.png" /></p>
<ul class="simple">
<li><p><strong>基本设置：</strong></p></li>
</ul>
<p>在下图位置进行大部分的系统设置。Ubuntu上很多设置的需求都可以在这里完成。</p>
<p><img alt="Image" src="_images/1719278539972_31f94d63_6f34_4904_846e_cd72975c7e99.png" /></p>
</section>
<section id="id10">
<h3>3.1.4 Ubuntu的网络设置<a class="headerlink" href="#id10" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>NAT模式</strong></p></li>
</ul>
<p>在使用网络前，先确保我们的虚拟机能连接互联网，打开虚拟机设置，网络适配器中的网络桥接模式改为“NAT模式”：</p>
<p><img alt="Image" src="_images/1719278540173_d56c3ec8_1d83_49da_99f7_6bbd9a9b6830.png" /></p>
<p>在虚拟机中，VMware虚拟网卡设置为NAT模式时，Ubuntu环境中网络设置为动态IP即可。在这种模式下虚拟NAT设备和主机网卡相连通。这是我们虚拟机上外网最常用的方式。</p>
<p><img alt="Image" src="_images/1719278540394_95e15661_d1d0_427e_93ed_e365eb39c296.png" /></p>
<p><img alt="Image" src="_images/1719278540571_3d28eb06_aea3_4fda_8397_e821b2b7fca1.png" /></p>
<p>网络设置为动态ip。</p>
<p><img alt="Image" src="_images/1719278540815_009829ab_476a_45b8_b02e_d7f42bfbe34f.png" /></p>
<ul class="simple">
<li><p><strong>桥接模式：</strong></p></li>
</ul>
<p>如果在使用TFTP，SFTP等服务器时则需要设置虚拟机的网络联系方式为桥接方式。VMware虚拟网卡设置为桥接模式时，主机网卡和虚拟机网卡通过虚拟网桥进行通信，需要将Ubuntu的IP与主机IP设置在同一个网段。</p>
<p><img alt="Image" src="_images/1719278541083_4d9634db_a591_45be_ad82_f0c7b1e12e3e.png" /></p>
<p><img alt="Image" src="_images/1719278541277_05740351_022e_45fc_96c7_06caac0e068d.png" /></p>
<p><img alt="Image" src="_images/1719278541434_9c36b6f6_6539_4295_8eec_4df165beb02c.png" /></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>设置静态ip，此时Ubuntu的IP与主机IP需设置在同一个网段。
</pre></div>
</div>
<p><img alt="Image" src="_images/1719278541630_bf5fd69d_adc1_407d_915f_2503b2055225.png" /></p>
<ul class="simple">
<li><p><font style="color:rgb(0, 0, 0);background-color:rgb(218, 234, 252);">⁉️</font><strong>注意：网络设置部分涉及到的IP以及DNS请按照用户自身的实际环境来设置，手册为举例说明。</strong></p></li>
</ul>
</section>
<section id="u">
<h3>3.1.5 U盘的加载<a class="headerlink" href="#u" title="Link to this heading"></a></h3>
<p>打开虚拟机设置，USB控制器，在兼容性里面选择USB3.0，然后确定。如下图，因为目前大多数电脑都支持USB3.0的接口，如果不设置，当我们插入USB3.0接口，是不能连接到虚拟机的。如下图：</p>
<p><img alt="Image" src="_images/1719278541851_33d6ec29_11c4_499b_867c_528314eef0ca.png" /></p>
<p>虚拟机启动后，插入U盘，虚拟机右下角会多出一个类似“U盘”的图标，右击–&gt;连接即可，然后就可以在文件系统看到多一个目录，说明U盘加载成功，如图：</p>
<p><img alt="Image" src="_images/1719278542123_ad4e8176_1557_40a0_b545_a4aa290b16d2.png" /></p>
<p><img alt="Image" src="_images/1719278542337_c0fe4886_515f_4fe1_9446_22882a83577e.png" /></p>
</section>
<section id="id11">
<h3>3.1.6 虚拟机基本库安装<a class="headerlink" href="#id11" title="Link to this heading"></a></h3>
<p>在进行开发之前，还需要一些其他的必要库，我们使用以下命令逐一安装，安装前需保证网络可正常使用，能上外网：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>forlinx@ubuntu:~$ sudo apt-get update                             //更新下载源信息
forlinx@ubuntu:~$ sudo apt-get install build-essential            //提供编译程序必须软件包的列表信息
forlinx@ubuntu:~$ sudo apt-get install libncurses*                //用于生成基于文本的用户界面
forlinx@ubuntu:~$ sudo apt-get install lzop                       //基于Lzo库的压缩解压工具
forlinx@ubuntu:~$ sudo apt-get install net-tools                  //网络配置工具
</pre></div>
</div>
</section>
<section id="ok3568-linux">
<h3>3.1.7 编译OK3568 Linux源码必要库安装<a class="headerlink" href="#ok3568-linux" title="Link to this heading"></a></h3>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>forlinx@ubuntu:~$<span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>update<span class="w">                                         </span>//更新apt-get下载源
forlinx@ubuntu:~$<span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>openssh-server<span class="w"> </span>vim<span class="w"> </span>git<span class="w"> </span>fakeroot<span class="w">        </span>//必备工具包的安装
forlinx@ubuntu:~$<span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>repo<span class="w"> </span>git<span class="w"> </span>ssh<span class="w"> </span>make<span class="w"> </span>gcc<span class="w"> </span>libssl-dev<span class="w"> </span>liblz4-tool<span class="w"> </span>expect<span class="w"> </span>g++<span class="w"> </span>patchelf<span class="w"> </span>chrpath<span class="w"> </span>gawk<span class="w"> </span>texinfo<span class="w"> </span>chrpath<span class="w"> </span>diffstat<span class="w"> </span>binfmt-support<span class="w"> </span>qemu-user-static<span class="w"> </span>live-build<span class="w"> </span>bison<span class="w"> </span>flex<span class="w"> </span>fakeroot<span class="w"> </span>cmake<span class="w"> </span>gcc-multilib<span class="w"> </span>g++-multilib<span class="w"> </span>unzip<span class="w"> </span>device-tree-compiler<span class="w"> </span>python-pip<span class="w"> </span>libncurses5-dev
forlinx@ubuntu:~$<span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>libgmp-dev<span class="w">  </span>libmpc-dev<span class="w"> </span>libicu-dev<span class="w"> </span>bsdmainutils
</pre></div>
</div>
<p>这些库文件是自行搭建3568 Linux编译环境时，准备编译Linux源码需要下载的库文件，若不是搭建OK3568 Linux开发环境，可跳过此步骤。</p>
</section>
<section id="id12">
<h3>3.1.8 增大交换分区<a class="headerlink" href="#id12" title="Link to this heading"></a></h3>
<p>请确认当前系统 swap 分区大小，若 swap 分区不足会造成编译源码失败，推荐 16G。开发环境内存建议调整到 16G。</p>
<p>1、 查看 swap 分区情况：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>forlinx@ubuntu:~$ cat /proc/swaps
</pre></div>
</div>
<p>飞凌提供的虚拟机默认已经配置好 swap 分区，如果您使用其它虚拟机，可通过创建 swap 文件的方式来增加 swap 分区大小：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>forlinx@ubuntu:~$ sudo swapoff /swapfile
forlinx@ubuntu:~$ sudo fallocate -l 10G /swapfile
forlinx@ubuntu:~$ sudo chmod 600 /swapfile
forlinx@ubuntu:~$ sudo mkswap /swapfile
forlinx@ubuntu:~$ sudo swapon /swapfile
forlinx@ubuntu:~$ sudo vim /etc/fstab
</pre></div>
</div>
<p><font style="color:#000000;"></font></p>
<p><font style="color:#000000;">在 /etc/fstab 文件最后添加如下内容：</font></p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>forlinx@ubuntu:~$ /swapfile none swap sw 0 0
</pre></div>
</div>
<p>2、建议调整开发环境内存至 16G，内存低可能导致编译不通过。</p>
<p><img alt="Image" src="_images/1719278542580_d0fd91fe_bf0c_47fd_aa6f_774dad1fd478.png" /></p>
</section>
</section>
<section id="qt-creator">
<h2>3.2 Qt Creator安装<a class="headerlink" href="#qt-creator" title="Link to this heading"></a></h2>
<p>将qt-creator-opensource-linux-x86_64-4.7.0.run拷贝至当前用户家目录下的任意目录下，执行下面命令。</p>
<ul class="simple">
<li><p>路径：OK3568-C（Linux）用户资料\Linux\源码\qt-creator-opensource-linux-x86_64-4.7.0.run</p></li>
</ul>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>forlinx@ubuntu:~$ ./qt-creator-opensource-linux-x86_64-4.7.0.run                   
</pre></div>
</div>
<p><img alt="Image" src="_images/1719278542788_a08554d9_9ff7_485a_a499_6a5b274fd48f.png" /></p>
<p>然后会弹出图形界面的安装窗口，按照提示进行安装：</p>
<p><img alt="Image" src="_images/1719278542977_d1772186_fa60_442a_8cf2_6e5cffefaae2.png" />		 <img alt="Image" src="_images/1719278543199_cbc234c5_2d49_43aa_864e_4daf0abe7a4c.png" /></p>
<p><img alt="Image" src="_images/1719278543389_eaacabb8_9343_4e45_8626_9a68c043e0a0.png" /> 	<img alt="Image" src="_images/1719278543608_c9d367f7_56c3_44b6_829c_04f29286f63d.png" /></p>
<p>在线安装的用户需要自己注册测Qt账户，已有Qt账户的直接登录即可，Qt密码要求为：包含大写字母、小写字母、数字，注册登陆成功后，点击next。</p>
<p>离线安装的用户点击跳过即可。</p>
<p><img alt="Image" src="_images/1719278543830_11d43ecf_8d67_4bd0_a472_fc52383a77b1.png" /></p>
<p>点击next</p>
<p><img alt="Image" src="_images/1719278544047_02ae511b_f6df_49fc_94ad_50606afa9ac1.png" /></p>
<p>用户可根据自己习惯设置安装路径，这边直接默认，点击next</p>
<p><img alt="Image" src="_images/1719278544274_25984f38_7e0d_4029_97ec_25fc13e82651.png" /></p>
<p>完全安装，点击next</p>
<p><img alt="Image" src="_images/1719278544480_43ea98bb_67e7_4632_a1cf_b917e22a17eb.png" /></p>
<p><img alt="Image" src="_images/1719278544690_a23e2f5f_b76b_46c9_8ebc_ef0ddc395677.png" /></p>
<p>点击install，等待安装完成。</p>
<p><img alt="Image" src="_images/1719278544902_6e395fac_45b1_428e_b5ed_dd3045ed1597.png" /></p>
<p>安装完成，点击finish。这时将自动打开Qt界面，也可以通过命令行启动，执行以下命令，以后台方式打开Qt Creator，用户打开时以自己实际安装路径为准：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>forlinx@ubuntu:~$ cd /home/forlinx/qtcreator-4.7.0/bin
forlinx@ubuntu:~$ ./qtcreator &amp;
</pre></div>
</div>
<p><img alt="Image" src="_images/1719278545088_f7954df3_4aa6_40d1_9046_723786b916af.png" /></p>
<p>出现Qt Creator工具界面。Qt Creator安装完毕。</p>
</section>
</section>
<section id="id13">
<h1>04_相关代码编译<a class="headerlink" href="#id13" title="Link to this heading"></a></h1>
<p>本章节主要描述开发板相关源码的编译方法，包括内核源码编译、应用程序编译方法。</p>
<section id="id14">
<h2>4.1编译前准备<a class="headerlink" href="#id14" title="Link to this heading"></a></h2>
<section id="id15">
<h3>4.1.1 环境说明<a class="headerlink" href="#id15" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>开发环境操作系统：Ubuntu22.04  64位版</p></li>
<li><p>交叉工具链：aarch64-linux-gnu</p></li>
<li><p>开发板使用Bootloader 版本：u-boot-2017.09</p></li>
<li><p>开发板内核版本：linux-5.10.160</p></li>
<li><p>开发板移植QT版本：qt5.15.8</p></li>
</ul>
</section>
<section id="id16">
<h3>4.1.2 拷贝源码<a class="headerlink" href="#id16" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>程序源码：用户资料\Linux\源码\ OK3568_Linux_fs.tar.bz2.0*</p></li>
</ul>
<p>创建工作目录</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>forlinx@ubuntu:~$ mkdir -p /home/forlinx/3568							//按照顺序创建工作目录
</pre></div>
</div>
<p>将用户资料中的源码文件OK3568_Linux_fs.tar.bz2.0*拷贝到虚拟机/home/forlinx/3568目录。</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>forlinx@ubuntu:~$ cd /home/forlinx/3568									//切换到工作目录
forlinx@ubuntu:~/3568$ cat OK3568_Linux_fs.tar.bz2.0* &gt; OK3568_Linux_fs.tar.bz2
forlinx@ubuntu:~/3568$ tar -xvf OK3568_Linux_fs.tar.bz2				//在当然位置解压压缩包
</pre></div>
</div>
<p>运行命令后等待完成即可。</p>
<ul class="simple">
<li><p>工具包路径：OK3568-Linux5.10.160-用户资料\Linux\源码\dl.tar.bz2</p></li>
</ul>
<p>编译buildroot时会根据配置从官网上下载工具包，将用户资料中的dl.tar.bz2下载解压到buildroot目录中，可以减少编译时间。</p>
</section>
</section>
<section id="id17">
<h2>4.2 内核编译<a class="headerlink" href="#id17" title="Link to this heading"></a></h2>
<p><font style="color:rgb(0, 0, 0);background-color:rgb(218, 234, 252);">⁉️</font><strong>注意：</strong></p>
<ul class="simple">
<li><p><strong>初次解压内核源码后，需要先对源码进行整体编译</strong></p></li>
<li><p><strong>整体编译过后，可根据实际情况再进行单独编译</strong></p></li>
<li><p><strong>该源码编译需要开发环境运行内存16G及以上，请不要修改我们提供的VM虚拟机镜像配置</strong></p></li>
<li><p><strong>为缩短首次编译时间，默认全编译直接使用编译好的文件系统镜像，未重新制作文件系统。</strong></p></li>
</ul>
<section id="id18">
<h3>4.2.1 全编译测试<a class="headerlink" href="#id18" title="Link to this heading"></a></h3>
<p>在终端切换到解压出来的源码路径：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>forlinx@ubuntu:~$ cd /home/forlinx/3568/OK3568_Linux_fs
</pre></div>
</div>
<p>以下操作需要在源码目录下操作，第一遍编译需要指定使用的chip：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>forlinx@ubuntu: ~/3568/OK3568_Linux_fs$./build.sh chip
/*执行后会有选项输入，如下：*/
Log saved at /home/forlinx/work/3568/OK3568_Linux_fs/output/sessions/2023-10-21_16-45-26

Pick a chip:

1. OK3568
2. rk3566_rk3568
3. rk3588
Which would you like? [1]: 1 /*输入1后按回车继续。*/
Switching to defconfig: /home/forlinx/work/3568/OK3568_Linux_fs/device/rockchip/.chip/OK3568-C-linux_defconfig
make: Entering directory &#39;/home/forlinx/work/3568/OK3568_Linux_fs/device/rockchip/common&#39;
#
# configuration written to /home/forlinx/work/3568/OK3568_Linux_fs/output/.config
#
make: Leaving directory &#39;/home/forlinx/work/3568/OK3568_Linux_fs/device/rockchip/common&#39;
</pre></div>
</div>
<p>之后可进行编译。默认采用的linuxfs 下的文件系统，直接打包的。如果需要重新编译buildroot，需要按单独编译部分单独编译。</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>forlinx@forlinx-ubuntu:~/work/3568/OK3568_Linux_fs$ ./build.sh
</pre></div>
</div>
<p>最终的编译效果如下图，（根据实际情况，路径可能会有不同）：</p>
<p><img alt="Image" src="_images/1719278519464_b89aebf0_bcc5_4f08_85d7_7a0e0cea8f6a.png" /></p>
<p>编译成功后，将在OK3568_Linux_fs/rockdev文件夹下生成对应编译工程结果文件，找到其中的镜像文件。</p>
<p><img alt="Image" src="_images/1719278519744_a17e751c_a98e_4d42_baa3_928eee7838b6.png" /></p>
<p><font style="color:rgb(0, 0, 0);background-color:rgb(218, 234, 252);">⁉️</font><strong>注意：update.img为打包好用于OTG或者TF卡完全烧写用，其它文件为分步烧写使用。</strong></p>
<p><font style="color:rgb(0, 0, 0);background-color:rgb(218, 234, 252);">⁉️</font><strong>注意：3568 5.10SDK中放置了一套提前编译完成的文件系统，在OK3568_Linux_fs/linuxfs目录下，直接执行全编译脚本时会将linuxfs/rootfs.img 拷贝buildroot/output/OK3568/images目录下直接生成编译文件系统的结果以此缩短首次编译生成update.img的时间。需要编译文件系统时，需单独编译，编译完成后会将生成的rootfs.img替换linuxfs/rootfs.img文件，后续执行build.sh仍然使用linuxfs/rootfs.img文件。</strong></p>
</section>
<section id="id19">
<h3>4.2.2 单独编译测试<a class="headerlink" href="#id19" title="Link to this heading"></a></h3>
<p>进行单独编译前需进行过全编译，在内核源码路径下进行操作。</p>
<p>单独编译buildroot 之前，需要将OK3568_Linux_fs/buildroot/package/forlinx/flapp/Config.in</p>
<p>和OK3568_Linux_fs/buildroot/package/forlinx/flapp/flapp.mk如下修改：</p>
<p>OK3568_Linux_fs/buildroot/package/forlinx/flapp/Config.in中将depends on BR2_PACKAGE_DWKEYBOARD 去掉并保存退出。</p>
<p>OK3568_Linux_fs/buildroot/package/forlinx/flapp/flapp.mk 中将FLAPP_DEPENDENCIES的参数中去掉DWKeyboard 保存退出。</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>forlinx@ubuntu: ~/3568/OK3568_Linux_fs$./build.sh uboot        //单独编译uboot
//生成uboot.img，生成路径为/OK3568_Linux_fs/u-boot/uboot.img
forlinx@ubuntu: ~/3568/OK3568_Linux_fs$./build.sh kernel        //单独编译内核
//生成boot.img，生成路径为/OK3568_Linux_fs/kernel/boot.img
forlinx@ubuntu: ~/3568/OK3568_Linux_fs$./build.sh buildroot    //单独编译buildroot文件系统
//生成rootfs.ext2，生成路径为/OK3568_Linux_fs/buildroot/output/OK3568/image/rootfs.ext2路径下
//注意3568 5.10 SDK 中在linuxfs目录下内置了出厂的rootfs.img，单独编译buildroot会将其覆盖，若对出厂文件系统有回滚要求的用户，执行单独编译文件系统前，请备份。
//重新编译制作文件系统时间较长，一般为4~6小时若没有报错退出的信息，请耐心等待。
forlinx@ubuntu: ~/3568/OK3568_Linux_fs$./build.sh recovery     //单独编译recovery文件系统
//生成rootfs.cpio.gz，生成路径为/OK3568_Linux_fs/output/recovery/ rootfs.cpio.gz
forlinx@ubuntu: ~/3568/OK3568_Linux_fs$./build.sh updateimg    //单独生成update.img
//使用上述路径的uboot.img、boot.img、rootfs.ext2 生成update.img 路径为 rockdev/update.img
</pre></div>
</div>
<p>编译成功后update.img里的内核不更新。请分步烧写/OK3568_Linux_fs/kernel/boot.img文件，分步烧写步骤请参考 用户使用手册 “6.1.3 OTG分步烧写测试”章节。</p>
<ul class="simple">
<li><p><strong>注意：用户图形界面配置修改过内核配置后，例如增加usb转串口ch340驱动，执行./build.sh kernel，烧写boot.img镜像，启动开发板后发现图形配置未生效，可以使用其中一个方法解决：</strong></p></li>
</ul>
<p><img alt="Image" src="_images/1719278519952_52a94c0e_c1cd_4712_ace8_93361052f010.png" /></p>
<p>方法1：直接将配置写到内核默认配置文件/OK3568_Linux_fs/kernel/arch/arm64/configs/OK3568-C-</p>
<p>linux_defconfig中：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>CONFIG_USB_SERIAL_CH341=y
forlinx@ubuntu: ~/3568/OK3568_Linux_fs$ ./build.sh kernel
</pre></div>
</div>
<p>方法2：图形化配置内核，注释掉源码device/rockchip/common/scripts/mk-kernel.sh下图命令，如下图。</p>
<p><img alt="Image" src="_images/1729748971129_8aaac971_6fc6_46b9_82b1_07ec208f8250.png" /></p>
<p>编辑kernel/ Makefile文件</p>
<p><img alt="Image" src="_images/1729748796793_7588d772_02d0_4b6e_a597_68abe1e049a6.png" /></p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>forlinx@ubuntu: ~/3568/OK3568_Linux_fs/kernel$ make ARCH=arm64 menuconfig
</pre></div>
</div>
<p>用户根据需求配置内核，将配置写到.config文件后，保存退出。</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>forlinx@ubuntu: ~/3568/OK3568_Linux_fs$ ./build.sh kernel
</pre></div>
</div>
<p><font style="color:rgb(0, 0, 0);background-color:rgb(218, 234, 252);">⁉️</font><strong>注意：用户图形界面配置修改过buildroot配置后，例如增加python3支持，执行./build.sh buildroot，烧写rootfs.ext2镜像，启动开发板后发现图形配置未生效，可以使用其中一个方法解决：</strong></p>
<p>方法1：直接将配置写到buildroot默认配置文件/OK3568_Linux_fs/buildroot/configs/OK3568_defconfig中：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>BR2_PACKAGE_PYTHON3=y	
BR2_PACKAGE_PYTHON3_PY_PYC=y
forlinx@ubuntu: ~/3568/OK3568_Linux_fs$ ./build.sh buildroot
</pre></div>
</div>
<p>编译过程中弹出以下提示：</p>
<p>Found old config, override it? (y/n):<font style="color:#0000FF;">y</font>选择y，表示覆盖之前的.config文件。</p>
<p>方法2：图形化配置buildroot，注释掉device/rockchip/common/scripts/mk-buildroot.sh中下图位置：</p>
<p><img alt="Image" src="_images/1729133678368_3f66e00b_a5eb_4e60_9d18_12bfe4052b4b.png" /></p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>forlinx@ubuntu: ~/3568/OK3568_Linux_fs/buildroot/output/OK3568$ make menuconfig
</pre></div>
</div>
<p>用户根据需求配置buildroot，将配置写到.config文件后，保存退出。</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>forlinx@ubuntu: ~/3568/OK3568_Linux_fs$ ./build.sh buildroot
</pre></div>
</div>
<p><strong>Tips：如单独编译文件系统，并单独烧写后，发现显示界面中程序并没有正确添加，在显示界面中点击无法正确打开，可将源码目录下，buildroot/configs/OK3568_defconfig 中，BR2_PACKAGE_DWKEYBOARD=n 配置项修改为y，重新编译即可恢复正常。</strong></p>
</section>
<section id="id20">
<h3>4.2.3 交叉编译链位置<a class="headerlink" href="#id20" title="Link to this heading"></a></h3>
<p>驱动编译链的源码路径：</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>OK3568-linux-sdk5.10/prebuilts/gcc/linux-x86/aarch64/gcc-arm-10.3-2021.07-x86_64-aarch64-none-linux-gnu/bin/aarch64-none-linux-gnu-
</pre></div>
</div>
<p>文件系统应用（QT等）编译链的源码路径：</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>OK3568-linux-sdk5.10/buildroot/output/OK3568/host/bin/aarch64-linux-
</pre></div>
</div>
<p>以上路径是已经执行过./build.sh buildroot后的编译链生成位置，如果您使用预置<strong>host.tar.bz2</strong>的方式来编译整包则在编译完后再在以上路径解开<strong>host.tar.bz2</strong>即可获得编译链**。**</p>
</section>
</section>
<section id="image">
<h2>4.3 Image文件的使用<a class="headerlink" href="#image" title="Link to this heading"></a></h2>
<p>update.img为打包好用于OTG或者TF卡完全烧写用，其它文件为分步烧写使用。单独编译生成的Image文件不会在update.img文件中更新，需使用单步烧写来烧录（详见用户使用手册OTG烧写）。</p>
</section>
<section id="id21">
<h2>4.4 Qt Creator环境配置<a class="headerlink" href="#id21" title="Link to this heading"></a></h2>
<p>Qt是跨平台的图形开发库，支持众多操作系统，在进行编译前需要对Qt Creator的编译环境进行配置。</p>
<section id="id22">
<h3>4.4.1 交叉编译器配置<a class="headerlink" href="#id22" title="Link to this heading"></a></h3>
<p><font style="color:rgb(0, 0, 0);background-color:rgb(218, 234, 252);">⁉️</font><strong>注意：Qt Creator所用的交叉编译器所在路径需全编译源码后生成，为了使用方便，我们在/OK3568-C（Linux）用户资料/工具目录下放置了host.tar.bz2压缩包，可以查看其中/host/bin/qt.conf文件中记录的HostPrefix路径，然后使用我们的开发环境创建绝对路径和HostPrefix记录一致即可 将host.tar.bz2解压到对应的绝对路径后，继续本章节的操作。强烈建议全编译源码后再进行本章节操作。</strong></p>
<p>1、点击Qt Creator 的Tools -&gt;Options-&gt;Kits-&gt;Compilers， 然后点击Add -&gt;GCC-&gt;C；</p>
<p>2、Name输入GCC；</p>
<p>3、Compiler Path点击Browse 选择交叉编译器的路径为：aarch64-linux-gcc和aarch64-linux-g++，如下图所示：</p>
<p><font style="color:rgb(0, 0, 0);background-color:rgb(218, 234, 252);">🛤️</font><font style="color:#0000FF;">路径：OK3568_Linux_fs/buildroot/output/OK3568/host/bin</font></p>
<p><font style="color:rgb(0, 0, 0);background-color:rgb(218, 234, 252);">⁉️</font><strong>注意：buildroot下output目录需要源码经过全编译后才可生成。</strong></p>
<p><img alt="Image" src="_images/1719278520399_97607db9_0b25_4da5_a25f_627035faf646.png" /></p>
<p>4、按照同样的方法添加GCC编译器，点击右侧“Add-&gt;GCC-&gt;C++”，如图所示：</p>
<p><img alt="Image" src="_images/1719278520769_d05d050c_d4eb_41fe_8191_f158b073c500.png" /></p>
</section>
<section id="qt-versions">
<h3>4.4.2 Qt Versions 配置<a class="headerlink" href="#qt-versions" title="Link to this heading"></a></h3>
<p>1、点击Qt Creator 的Tools -&gt;Options-&gt;Qt Versions，</p>
<p>2、然后点击Add，弹出对话框选择OK3568_Linux_fs/buildroot/output/OK3568/host/bin/qmake</p>
<p>3、点击open添加。</p>
<p><img alt="Image" src="_images/1719278521034_d7cf7714_3105_4689_9683_c4a8ed6c6efd.png" /></p>
<p>4、然后会返回 Qt Version配置框，Version name可以自行更改。</p>
<p>5、然后点击Apply及OK。</p>
</section>
<section id="kits">
<h3>4.4.3 Kits 配置<a class="headerlink" href="#kits" title="Link to this heading"></a></h3>
<p>Kits是一个构建套件，用来构建和选择开发编译环境，对于有多种QT库的项目很有用。将之前添加的交叉编译器和QT Version添加到Kits中，构建适合开发板的编译环境。</p>
<p>1、点击Qt Creator 的Tools -&gt;Options-&gt;Kits， 然后点击Add，出现配置部分。</p>
<p>2、Name自行更改。</p>
<p>3、Compiler选择GCC。</p>
<p>4、Qt version选择Qt version创建时输入的名字。</p>
<p><img alt="Image" src="_images/1719278521412_b439e3bd_e015_4425_affc_02a52c66f43c.png" /></p>
<p>5、然后点击Apply及OK。</p>
</section>
</section>
<section id="id23">
<h2>4.5 应用程序编译及运行<a class="headerlink" href="#id23" title="Link to this heading"></a></h2>
<section id="id24">
<h3>4.5.1 编译并运行命令行应用<a class="headerlink" href="#id24" title="Link to this heading"></a></h3>
<p>本小节使用看门狗测试程序，默认程序拷贝到/home/forlinx/3568目录。</p>
<p>1、使用cd命令进入/home/forlinx/work目录</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>forlinx@ubuntu:~$ cd /home/forlinx/3568/OK3568_Linux_fs/app/forlinx/forlinx_cmd/fltest_watchdog
</pre></div>
</div>
<p>2、添加交叉编译器路径，使用make进行交叉编译</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>forlinx@ubuntu: ~/3568/OK3568_Linux_fs/app/forlinx/forlinx_cmd/fltest_watchdog$ export PATH=/home/forlinx/3568/OK3568_Linux_fs/buildroot/output/OK3568/host/bin/:$PATH
forlinx@ubuntu: ~/3568/OK3568_Linux_fs/app/forlinx/forlinx_cmd/fltest_watchdog$ make	
aarch64-linux-gcc watchdog.c -o fltest_watchdog  
generate fltest_watchdog success!!!
</pre></div>
</div>
<p>用file命令查看生成的文件信息</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>forlinx@ubuntu:~/3568/OK3568_Linux_fs/app/forlinx/forlinx_cmd/fltest_watchdog$ 
file fltest_watchdog 
fltest_watchdog: ELF 64-bit LSB executable, ARM aarch64, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux-aarch64.so.1, for GNU/Linux 3.7.0, not stripped
</pre></div>
</div>
<p>通过结果可以看到编译生成的是64位、ARM的文件。</p>
<p>3、将编译生成的fltest_watchdog通过U盘或者ftp等方式拷贝到板子上，比如/forlinx路径下，下述以tf卡为例，拷贝到开发板，运行测试。</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>[root@ok3568:/]# cp /run/media/mmcblk1p1/fltest_watchdog /home/forlinx
[root@ok3568:/]# cd /home/forlinx
[root@ok3568:/home/forlinx]# ./fltest_watchdog
Watchdog Ticking Away!
</pre></div>
</div>
<p>4、参考用户使用手册“看门狗测试”章节测试。</p>
</section>
<section id="qt">
<h3>4.5.2 编译并运行QT应用程序<a class="headerlink" href="#qt" title="Link to this heading"></a></h3>
<p>在开发环境打开Qt Creator（用户根据自己的实际路径打开），点击Qt Creator 的File-&gt;Open File or Project，弹出窗口，选择/3568/OK3568_Linux_fs/app/forlinx/forlinx_qt/watchdog/watchdog.pro</p>
<p><img alt="Image" src="_images/1719278521691_446f0d66_a6de_4eb4_b2b9_adbac3c23ffb.png" /></p>
<p>打开项目后界面如下：（若没有自动改变页面，请按照截图所示选择）。</p>
<p><img alt="Image" src="_images/1719278521907_882537ff_aab0_4987_a170_8c64515f8de1.png" /></p>
<p>点击Configure Project后将适配本手册《Qt Creator环境配置》章节中构建的编译环境。</p>
<p>选择后界面如下：</p>
<p><img alt="Image" src="_images/1719278522180_76d20235_a09d_4dff_9cb2_0135a93d5442.png" /></p>
<p>点击Build-&gt;Clean All进行清空。（如果没有清除中间文件可以手动删除）。</p>
<p>点击Projects 取消选中Shadow build。</p>
<p><img alt="Image" src="_images/1719278522421_8c6a5ab7_a9ce_4a72_88be_0902f222e58d.png" /></p>
<p>然后点击Build-&gt;Build All进行编译。</p>
<p><img alt="Image" src="_images/1719278522722_eccde718_c389_4662_ba54_bad05baaceb2.png" /></p>
<p>右下角Build进度条走完之后代表编译完成，此时在路径/app/forlinx/forlinx_qt/watchdog目录下会看到新生成的二进制文件fltest_qt_watchdog，如下：</p>
<p><img alt="Image" src="_images/1719278523014_cd2cfd24_0659_4cda_be02_d2ebfe309ef1.png" /></p>
<p>将编译生成的可执行文件通过U盘或者ftp等方式拷贝到板子上，拷贝到开发板，运行测试即可。</p>
</section>
</section>
</section>


           </div>
          </div>
          <div class="forlinx-footer-social" style="margin-top: 15px; padding: 0 16px;">
  <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">

    <!-- 左侧版权信息 -->
    <span style="font-size: 14px; color: #444;">
      © <a href="https://www.forlinx.net/" target="_blank" style="color: inherit; text-decoration: none;">Forlinx Embedded</a>
    </span>

    <!-- 右侧社交图标 -->
    <div>
      <a href="https://www.facebook.com/Forlinx-Embedded-177890724336237" target="_blank">
        <i class="fab fa-facebook fa-lg" style="margin: 0 6px; color:#3b5998;"></i>
      </a>
      <a href="https://www.linkedin.com/company/forlinx-embedded-technology-co-ltd/" target="_blank">
        <i class="fab fa-linkedin fa-lg" style="margin: 0 6px; color:#0077b5;"></i>
      </a>
      <a href="https://x.com/ForlinxOfficial" target="_blank">
        <i class="fab fa-x-twitter fa-lg" style="margin: 0 6px; color:#000;"></i>
      </a>
      <a href="https://www.youtube.com/@forlinxembedded" target="_blank">
        <i class="fab fa-youtube fa-lg" style="margin: 0 6px; color:#FF0000;"></i>
      </a>
      <a href="https://github.com/ForlinxEmbedded" target="_blank">
        <i class="fab fa-github fa-lg" style="margin: 0 6px; color:#333;"></i>
      </a>
      <a href="https://www.forlinx.net/" target="_blank">
        <i class="fas fa-globe fa-lg" style="margin: 0 6px; color:#2274A5;"></i>
      </a>
    </div>

  </div>
</div>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>