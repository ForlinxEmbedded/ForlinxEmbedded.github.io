

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>00_Linux4.9.170+Qt5.12.5_使用手册 &mdash; Forlinx Embedded T507 Documentation  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/theme-switcher.css?v=c5fef1f0" />

  
    <link rel="shortcut icon" href="_static/forlinx.png"/>
    <link rel="canonical" href="https://forlinxembedded.github.io/allwinner/okt507-c/OKT507-C_Linux4_9_170_User_Manual.html" />
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/theme-switcher.js?v=950663c4"></script>
      <script src="_static/logo-link.js?v=d4af6ba6"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="User’s Hardware Manual" href="OKT507-C_User_Hardware_Manual.html" />
   

  <!-- Load Font Awesome from CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-N8EJPNL8NR"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-N8EJPNL8NR');
  </script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/forlinx-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">HARDWARE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="OKT507-C_User_Hardware_Manual.html">User’s Hardware Manual</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SOFTWARE</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">00_Linux4.9.170+Qt5.12.5_使用手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="#id1">免责声明</a></li>
<li class="toctree-l1"><a class="reference internal" href="#id2">概述</a></li>
<li class="toctree-l1"><a class="reference internal" href="#id3">适用范围</a></li>
<li class="toctree-l1"><a class="reference internal" href="#id4">更新记录</a></li>
<li class="toctree-l1"><a class="reference internal" href="#okt507">01_OKT507开发板介绍</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id5">1.1  OKT507开发板简介</a></li>
<li class="toctree-l2"><a class="reference internal" href="#linux-4-9-170">1.2  Linux 4.9.170系统软件资源介绍</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id6">1.3  烧写及启动设置</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#id7">02_快速开机启动</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id8">2.1  开机前的准备</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id9">2.2  串口登录方式</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id10">2.2.1  串口登录</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id11">2.2.2  串口登录常见问题</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id12">2.3  网络登录方式</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id13">2.3.1  网络连接测试</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ssh">2.3.2  SSH服务器</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id14">2.4  屏幕切换</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id15">2.4.1  内核设备树指定方式</a></li>
<li class="toctree-l3"><a class="reference internal" href="#uboot">2.4.2  uboot菜单动态控制方式</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id16">2.5  电阻屏重新校准</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id17">2.6  系统分区</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id18">2.7  系统关闭</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#id19">03_OKT507平台界面功能使用及测试</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id20">3.1  界面功能简介</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id21">3.2  音视频播放体验</a></li>
<li class="toctree-l2"><a class="reference internal" href="#opengl">3.3  OpenGL测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id22">3.4  网络配置测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id23">3.5  浏览器测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#g">3.6  4G测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#uart">3.7  UART测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adc">3.8  ADC测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wifi">3.9  WIFI测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rtc">3.10  RTC测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id24">3.11  按键测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id25">3.12  看门狗测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ping">3.13  Ping测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#camera">3.14  Camera测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id26">3.15  背光测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id27">3.16  录音测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cpu">3.17  CPU频率配置测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sqlite3">3.18  SQLite3数据库测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id28">3.19  UBOOT菜单配置测试</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#id29">04_OKT507命令行功能测试</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id30">4.1  系统信息查询</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id31">4.2  调频测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id32">4.3  温度测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ddr">4.4  DDR带宽测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id33">4.5  看门狗测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id34">4.6  RTC功能测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id35">4.7  按键测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id36">4.8  UART测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gpadc">4.9  GPADC测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tf">4.10  TF卡测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#emmc">4.11  eMMC 测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#usb">4.12  USB鼠标测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#usb-2-0">4.13  USB 2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="#otg">4.14  OTG测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id37">4.15  以太网配置</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ip">4.15.1 千兆以太网固定IP方式</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id38">4.15.2 百兆以太网固定IP方式</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id39">4.15.3 自动获取IP方法</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id40">4.15.4 测试以太网网速</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id41">4.16  网络服务</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#web">4.16.1  Web服务</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sftp">4.16.2  SFTP</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id42">4.17  WIFI 测试</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sta">4.17.1  STA模式</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ap">4.17.2  AP模式</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id43">4.18  蓝牙测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id44">4.19  4G测试</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#me909s4g">4.19.1  华为ME909S4G测试</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ec20">4.19.2  EC20模块测试</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id45">4.20  放/录音测试</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hdmi">4.20.1 HDMI播放声音</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lineout">4.20.2 LINEOUT播放声音</a></li>
<li class="toctree-l3"><a class="reference internal" href="#headphone">4.20.3 HeadPhone 播放声音</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mic">4.20.4 MIC录音测试</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id46">4.20.5 调节声音大小</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#lcd">4.21  LCD背光调节</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id47">4.22  关闭桌面</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id48">4.23  视频播放</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id49">4.23.1 独显时视频播放</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id50">4.23.2 双屏显示时视频播放</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ir">4.24  IR测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#led">4.25  LED测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id51">4.26  SQLite3测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id52">4.27  添加开机自启动脚本</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id53">4.27.1  临时添加自启动脚本</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id54">4.27.2  向烧写镜像里添加自启动脚本</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#a53-coremark">4.28  A53 CoreMark测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#a53-dhrystone">4.29  A53 Dhrystone测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id55">4.30  OpenGL测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#demo">4.31  车载DEMO测试</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#id56">05_OKT507平台多媒体测试</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#ov5640-mipi">5.1  OV5640_MIPI播放测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ov5640-dvp">5.2  OV5640_DVP播放测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tp2854m">5.3  TP2854M测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tp2815-tp2855">5.4 <font style="color:rgb(51, 51, 51);">TP2815\TP2855测试</font></a></li>
<li class="toctree-l2"><a class="reference internal" href="#id57">5.5  视频硬编码</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id58">5.6  视频硬解码</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#id59">06_烧写系统</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id60">6.1  烧写所需镜像</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id61">6.2  OTG烧写</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id62">6.2.1  OTG驱动安装</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id63">6.2.2  OTG 烧写方法</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id64">6.2.3  OTG 烧写常见问题</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id65">6.3  TF卡烧写</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id66">6.3.1  制作TF烧写卡</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id67">6.3.2  TF卡烧写方法</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#logo">附录1：更换开机静态Logo和动画</a></li>
<li class="toctree-l1"><a class="reference internal" href="#ubootgpio">附录2：uboot阶段的GPIO配置</a></li>
<li class="toctree-l1"><a class="reference internal" href="#id68">附录3：修改分区</a></li>
<li class="toctree-l1"><a class="reference internal" href="#id69">附录4：添加新文件到文件系统</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Forlinx Embedded T507 Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">00_Linux4.9.170+Qt5.12.5_使用手册</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="linux4-9-170-qt5-12-5">
<h1>00_Linux4.9.170+Qt5.12.5_使用手册<a class="headerlink" href="#linux4-9-170-qt5-12-5" title="Link to this heading"></a></h1>
<p><font style="color:rgb(51, 51, 51);">版本：V1.4</font></p>
<p>发布日期：2025.08.06</p>
<p>文件密级：□绝密 □秘密 □内部资料 ■公开</p>
</section>
<section id="id1">
<h1>免责声明<a class="headerlink" href="#id1" title="Link to this heading"></a></h1>
<p>本手册版权归保定飞凌嵌入式技术有限公司所有。未经本公司的书面许可，任何单位和个人无权以任何形式复制、传播、转载本手册的任何部分，违者将被追究法律责任。</p>
<p>保定飞凌嵌入式有限公司所提供的所有服务内容旨在协助用户加速产品的研发进度，在服务过程中所提供的任何程序、文档、测试结果、方案、支持等资料和信息，都仅供参考，用户有权不使用或自行参考修改，本公司不提供任何的完整性、可靠性等保证，若在用户使用过程中因任何原因造成的特别的、偶然的或间接的损失，本公司不承担任何责任。</p>
</section>
<section id="id2">
<h1>概述<a class="headerlink" href="#id2" title="Link to this heading"></a></h1>
<p><font style="color:rgb(51, 51, 51);">本手册以使用户快速熟悉产品，了解接口功能和测试方法为目的，主要讲述了开发板接口功能的测试，烧写镜像方法，以及使用过程中出现的一些问题如何排查。在测试过程中，对一些命令进行了注释，方便</font>用户理解，以实用够用为主。涉及到内核编译、相关应用编译方法，开发环境搭建等请参考飞凌提供的《OKT507-C_Linux4.9.170+ Qt5.12用户编译手册》</p>
<p>本手册一共分为6部分：</p>
<p>第一部分产品的整体概述，简单介绍了开发板在接口资源、内核源码中相关驱动路径、开发板支持的烧写和启动方式，以及资料中重点部分的说明；</p>
<p>第二部分产品的快速开机启动，可采用串口登录和网络登录两种方式；</p>
<p>第三部分产品的QT界面功能测试；</p>
<p>第四部分产品的命令行操作进行功能测试；</p>
<p>第五部分产品的多媒体测试，包括了摄像头的播放测试以及视频硬件编解码测试；</p>
<p>第六部分产品的镜像更新，主要描述更新镜像到存储设备的方法，用户可根据实际情况选择对应的烧录方式。</p>
</section>
<section id="id3">
<h1>适用范围<a class="headerlink" href="#id3" title="Link to this heading"></a></h1>
<p>本软件手册中适用于飞凌公司的<font style="color:rgb(51, 51, 51);">OKT507-C 平台 Linux4.9.170 操作系统。</font></p>
</section>
<section id="id4">
<h1>更新记录<a class="headerlink" href="#id4" title="Link to this heading"></a></h1>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p><strong><font style="color:rgb(51, 51, 51);">日期</font></strong></p></th>
<th class="head text-center"><p><strong><font style="color:rgb(51, 51, 51);">手册版本</font></strong></p></th>
<th class="head text-center"><p><strong><font style="color:rgb(51, 51, 51);">核心板版本</font></strong></p></th>
<th class="head text-center"><p><strong><font style="color:rgb(51, 51, 51);">底板版本</font></strong></p></th>
<th class="head text-left"><p><strong><font style="color:rgb(51, 51, 51);">更新内容</font></strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>20240605</p></td>
<td class="text-center"><p>V1.0</p></td>
<td class="text-center"><p>V1.0</p></td>
<td class="text-center"><p>V1.1/V2.1</p></td>
<td class="text-left"><p>SDK2.0用户手册初版。</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>20240619</p></td>
<td class="text-center"><p>V1.1</p></td>
<td class="text-center"><p>V1.0</p></td>
<td class="text-center"><p>V1.1/V2.1</p></td>
<td class="text-left"><p>1.替换手册中部分图片；2.修正手册排版格式。</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>20250104</p></td>
<td class="text-center"><p>V1.2</p></td>
<td class="text-center"><p>V1.0</p></td>
<td class="text-center"><p>V1.1/V2.1/V3.1</p></td>
<td class="text-left"><p>1.增加视频播放中对旋转、缩放、偏移的支持，以及双屏显示时指定屏幕播放视频；2.增加对音频芯片NAU88C22的支持。</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p><font style="color:rgb(51, 51, 51);">20250806</font></p></td>
<td class="text-center"><p><font style="color:rgb(51, 51, 51);">V1.3</font></p></td>
<td class="text-center"><p>V1.0</p></td>
<td class="text-center"><p>V2.1/V3.1</p></td>
<td class="text-left"><p><font style="color:rgb(51, 51, 51);">增加TP2855MIPI转4模拟摄像头模块适配</font></p></td>
</tr>
</tbody>
</table>
</section>
<section id="okt507">
<h1>01_OKT507开发板介绍<a class="headerlink" href="#okt507" title="Link to this heading"></a></h1>
<section id="id5">
<h2>1.1  OKT507开发板简介<a class="headerlink" href="#id5" title="Link to this heading"></a></h2>
<p>OKT507-C开发板采用核心板+底板的结构形式，基于全志T507四核车规级处理器设计开发，Cortex-A53架构，主频1.5GHz，集成G31 GPU，内存2GB DDR3L，存储8GB eMMC。OKT507-C开发板将核心板的功能接口资源丰富、提供多种外设接口，如双网卡、CPU内置音频Codec、IIS外置音频Codec、ADC、TF Card、LVDS、RGB、HDMI、WIFI、蓝牙、4G、MIPI_CSI、DVP_CSI等功能接口。同时还预留了4路AHD摄像转MIPI_CSI模组的安装接口，并可选购飞凌设计的转接模组，便于AHD摄像头的功能开发验证。</p>
<p><img alt="Image" src="_images/1718935004391_99cd9d49_dc0b_4b1d_b5c7_c5d7cb95f065.jpeg" /></p>
<ul class="simple">
<li><p><strong>请阅读：</strong></p></li>
</ul>
<p>本软件手册中不再对硬件参数进行叙述，在参考本手册进行软件开发前请阅读“硬件资料\用户手册”路径下的“OKT507-C _硬件手册”，以了解产品命名规则和您所使用产品的硬件配置信息，这样有助于您对本产品的使用。</p>
</section>
<section id="linux-4-9-170">
<h2>1.2  Linux 4.9.170系统软件资源介绍<a class="headerlink" href="#linux-4-9-170" title="Link to this heading"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>设备</strong></p></th>
<th class="head"><p><strong>驱动程序源代码在内核中的位置</strong></p></th>
<th class="head"><p><strong>设备名</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>网卡驱动</p></td>
<td><p>drivers/net/ethernet/allwinner/</p></td>
<td><p>/sys/class/net/eth*</p></td>
</tr>
<tr class="row-odd"><td><p>LCD 背光驱动</p></td>
<td><p>drivers/video/fbdev/sunxi/disp2/disp</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>HDMI驱动</p></td>
<td><p>drivers/video/fbdev/sunxi/disp2/hdmi2/</p></td>
<td><p>/dev/fb1</p></td>
</tr>
<tr class="row-odd"><td><p>LED 驱动</p></td>
<td><p>drivers/leds/leds-gpio.c</p></td>
<td><p>/sys/class/leds/</p></td>
</tr>
<tr class="row-even"><td><p>USB接口U盘</p></td>
<td><p>drivers/usb/storage/</p></td>
<td><p>/dev/sdx</p></td>
</tr>
<tr class="row-odd"><td><p>USB 4G</p></td>
<td><p>drivers/usb/serial/</p></td>
<td><p>/dev/ttyUSB*</p></td>
</tr>
<tr class="row-even"><td><p>USB Camera</p></td>
<td><p>drivers/media/usb/uvc/uvc_video.c</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>SD卡驱动</p></td>
<td><p>drivers/mmc/card/<br/>drivers/mmc/host/sunxi-*</p></td>
<td><p>/dev/block/mmcblk0pX</p></td>
</tr>
<tr class="row-even"><td><p>LCD FrameBuffer</p></td>
<td><p>drivers/video/fbdev/sunxi/disp2/disp/lcd</p></td>
<td><p>/dev/fb0</p></td>
</tr>
<tr class="row-odd"><td><p>串口驱动</p></td>
<td><p>drivers/tty/serial/sunxi-uart.c</p></td>
<td><p>/dev/tty*</p></td>
</tr>
<tr class="row-even"><td><p>看门狗驱动</p></td>
<td><p>drivers/watchdog/sunxi_wdt.c</p></td>
<td><p>/dev/watchdog</p></td>
</tr>
<tr class="row-odd"><td><p>WIFI</p></td>
<td><p>drivers/net/wireless/</p></td>
<td><p>wlan0</p></td>
</tr>
<tr class="row-even"><td><p>蓝牙驱动</p></td>
<td><p>drivers/bluetooth/</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>音频驱动</p></td>
<td><p>sound/soc/sunxi</p></td>
<td><p>/dev/snd/</p></td>
</tr>
<tr class="row-even"><td><p>SPI控制器</p></td>
<td><p>drivers/spi/spi-sunxi.c</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>TWI驱动</p></td>
<td><p>drivers/i2c/busses/i2c-sunxi.c</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>PWM驱动</p></td>
<td><p>drivers/pwm/pwm-sunxi.c</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>OV5640_DVP</p></td>
<td><p>drivers/media/platform/sunxi-vin/modules/sensor/ov5640.c</p></td>
<td><p>/dev/video*</p></td>
</tr>
<tr class="row-even"><td><p>OV5640_MIPI</p></td>
<td><p>drivers/media/platform/sunxi-vin/modules/sensor/ov5640_mipi.c</p></td>
<td><p>/dev/video*</p></td>
</tr>
<tr class="row-odd"><td><p>TP2854M</p></td>
<td><p>drivers/media/platform/sunxi-vin/modules/sensor/tp2854_mipi.c</p></td>
<td><p>/dev/video*</p></td>
</tr>
<tr class="row-even"><td><p><font style="color:rgb(51, 51, 51);">TP2855</font></p></td>
<td><p><font style="color:rgb(51, 51, 51);">drivers/media/platform/sunxi-vin/modules/sensor/tp2815_mipi.c</font></p></td>
<td><p><font style="color:rgb(51, 51, 51);">/dev/video*</font></p></td>
</tr>
<tr class="row-odd"><td><p>GT911触摸驱动</p></td>
<td><p>drivers/input/touchscreen/gt911.c</p></td>
<td><p>/dev/input/event*</p></td>
</tr>
<tr class="row-even"><td><p>GT928触摸驱动</p></td>
<td><p>drivers/input/touchscreen/gt928.c</p></td>
<td><p>/dev/input/event*</p></td>
</tr>
<tr class="row-odd"><td><p>TSC2007触摸驱动</p></td>
<td><p>drivers/input/touchscreen/tsc2007.c</p></td>
<td><p>/dev/input/event*</p></td>
</tr>
<tr class="row-even"><td><p>GPADC驱动</p></td>
<td><p>drivers/input/sensor/sunxi_gpadc.c</p></td>
<td><p>/dev/input/event*</p></td>
</tr>
<tr class="row-odd"><td><p>LRADC按键驱动</p></td>
<td><p>drivers/input/keyboard/sunxi-keyboard.c</p></td>
<td><p>/dev/input/event*</p></td>
</tr>
<tr class="row-even"><td><p>RTC驱动</p></td>
<td><p>drivers/rtc/rtc-rx8010.c</p></td>
<td><p>/dev/rtc0</p></td>
</tr>
<tr class="row-odd"><td><p>IR驱动</p></td>
<td><p>drivers/media/rc/sunxi-ir-dev.c</p></td>
<td><p>/dev/input/event*</p></td>
</tr>
</tbody>
</table>
<p><font style="color:rgb(51, 51, 51);">说明：驱动tp2815同时适配TP2855 MIPI转4模拟摄像头模块 以及 TP2855 MIPI转4模拟摄像头模块。</font></p>
</section>
<section id="id6">
<h2>1.3  烧写及启动设置<a class="headerlink" href="#id6" title="Link to this heading"></a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> OKT507板载一个BOOT拨码开关，支持TF卡和USB OTG烧写，eMMC、TF方式启动，使用拨码开关来区分（如下图所示为eMMC启动时拨码开关位置），具体烧写操作过程请参考“[烧写系统](https://forlinx-book.yuque.com/pxh4d1/ngtapw/zq4ceyo7z4iw07xi)”章节。
</pre></div>
</div>
<p><img alt="Image" src="_images/1718935004893_8ae584e5_7266_4b8a_b39a_d2ac26e9daf1.jpeg" /></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>**           拨码**<br/><strong>模式</strong></p></th>
<th class="head text-center"><p><strong>1</strong></p></th>
<th class="head text-center"><p><strong>2</strong></p></th>
<th class="head text-center"><p><strong>3</strong></p></th>
<th class="head text-center"><p><strong>4</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>TF卡烧写</p></td>
<td class="text-center"><p>OFF</p></td>
<td class="text-center"><p>OFF</p></td>
<td class="text-center"><p>OFF</p></td>
<td class="text-center"><p>OFF</p></td>
</tr>
<tr class="row-odd"><td><p>USB OTG烧写</p></td>
<td class="text-center"><p><strong>ON</strong></p></td>
<td class="text-center"><p>OFF</p></td>
<td class="text-center"><p>OFF</p></td>
<td class="text-center"><p><strong>ON</strong></p></td>
</tr>
<tr class="row-even"><td><p>eMMC启动</p></td>
<td class="text-center"><p><strong>ON</strong></p></td>
<td class="text-center"><p>OFF</p></td>
<td class="text-center"><p>OFF</p></td>
<td class="text-center"><p><strong>ON</strong></p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>**注意：**T507开发板不支持SPI NOR启动。</p></li>
</ul>
</section>
</section>
<section id="id7">
<h1>02_快速开机启动<a class="headerlink" href="#id7" title="Link to this heading"></a></h1>
<section id="id8">
<h2>2.1  开机前的准备<a class="headerlink" href="#id8" title="Link to this heading"></a></h2>
<p>OKT507开发板有串口登录和网络登录两种系统登录方式，系统开机前硬件准备：</p>
<ul class="simple">
<li><p>12V3A DC电源线</p></li>
<li><p>调试串口线（串口登录使用）</p></li>
</ul>
<p>开发板上的调试串口为DB9公头，用户可使用双母头交叉串口线或者USB转RS232串口线连接开发板和PC机，以查看开发板状态信息。</p>
<ul class="simple">
<li><p>网线（网络登录使用）</p></li>
<li><p>屏幕，根据开发板接口连接屏幕（不需要显示的可以不接）</p></li>
<li><p>检查启动方式拨码开关</p></li>
</ul>
<p>请检查您开发板上的拨码开关，确认已经拨到想要的启动方式，启动方式设置请参考“<strong>1.3  烧写及启动设置</strong>”</p>
<p><img alt="Image" src="_images/1718935011928_fa1d7642_9e30_4548_8476_a9d5716a8f4c.png" /></p>
</section>
<section id="id9">
<h2>2.2  串口登录方式<a class="headerlink" href="#id9" title="Link to this heading"></a></h2>
<section id="id10">
<h3>2.2.1  串口登录<a class="headerlink" href="#id10" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>说明：</strong></p></li>
<li><p><strong>串口设置：波特率115200、数据位8、停止位1、无校验位、无流控制。</strong></p></li>
<li><p><strong>串口终端登陆为root用户，无密码，免账户登录。</strong></p></li>
<li><p><strong>软件需求：PC端Windows系统需要安装超级终端软件，超级终端软件有多种，可自行使用自己熟悉的串口终端软件。</strong></p></li>
</ul>
<p>以下以putty为例介绍终端的设置方式：</p>
<p>**步骤一：**使用串口线连接开发板和PC机，确认连接电脑的串口端口号，从“设备管理器”中查看串口端口号，以电脑实际识别的端口号为准。</p>
<p><img alt="Image" src="_images/1718935012349_1fcdd0a3_ea02_4f0a_9d28_2b6b5407c1cf.png" /></p>
<p>**步骤二：**打开putty并设置，serial line根据使用的电脑COM口设置，波特率115200</p>
<p><img alt="Image" src="_images/1718935012815_7e37182d_f685_4711_b784_4430bd2d37be.png" /></p>
<p><img alt="Image" src="_images/1718935013140_f1493e4d_0d69_4ac9_bcaa_8c56aa6d5107.png" /></p>
<p>**步骤三：**打开开发板的电源开关，串口会有打印信息输出，直到出现root&#64;forlinx~/$，完成启动过程，系统默认为root账户，无密码，不用输入登录信息。</p>
</section>
<section id="id11">
<h3>2.2.2  串口登录常见问题<a class="headerlink" href="#id11" title="Link to this heading"></a></h3>
<p>电脑端口没有串口的可以通过USB转串口线与开发板连接，使用USB转串口线接需要安装对应的驱动程序。</p>
<p>建议使用质量好串口线以避免出现乱码情况。</p>
</section>
</section>
<section id="id12">
<h2>2.3  网络登录方式<a class="headerlink" href="#id12" title="Link to this heading"></a></h2>
<section id="id13">
<h3>2.3.1  网络连接测试<a class="headerlink" href="#id13" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>说明：</strong></p></li>
<li><p><strong>默认出厂eth0的IP为192.168.0.232</strong>，<strong>eth1未做设置。</strong></p></li>
<li><p><strong>测试时电脑和开发板需要在同一网段</strong></p></li>
</ul>
<p>在进行网络登录前，需要先确保电脑和开发板直连的网络连接正常，可通过ping指令测试电脑和开发板的连接状态。具体方法操作如下：</p>
<p>1、将开发板的eth0和电脑通过网线连接，给开发板上电，内核启动后核心板上会有蓝色心跳灯闪烁，与电脑连接的网卡在正常启动后网卡灯快速闪烁，此时可以测试网络连接。</p>
<p><img alt="Image" src="_images/1718935013662_38f62af8_3827_4fe5_a718_3142f711a228.png" /></p>
<p>2、<strong>关闭电脑防火墙（此处不作关闭防火墙的介绍，电脑通用操作）</strong>，打开电脑的运行命令</p>
<p><img alt="Image" src="_images/1718935013973_e77e10d1_73d8_466d_8357_632d8580d9cb.png" /></p>
<p>3、使用cmd打开电脑管理员界面，使用ping指令测试电脑和开发板的网络连接状态</p>
<p><img alt="Image" src="_images/1718935014219_df6ce18d_c48c_4523_9da8_acfde731ca79.png" /></p>
<p>有数据返回，网络连接正常。</p>
</section>
<section id="ssh">
<h3>2.3.2  SSH服务器<a class="headerlink" href="#ssh" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>说明：</strong></p></li>
<li><p><strong>默认出厂使用SSH登录的账户root，密码root。</strong></p></li>
<li><p><strong>默认出厂eth0的IP为192.168.0.232。</strong></p></li>
<li><p><strong>可用scp进行文件传输。</strong></p></li>
</ul>
<p><img alt="Image" src="_images/1718935014491_af18accf_bb59_4c47_8931_bacf8815e64c.png" /></p>
<p>点击“Open”,出现如下对话框，点击“是”进入登录界面</p>
<p><img alt="Image" src="_images/1718935014680_395f6649_986a_4f8c_9797_38f4199bfe19.png" /></p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>Login as：root
root@192.168.0.232&#39;s password:               //按照提示输入开发板root账户的密码root
root@forlinx~/root$
</pre></div>
</div>
<p>可以使用WinSCP（软件需要自行安装）拷贝文件</p>
<p><img alt="Image" src="_images/1718935014866_a0b2f531_4a58_4602_8a2b_e4c0285388cc.png" /></p>
</section>
</section>
<section id="id14">
<h2>2.4  屏幕切换<a class="headerlink" href="#id14" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>说明：</strong></p></li>
<li><p><strong>默认为HDMI和LCD（分辨率1024x600）双屏异显，HDMI显示LOGO，LCD显示QT主界面。</strong></p></li>
<li><p><strong>屏幕切换控制支持内核设备树指定、uboot菜单动态控制方式；QT界面UbootMenu应用程序。</strong></p></li>
</ul>
<p>OKT507出厂默认是双屏异显， HDMI显示Logo。</p>
<p><img alt="Image" src="_images/1718935015075_87c1e377_288a_40e3_83c9_245c224b4ebd.png" /></p>
<p>LCD显示主界面：</p>
<p><img alt="Image" src="_images/1718935015307_c9770add_379b_4dc9_90ee_9fb9251ad956.png" /></p>
<p>OKT507支持RGB、HDMI等多种屏幕接口，同时可以进行两个屏幕的同显和异显，可灵活指定HDMI接口支持4K输出。目前屏幕切换控制方式有三种：内核设备树指定、uboot菜单动态控制；QT界面UbootMenu应用程序。</p>
<p>目前OKT507-C支持HDMI、LVDS 1280x800、LCD7 1024x600、LCD7 800x480 电容屏、LCD7 800x480 电阻屏。</p>
<section id="id15">
<h3>2.4.1  内核设备树指定方式<a class="headerlink" href="#id15" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>设备树路径为：linux-4.9/arch/arm64/boot/dts/sunxi/OKT507-C-Common.dtsi</p></li>
</ul>
<p>该方式可设置系统默认屏幕显示为所期望的方式，不用连接串口终端选择，适合量产。但需要手工修改设备树，重新生成一次系统镜像。该方式优先级高于uboot菜单动态控制。</p>
<p>内核源码中，打开设备dts文件，找到如下节点：</p>
<p><img alt="Image" src="_images/1718935015642_812d597b_7e7d_4421_b98c_1636b3682f4d.png" /></p>
<p><strong>参数说明：</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p><strong>含义</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>status</p></td>
<td><p>描述节点状态：disabled为关闭节点，okay使能节点</p></td>
</tr>
<tr class="row-odd"><td><p>disp_lcd_type</p></td>
<td><p>描述lcd接口类型</p></td>
</tr>
<tr class="row-even"><td><p>disp_hdmi_type</p></td>
<td><p>描述HDMI屏分辨率</p></td>
</tr>
<tr class="row-odd"><td><p>disp_camera_type</p></td>
<td><p>描述Camera MIPI</p></td>
</tr>
<tr class="row-even"><td><p>disp_mode</p></td>
<td><p>描述显示类型： 1代表单显LCD，2代表单显hdmi，3代表异显，4代表同显</p></td>
</tr>
</tbody>
</table>
<p>其中disp_lcd_type（描述lcd接口类型）代表的含义如下：</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p><strong>参数</strong></p></th>
<th class="head"><p><strong>含义</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>4</p></td>
<td><p>7寸800x480电阻屏</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>3</p></td>
<td><p>7寸800x480电容屏</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>2</p></td>
<td><p>7寸1024x600电容屏</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>1</p></td>
<td><p>10.1寸1280x800电容屏</p></td>
</tr>
</tbody>
</table>
<p><strong>举例：</strong></p>
<p>配置成同显模式，主屏为电容屏1280x800，副屏为HDMI接口屏 4096x2160P50。</p>
<p><img alt="Image" src="_images/1718935015831_5df71fc5_79c8_4d4e_86ad_3102a3ad69b4.png" /></p>
<p>用户根据需求更改设置参数，保存后，需要重新编译生成镜像。</p>
</section>
<section id="uboot">
<h3>2.4.2  uboot菜单动态控制方式<a class="headerlink" href="#uboot" title="Link to this heading"></a></h3>
<p>该方式在现有已支持屏幕的基础上不需要重新编译和烧写，即可切换屏幕。</p>
<p><strong>2.4.2.1各级菜单介绍</strong></p>
<p>1、一级菜单</p>
<p>在uboot自启动过程中串口终端按下空格键，即可弹出控制选项，显示一级菜单：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>---------------------------------------------
0: Exit to console
1: Reset
2: Set Lcd  Display
3: Set HDMI Display
4: Set Camera Type
5: Set Display mode
---------------------------------------------
</pre></div>
</div>
<p>菜单功能选项如下表：</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p><strong>序号</strong></p></th>
<th class="head"><p><strong>功能选项</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>0</p></td>
<td><p>进入到boot的命令行模式</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>1</p></td>
<td><p>开发板重启</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>2</p></td>
<td><p>进入LCD屏幕控制子菜单</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>3</p></td>
<td><p>进入HMDI控制子菜单</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>4</p></td>
<td><p>进入Camera控制子菜单</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>5</p></td>
<td><p>进入控制显示模式子菜单</p></td>
</tr>
</tbody>
</table>
<p>2、二级菜单选择LCD屏类型</p>
<p>一级菜单中选择“2”，进入二级菜单，如下图：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>---------------------------------------------
uboot_disp_mode:single lcd
0:Exit to console
1:LVDS 1280x800 cap
2:LCD 1024x600 cap
3:LCD 800x480 cap
4:LCD 800x480 res
c:NULL
---------------------------------------------
</pre></div>
</div>
<p>菜单功能选项如下表</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p><strong>序号</strong></p></th>
<th class="head"><p><strong>功能选项</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>0</p></td>
<td><p>退出，返回上级菜单</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>1</p></td>
<td><p>选择 10.1寸1280x800电容屏</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>2</p></td>
<td><p>选择 7寸1024x600电容屏</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>3</p></td>
<td><p>选择 7寸800x480电容屏</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>4</p></td>
<td><p>选择 7寸800x480电阻屏</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>c</p></td>
<td><p>不设参数</p></td>
</tr>
</tbody>
</table>
<p>3、二级菜单选择HDMI类型</p>
<p>一级菜单选择3后，为HDMI屏幕配置菜单，如下</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>---------------------------------------------
Current Secondary Display is hdmi 1280x720P50
0:Exit to console
1:1280x720P50
2:1280x720P60
3:1920x1080P50
4:1920x1080P60
5:3840x2160P50
6:3840x2160P60
7:4096x2160P50
8:4096x2160P60
c:NULL
---------------------------------------------
</pre></div>
</div>
<p>菜单功能选项如下表</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p><strong>序号</strong></p></th>
<th class="head"><p><strong>功能选项</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>0</p></td>
<td><p>退出，返回上级菜单</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>1</p></td>
<td><p>屏幕分辨率是1280x720 ，帧数50</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>……</p></td>
<td><p>……</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>c</p></td>
<td><p>不设参数</p></td>
</tr>
</tbody>
</table>
<p>4、二级菜单选择Camera类型</p>
<p>一级菜单选择4后，为Camera配置菜单，如下</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>---------------------------------------------
Current Camera is OV5640
0:Exit to console
1:Set Camera OV5640
2:Set Camera TP2854M
3:Set Camera TP2815
c:NULL
---------------------------------------------
</pre></div>
</div>
<p>菜单功能选项如下表</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p><strong>序号</strong></p></th>
<th class="head"><p><strong>功能选项</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>0</p></td>
<td><p>退出，返回上级菜单</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>1</p></td>
<td><p>设置Camera MIPI为OV5640</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>2</p></td>
<td><p>设置Camera MIPI 为TP2854M</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>3</p></td>
<td><p><font style="color:rgb(51, 51, 51);">设置Camera MIPI 为TP2855\TP2815</font></p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>c</p></td>
<td><p>不设参数</p></td>
</tr>
</tbody>
</table>
<p>5、二级菜单选择显示模式类型</p>
<p>一级菜单选择5后，为显示模式配置菜单，如下</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>---------------------------------------------
Current display is mode: Separate display primary lcd, secondary hdmi
0:Exit to console
1:Single lcd display
2:Single hdmi display
3:Separate display
4:Synchronous display
---------------------------------------------
</pre></div>
</div>
<p>菜单功能选项如下表</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p><strong>序号</strong></p></th>
<th class="head"><p><strong>功能选项</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>0</p></td>
<td><p>退出，返回上级菜单</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>1</p></td>
<td><p>设置单显，LCD屏显示</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>2</p></td>
<td><p>设置单显，HDMI屏显示</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>3</p></td>
<td><p>设置异显，主屏为LCD，副屏为HDMI</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>4</p></td>
<td><p>设置同显，主屏为LCD，副屏为HDMI</p></td>
</tr>
</tbody>
</table>
<p><strong>2.4.2.2屏幕切换方法</strong></p>
<p>以下以切换为LVDS 1280x800单屏显示为例进行说明：</p>
<p>在uboot自启动过程中串口终端按下空格键，进入到uboot菜单界面：</p>
<p><img alt="Image" src="_images/1718935016042_71b28a6e_1881_4dfd_9c4a_24410ec654e2.png" /></p>
<p>选择2，进入LCD屏幕控制子菜单</p>
<p><img alt="Image" src="_images/1718935016238_946edb14_9bd2_4dfb_9ebb_c1453a6d6528.png" /></p>
<p>如上图选择1，进入选择LCD配置子菜单</p>
<p><img alt="Image" src="_images/1718935016436_8ab11568_89d9_4da1_bcec_e025f12f4eb1.png" /></p>
<p>选择1，设置为LVDS 1280x800，设置完后在选择0，返回上级菜单</p>
<p><img alt="Image" src="_images/1718935016673_c66188d6_08d5_4978_ab4a_43b872fb8bd0.png" /></p>
<p>选择5，进入显示模式参数配置菜单</p>
<p><img alt="Image" src="_images/1718935016870_f9ac6fc2_f5aa_4e8d_9683_1008450a6bb6.png" /></p>
<p>如上图选择5，进入显示模式配置子菜单</p>
<p><img alt="Image" src="_images/1718935017113_fd5b6c88_dfa8_4e59_9c5c_fb8eb3e7f44d.png" /></p>
<p>选择1，设置LCD 单显，设置完后在选择0，返回上级菜单</p>
<p><img alt="Image" src="_images/1718935017342_3212cdb7_154c_47cc_a6a6_0abefee609a5.png" /></p>
<p>选择完成后，按复位键重新启动（或者根据菜单提示，返回到第一级uboot菜单选择reboot），重新启动后生效。</p>
</section>
</section>
<section id="id16">
<h2>2.5  电阻屏重新校准<a class="headerlink" href="#id16" title="Link to this heading"></a></h2>
<p>当您使用电阻屏时，需要默认使用tslib校准，如需重新校准请执行：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ /usr/bin/ts_calibrate
</pre></div>
</div>
<p>校准文件保存在/etc/pointercal</p>
</section>
<section id="id17">
<h2>2.6  系统分区<a class="headerlink" href="#id17" title="Link to this heading"></a></h2>
<p>下面表格是Linux操作系统的eMMC存储器分区信息：</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p><strong>分区索引</strong></p></th>
<th class="head text-center"><p><strong>名称</strong></p></th>
<th class="head text-center"><p><strong>大小/MB</strong></p></th>
<th class="head text-center"><p><strong>文件系统</strong></p></th>
<th class="head"><p><strong>内容</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>mmcblk0p1</p></td>
<td class="text-center"><p>Loader</p></td>
<td class="text-center"><p>32</p></td>
<td class="text-center"><p>FAT32</p></td>
<td><p>boot-resource.fex</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>mmcblk0p2</p></td>
<td class="text-center"><p>Env</p></td>
<td class="text-center"><p>16</p></td>
<td class="text-center"><p>RAW</p></td>
<td><p>env.fex</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>mmcblk0p3</p></td>
<td class="text-center"><p>boot</p></td>
<td class="text-center"><p>64</p></td>
<td class="text-center"><p>RAW</p></td>
<td><p>boot.fex</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>mmcblk0p4</p></td>
<td class="text-center"><p>rootfs</p></td>
<td class="text-center"><p>7040</p></td>
<td class="text-center"><p>Ext4</p></td>
<td><p>rootfs.fex</p></td>
</tr>
</tbody>
</table>
<p>使用df命令查看系统上磁盘使用情况，df –m是以MB为单位显示文件系统磁盘空间使用情况。如下图为出厂默认磁盘使用情况（使用的qt文件系统），仅供参考，具体参数请以实际为准。</p>
<p><img alt="Image" src="_images/1718935017573_8c459dcd_9fcb_4305_a698_b6c268449ef2.png" /></p>
<p>使用free命令查看内存使用情况，如下图为不接任何外设情况下的内存使用情况，仅供参考，具体参数请以实际为准。</p>
<p><img alt="Image" src="_images/1718935017749_2bbfadc0_7533_43cb_bf54_2034693e6c0f.png" /></p>
</section>
<section id="id18">
<h2>2.7  系统关闭<a class="headerlink" href="#id18" title="Link to this heading"></a></h2>
<p>一般情况下直接关闭电源即可，如果有数据存储、功能使用等操作，操作过程中不要随意断电，以防出现文件不可逆损坏，只能重新烧写固件。未确保数据完全写入，可输入 sync 命令完成数据同步后再关闭电源。</p>
<p>开发板重启可执行命令reboot。也可以硬件重启，按K8（RESET）键或直接断电重启，长按PWRON可以开关机。</p>
<ul class="simple">
<li><p>注意：用户依据核心板设计的产品，若在使用中存在意外掉电导致系统异常的情景，可在设计中加入掉电保护等措施。</p></li>
</ul>
</section>
</section>
<section id="id19">
<h1>03_OKT507平台界面功能使用及测试<a class="headerlink" href="#id19" title="Link to this heading"></a></h1>
<ul class="simple">
<li><p><strong>说明：</strong></p></li>
<li><p><strong><font style="color:#000000;">用户使用屏幕和qt文件系统时进行该章节操作，若不用QT操作，可跳过该章节。</font></strong></p></li>
<li><p><strong><font style="color:#000000;">本章节着重描述qt中的功能，测试时默认设备连接正常，驱动加载正常，建议完成命令行功能测试后在测试界面功能。</font></strong><font style="color:#000000;"> </font></p></li>
<li><p>QT测试程序源码路径：源码（OKT507-linux-sdk20）/platform/framework/auto/fltest_qt_demo</p></li>
<li><p>开发板文件系统中测试程序路径：/usr/bin</p></li>
</ul>
<p>此章节主要说明开发板外扩接口的在QT界面中使用方法，测试程序仅用于参考，用户使用时需要根据实际情况进行调整。</p>
<section id="id20">
<h2>3.1  界面功能简介<a class="headerlink" href="#id20" title="Link to this heading"></a></h2>
<p>开发板启动后桌面显示如下：</p>
<p><img alt="Image" src="_images/1718935027183_52ee4531_f984_4daf_a129_f654fb30666a.png" /></p>
<p><img alt="Image" src="_images/1718935027464_9685b464_7d93_4168_8018_b28354dce3d6.jpeg" /></p>
</section>
<section id="id21">
<h2>3.2  音视频播放体验<a class="headerlink" href="#id21" title="Link to this heading"></a></h2>
<p>图标：<img alt="Image" src="_images/1718935027670_942d1873_f831_4205_9897_a2cdc7a9562b.png" /></p>
<p>点击音视频播放图标进入视频播放器，可以播放音乐和视频。默认声音是从lineout输出（输出接口可选），lineout可以接耳机或者音箱。</p>
<p><img alt="Image" src="_images/1718935027953_27a9e7a4_1923_4b62_9d53_659757b2354c.jpeg" /></p>
<p>点击左侧的视频播放器图标，进入视频播放器界面，点击搜索按钮，选择	/forlinx/media/1080p_60fps_h264.mp4 或者/forlinx/media/1080p_60fps_h265.mp4进行播放测试。</p>
<p><img alt="Image" src="_images/1718935028141_49feb77a_1e37_4ff0_92df_51fc31ef89d7.png" /></p>
<p>点击右侧音频播放器图标：</p>
<p><img alt="Image" src="_images/1718935028388_017318b8_3681_4da2_a87b_77f0c21a192d.png" /></p>
<p><img alt="Image" src="_images/1718935028685_f20644bf_db68_4d92_8835_213a4fc564a1.png" />代表使用LINEOUT播放音乐，<img alt="Image" src="_images/1718935028887_258fc186_f82e_490a_b212_02e76eb4a617.png" />代表使用HeadPhone播放音乐，</p>
<p><img alt="Image" src="_images/1718935029155_2d58344c_a843_446b_9a8f_dbd339ab2db6.png" />代表使用HDMI播放音乐。</p>
</section>
<section id="opengl">
<h2>3.3  OpenGL测试<a class="headerlink" href="#opengl" title="Link to this heading"></a></h2>
<p>图标：<img alt="Image" src="_images/1718935029363_f324376d_884c_40e5_9680_6791bd0e7371.png" /></p>
<p>OKT507最高支持OpenGL ESv3.2，点击OpenGL图标进行测试。</p>
<p><img alt="Image" src="_images/1718935029603_ec6e8ad6_f5ae_4368_bda5_8fe69a7de53e.jpeg" /></p>
<p>点击左上角File，选择exit，退回主界面。</p>
</section>
<section id="id22">
<h2>3.4  网络配置测试<a class="headerlink" href="#id22" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>说明：</strong></p></li>
<li><p><strong>出厂默认仅设置eth0网卡为STATIC模式，eth1网卡未配置；</strong></p></li>
<li><p><strong>设置的ip等信息会被保存至系统的相关配置文件（/etc/network/interfaces）中，因此每次重启都会使用本次设置的网络信息。</strong></p></li>
</ul>
<p>图标：<img alt="Image" src="_images/1718935029816_a9ac65f5_619d_48dc_a614_df6f46ada805.png" /></p>
<p>点击网络配置图标进入界面程序，支持STATIC和DHCP两种模式。</p>
<ul class="simple">
<li><p>STATIC模式</p></li>
</ul>
<p>点击网络配置图标，选择STATIC，如下图：可配置ip地址、子网掩码、网关、dns，设置完参数后点击“Apply and Restart Network”。</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>相关参数</strong></p></th>
<th class="head"><p><strong>含义</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>interface</p></td>
<td><p>设置网卡</p></td>
</tr>
<tr class="row-odd"><td><p>getmask</p></td>
<td><p>设置子网掩码</p></td>
</tr>
<tr class="row-even"><td><p>gateway</p></td>
<td><p>设置网关</p></td>
</tr>
<tr class="row-odd"><td><p>dns</p></td>
<td><p>设置DNS</p></td>
</tr>
</tbody>
</table>
<p><img alt="Image" src="_images/1718935030119_8c0fea49_701f_4e85_87de_c0c3961e7659.jpeg" /></p>
<ul class="simple">
<li><p>DHCP模式界面如下：</p></li>
<li><p><strong>注意：必须在可以自动分配ip的路由器下进行测试</strong></p></li>
</ul>
<p>选中DHCP，在interface中选中需要配置的网卡设备，点击界面下方的”Apply and Restart Network”，即自动重启网络并自动获取到ip。</p>
<p><img alt="Image" src="_images/1718935030357_db8197a1_4358_4c74_afe5_d2d4f95f55fd.jpeg" /></p>
</section>
<section id="id23">
<h2>3.5  浏览器测试<a class="headerlink" href="#id23" title="Link to this heading"></a></h2>
<p>图标：<img alt="Image" src="_images/1718935030522_128af5df_ee6e_4af5_a300_eac4352165ac.jpeg" /></p>
<p>点击浏览器图标进入browser，在使用时请保证网络通畅，访问外网前需保证dns可用，浏览器启动时默认访问飞凌嵌入式官方网站，界面如下：</p>
<p><img alt="Image" src="_images/1718935030785_235c2515_5985_44a0_89d6_12e69f393bb1.png" /></p>
<ul class="simple">
<li><p>**注意：**如果开发板的时间异常会导致证书问题。</p></li>
</ul>
</section>
<section id="g">
<h2>3.6  4G测试<a class="headerlink" href="#g" title="Link to this heading"></a></h2>
<p>图标：<img alt="Image" src="_images/1718935031094_34e37d8a_e0a3_49ae_9b40_11b2855e33b1.png" /></p>
<p>“4G”测试程序用于测试OKT507外置4G模块(ME909S和EC20)。测试前请将开发板断电，接入4G模块，插入SIM卡（注意SIM卡方向），启动开发板打开测试应用，本测试以EC20为例：</p>
<p><img alt="Image" src="_images/1718935031331_2a89dbb5_8938_4e7a_8f5b_871e89e7dac6.png" /></p>
<p><img alt="Image" src="_images/1718935031552_09e3871e_6a04_41b4_9519_2113698d2f57.png" /></p>
<p>点击connect按钮，程序将自动进入拨号流程并获取IP设置DNS等，耐心等待几秒钟后，点击ping按钮进行测试。</p>
</section>
<section id="uart">
<h2>3.7  UART测试<a class="headerlink" href="#uart" title="Link to this heading"></a></h2>
<p>图标：<img alt="Image" src="_images/1718935031783_572d6933_6b3a_4260_be6f_a718e0bef5b2.png" /></p>
<p>本次测试采用UART5(ttyS5)，通过开发板的UART和电脑串口工具软件之间的数据收发，来进行串口测试。</p>
<p>1、开发板和电脑通过TTL转USB模块连接好后，给开发板上电，在电脑设备管理器查看识别为COM4（用户以自己实际识别的COM口设置参数）</p>
<p><img alt="Image" src="_images/1718935032012_03d95e26_515c_47bd_ade8_e6bfdc5df8c7.png" /></p>
<p>2、打开电脑串口工具，设置串口参数：波特率115200、8位数据位、1位停止位、无校验、无流控制，并打开串口。</p>
<p><img alt="Image" src="_images/1718935032280_17dcf6c0_381b_4bd2_9633_811ce66d9332.png" /></p>
<p>3、点击UART测试图标，进入如下界面，进行串口参数设置：</p>
<p><img alt="Image" src="_images/1718935032555_4824fff2_c0ca_492c_a464_9d8a7aa42150.jpeg" /></p>
<p>点击左上角<img alt="Image" src="_images/1718935032769_f49dd79e_fc57_4a8c_bc04_4d1d21233834.png" />设置按钮，设置串口参数与电脑端串口工具参数一致，如下图：</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>相关参数</strong></p></th>
<th class="head"><p><strong>含义</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Select Serial Port</p></td>
<td><p>设置串口（选择UART5，即ttyS5）</p></td>
</tr>
<tr class="row-odd"><td><p>BaudRate</p></td>
<td><p>设置波特率（115200）</p></td>
</tr>
<tr class="row-even"><td><p>Data bits</p></td>
<td><p>设置数据位（8位）</p></td>
</tr>
<tr class="row-odd"><td><p>Parity</p></td>
<td><p>设置校验位（无校验）</p></td>
</tr>
<tr class="row-even"><td><p>Stop bits</p></td>
<td><p>设置停止位（1位）</p></td>
</tr>
<tr class="row-odd"><td><p>Flow control</p></td>
<td><p>设置流控（无流控）</p></td>
</tr>
</tbody>
</table>
<p><img alt="Image" src="_images/1718935032992_c5465c3b_b22c_4084_93c6_994f5cb5ef5f.jpeg" /></p>
<p>设置完串口参数后，点击左上角的<img alt="Image" src="_images/1718935033182_42e2e8e4_5bf2_42db_8315_76055b2ed99d.png" />连接按钮，此时测试程序可以进行数据收发测试。</p>
<p>4、此时电脑端串口工具发送：“forlinx_uart_test.1234567890…”，测试界面会接收到数据：</p>
<p><img alt="Image" src="_images/1718935033521_53bf2f0c_ee4b_451e_b61c_dd42e28862a9.jpeg" /></p>
<p>点击测试界面会弹出软键盘，输入“abcdefg”，按软键盘的回车，向电脑端串口工具发送数据：</p>
<p><img alt="Image" src="_images/1718935033757_21f26374_2c48_411b_8afa_52bf4506432f.jpeg" /></p>
<p>电脑端串口工具接收到数据：</p>
<p><img alt="Image" src="_images/1718935034082_8de83c9b_8fc7_43eb_a040_fd378352e9ef.png" /></p>
</section>
<section id="adc">
<h2>3.8  ADC测试<a class="headerlink" href="#adc" title="Link to this heading"></a></h2>
<p>图标：</p>
<p><img alt="Image" src="_images/1718935034365_84e76029_0e99_4416_83f1_ce18b83c17f2.png" /></p>
<p>在OKT507-C的底板上，GPADC 3通道连接了一个可变电阻，可变电阻的阻值，数值会发生相应的变化。最大值4096对应电压1.8V。点击ADC测试图标，通过调节可变电阻对GPADC 3通道进行测试</p>
<p><img alt="Image" src="_images/1718935034605_f1597a58_ca19_4088_8911_23a110ee2e2d.jpeg" /></p>
</section>
<section id="wifi">
<h2>3.9  WIFI测试<a class="headerlink" href="#wifi" title="Link to this heading"></a></h2>
<p>图标：<img alt="Image" src="_images/1718935034830_bd2f850d_52f8_4637_bee4_ba8ce9df15ee.png" /></p>
<p>“WIFI”是一款配置wifi的工具，可以测试wifi的STA模式。</p>
<p>1、点击图标，进入测试界面，下拉菜单选择相应的模块，SSID栏中输入需要使用wifi连接的路由器名称，PAWD栏输入路由器密码，点击”connect”，即可通过wifi连接路由器：</p>
<p><img alt="Image" src="_images/1718935035117_738b20ce_9cce_405d_9268_594a13692b89.png" /></p>
<p>2、连接成功后，设置IP后可点击”ping”进行网络测试</p>
<p><img alt="Image" src="_images/1718935035412_e6ba5f3f_21c5_408b_acbd_6f9aac9238cc.png" /></p>
</section>
<section id="rtc">
<h2>3.10  RTC测试<a class="headerlink" href="#rtc" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>注意：确保板子上已经安装了纽扣电池，并且电池电压正常</strong></p></li>
</ul>
<p>图标：<img alt="Image" src="_images/1718935035726_d073b352_fa62_4513_9b18_675c9c1cde7d.png" /></p>
<p>RTC 测试是通过测试软件设置时间后，断电重启，再次运行测试软件，查看RTC 时钟是否同步。</p>
<p>运行RTC测试软件 RTC，可查看和设置当前的系统时间，界面如下：</p>
<p><img alt="Image" src="_images/1718935035970_9ebe02f6_4416_4e7f_af8f_4a003432d1ba.jpeg" /></p>
<p>点击”set”后，即可进行时间的设置，设置完毕点击保存，即可设置完成。<font style="color:#000000;">然后可以断电，过段时间再上电，再次运行 RTC测试软件自动读取时间，可以看到 RTC 时间已同步，RTC测试正常</font></p>
</section>
<section id="id24">
<h2>3.11  按键测试<a class="headerlink" href="#id24" title="Link to this heading"></a></h2>
<p>图标：<img alt="Image" src="_images/1718935036205_d09c2668_f9d9_4559_9040_9f83e3aa83ea.png" /></p>
<p>“Keypad”用于测试平台自带按键是否可用，通过检测按键按下后相应按键是否会变蓝判断按键功能是否正常，界面如下：</p>
<p><img alt="Image" src="_images/1718935036403_041ee2b0_184c_4d09_88af_3e97ea503de2.jpeg" /></p>
<p>OKT507平台有五个物理按键VOL-、VOL+、MENU、ENTER、HOME分别对应V+、V-、Home、Menu、Enter，当按下按键时测试应用中的对应按键会变为蓝色，说明按键功能正常。</p>
<ul class="simple">
<li><p>**注意：**目前该应用只能在按键按下的时候上报键值。</p></li>
</ul>
</section>
<section id="id25">
<h2>3.12  看门狗测试<a class="headerlink" href="#id25" title="Link to this heading"></a></h2>
<p>图标：<img alt="Image" src="_images/1718935036648_1c1c3cfd_f9a2_4017_861f_28b060316bb0.png" /></p>
<p>“WatchDog”是用来测试看门狗功能是否正常的应用，界面如下：</p>
<p><img alt="Image" src="_images/1718935036876_7edbd3d3_532b_4621_ab5f_7d779cd32fc6.jpeg" /></p>
<p>勾选”feed dog”，点击”open watchdog”按键，此时看门狗功能会被启动，程序会进行喂狗操作，正常情况下系统不会重启；</p>
<p>取消勾选”feed dog”时，点击”open watchdog”按键，看门狗功能会被启动，程序不进行喂狗操作，在打开看门狗约10s后，系统进入重启，说明看门狗功能正常。</p>
</section>
<section id="ping">
<h2>3.13  Ping测试<a class="headerlink" href="#ping" title="Link to this heading"></a></h2>
<p>图标：<img alt="Image" src="_images/1718935037195_6236cc9e_c637_4949_9778_334d87678a2f.png" /></p>
<p>“Ping”是网络测试常用命令ping的界面版应用，界面如下：</p>
<p><img alt="Image" src="_images/1718935037430_b6102612_ac77_4b88_aed1_166bb5d3d6d8.jpeg" /></p>
<p>在hostname一栏中写人需要ping的目标ip，点击”ping”键后，result栏中会提示ping的结果，如图中所示说明彼此网络通畅，点击stop可停止ping测试，点击”clear”清空result中的信息。</p>
</section>
<section id="camera">
<h2>3.14  Camera测试<a class="headerlink" href="#camera" title="Link to this heading"></a></h2>
<p>图标：<img alt="Image" src="_images/1718935037674_544af84d_9cd7_4938_a870_b7f2a9682c63.png" /></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>点击图标进入camera测试程序，测试程序兼容mipi、dvp接口。.
</pre></div>
</div>
<p><img alt="Image" src="_images/1718935037844_b5f3fc8a_649a_4cf9_a2ec_9965c2928afb.png" /></p>
<p>请先选择camera video设置设备节点，camera resolution设置分辨率， 点击”start”按钮开始采集camera，点击”stop”按钮停止采集camera， 点击”picture”按钮拍照，拍照图片保存路径以及文件名字。</p>
<ul class="simple">
<li><p>**注意：**请根据实际情况选择camera设备和分辨率</p></li>
</ul>
<p>以ov5640_mipi摄像头为例，进行camera测试。</p>
<p><img alt="Image" src="_images/1718935038156_dd84924b_71a0_4f95_a896_9cffd035bd57.png" /></p>
<p>点击”picture”按钮拍照，文件保存目录为/root/，请使用windows自带看图工具查看.</p>
<p><img alt="Image" src="_images/1718935038511_c729bb8c_1d34_4a68_afa8_69c324a5727a.png" /></p>
</section>
<section id="id26">
<h2>3.15  背光测试<a class="headerlink" href="#id26" title="Link to this heading"></a></h2>
<p>图标：<img alt="Image" src="_images/1718935038807_21987aa6_0f55_4df5_a578_7aaede9280f3.png" /></p>
<p>“BackLight”是lcd背光调整应用，左右调节进度条，可以调节背光亮度，点击打开后界面如下：</p>
<p><img alt="Image" src="_images/1718935038995_7e751b2c_69fe_47d4_9e4f_64253fc8c025.jpeg" /></p>
<p>拖动界面中的滑块即可设置Lcd背光亮度，0级为弱背光，255（150级）为最高亮度。</p>
</section>
<section id="id27">
<h2>3.16  录音测试<a class="headerlink" href="#id27" title="Link to this heading"></a></h2>
<p>图标：<img alt="Image" src="_images/1718935039213_1d2c7f64_b628_45c0_87ce_bf61c402ed00.png" /></p>
<p>在进行录音测试前，请将准备好的麦克插入mic接口，点击图标，进入录音测试应用，可用来测试声卡录音功能是否正常。</p>
<p>选择保存录音文件位置，按钮”开始”代表 开始录音，按钮”停止”代表停止录音，界面如下：</p>
<p><img alt="Image" src="_images/1718935039401_f305d854_0646_4dd1_8053_96a7089b054a.jpeg" /></p>
</section>
<section id="cpu">
<h2>3.17  CPU频率配置测试<a class="headerlink" href="#cpu" title="Link to this heading"></a></h2>
<p>OKT507 CPU主频最大1.5Ghz，默认情况下CPU会根据负载动态调整主频，也可以通过设置固定CPU主频率。</p>
<p>点击桌面设置图标<img alt="Image" src="_images/1718935039679_541e08e3_1716_41e7_86f4_46dcab113b90.png" />进入下一级菜单：</p>
<p><img alt="Image" src="_images/1718935039898_51dc12f7_fb05_4c6a_a85c_d84aae9d16cc.jpeg" /></p>
<p>点击图标<img alt="Image" src="_images/1718935040162_fb56c646_a7d0_4c29_b36d_24e3fbf7322b.png" />，进入CPU主频设置页面，</p>
<p><img alt="Image" src="_images/1718935040447_afa1d909_b0da_44cb_8de7_b1d66f8a99ea.jpeg" /></p>
<p>Set OnDemand Governor：按需动态调整主频</p>
<p>Set Userspace Governor：用户态设置主频</p>
<p>Set Frequency：设置核主频</p>
<p>以设置主核频率为例：先点击”Set Userspace Governor”，弹出对话框选择“run”，再点击”Set Frequency”进行设置固定频率。（点击右上角箭头返回上一级目录，点击右上角图标返回主目录）。</p>
<p><img alt="Image" src="_images/1718935040631_87be5778_4dfa_47d7_b9a7_0e79d913f934.jpeg" /></p>
<p>根据需求选择对应的频率进行设置。</p>
</section>
<section id="sqlite3">
<h2>3.18  SQLite3数据库测试<a class="headerlink" href="#sqlite3" title="Link to this heading"></a></h2>
<p>图标：<img alt="Image" src="_images/1718935040880_15c2bcbd_7dad_464f_9c8a_0e0e7e95a149.jpeg" /></p>
<p>点击图标进入数据库测试界面</p>
<p><img alt="Image" src="_images/1718935041103_c2c88eba_067a_446d_b2c1_f05c65390c17.png" /></p>
<p>选中需要修改那一栏，修改完成点击空白部分区域。</p>
<p><img alt="Image" src="_images/1718935041487_748e4dbc_d200_4dcf_9859_8c336c9854f2.png" /></p>
</section>
<section id="id28">
<h2>3.19  UBOOT菜单配置测试<a class="headerlink" href="#id28" title="Link to this heading"></a></h2>
<p>点击<img alt="Image" src="_images/1718935041742_4a39b862_6062_4853_ab0b_a984cda567bc.png" />图标进入UBOOT菜单配置测试界面。</p>
<p>在UBOOT菜单配置测试程序中，可以配置LCD屏分辨率、HDMI分辨率、摄像头设备、显示模式等。</p>
<p>LCD屏配置界面如下：</p>
<p><img alt="Image" src="_images/1718935041939_ef5f5e5b_8ecb_4d7b_a88a_6276a3a4fb60.png" /></p>
<p>HDMI配置界面如下：</p>
<p><img alt="Image" src="_images/1718935042154_59c99250_0ceb_4161_b635_678961cbab7c.png" /></p>
<p>摄像头配置界面如下：可以选择使用OV5640MIPI摄像头或者TP2854M四合一MIPI模拟摄像头。</p>
<p><img alt="Image" src="_images/1718935042324_1e4e584f_6a03_4340_b4a9_9a5282586dec.png" /></p>
<p>显示模式配置界面如下：四个选项分别表示：单显LCD，单显HDMI，异显，同显。</p>
<p><img alt="Image" src="_images/1718935042532_004adf66_f051_49b3_98d3_d963d73c80cc.png" /></p>
<p>配置完成后退出程序，然后重启开发板，设置即可生效。</p>
<ul class="simple">
<li><p>**注意：**在设备树linux-4.9/arch/arm64/boot/dts/sunxi/OKT507-C-Common.dtsi 文件里forlinx_control节点设置成”okay”之后使用UbootMenu应用配置无效。</p></li>
</ul>
</section>
</section>
<section id="id29">
<h1>04_OKT507命令行功能测试<a class="headerlink" href="#id29" title="Link to this heading"></a></h1>
<p>OKT507平台内置了丰富的命令行工具可供用户使用。</p>
<ul class="simple">
<li><p>测试程序源码路径：用户资料/linux/源码（OKT507-linux-sdk/platform/framework/auto/fltest_cmd_demo）</p></li>
<li><p>测试程序路径：/usr/bin</p></li>
</ul>
<section id="id30">
<h2>4.1  系统信息查询<a class="headerlink" href="#id30" title="Link to this heading"></a></h2>
<p>查看内核和cpu信息，输入如下命令：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ uname -a
Linux t507 4.9.170 #2 SMP PREEMPT Thu Aug 12 02:42:48 UTC 2021 aarch64 GNU/Linux
</pre></div>
</div>
<p>查看操作系统信息：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ cat /proc/cpuinfo
</pre></div>
</div>
<p>查看环境变量信息：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ env
</pre></div>
</div>
</section>
<section id="id31">
<h2>4.2  调频测试<a class="headerlink" href="#id31" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>说明：此过程以cpu0为例操作，实际过程cpu1、cpu2、cpu3会同时改变。</strong></p></li>
</ul>
<p>1、当前内核中支持的所有cpufreq governor类型：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ cat /sys/devices/system/cpu/cpu0/cpufreq/scaling_available_governors
interactive  conservative  ondemand  userspace  powersave  performance  schedutil
</pre></div>
</div>
<p>其中userspace表示用户模式，在此模式下允许其他用户程序调节CPU频率。</p>
<p>2、查看当前CPU支持的频率档位</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ cat /sys/devices/system/cpu/cpu0/cpufreq/scaling_available_frequencies
480000 600000 792000 1008000 1200000 1512000
</pre></div>
</div>
<p>3、设置为用户模式，修改频率为480000：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ echo userspace &gt; /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor
root@forlinx~/$ echo 480000 &gt; /sys/devices/system/cpu/cpu0/cpufreq/scaling_setspeed
</pre></div>
</div>
<p>查看修改后当前频率：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ cat /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_cur_freq
480000
</pre></div>
</div>
</section>
<section id="id32">
<h2>4.3  温度测试<a class="headerlink" href="#id32" title="Link to this heading"></a></h2>
<p>查看温度值：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ cat /sys/class/thermal/thermal_zone0/temp
67049
</pre></div>
</div>
<p>温度值即为67℃。</p>
</section>
<section id="ddr">
<h2>4.4  DDR带宽测试<a class="headerlink" href="#ddr" title="Link to this heading"></a></h2>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ memory_bandwidth.sh
</pre></div>
</div>
<p>打印信息如下：</p>
<p><img alt="Image" src="_images/1718935051515_4cf22cea_13e0_4c75_a6e4_7f5adc230a0e.png" /></p>
<p><img alt="Image" src="_images/1718935051744_bbdf2d3d_0ea1_406c_a566_b123b123e4ac.png" /></p>
<p>OKT507-C的DDR3带宽如上图所示，读带宽大约1480M/s，读写带宽大约1000M/s。</p>
</section>
<section id="id33">
<h2>4.5  看门狗测试<a class="headerlink" href="#id33" title="Link to this heading"></a></h2>
<p>看门狗是嵌入式系统中经常用到的功能，OKT507中看门狗的设备节点为/dev/watchdog 。本测试提供了两种测试程序，用户根据实际情况选择一种测试。</p>
<ul class="simple">
<li><p>启动看门狗，设置复位时间10s，并定时喂狗</p></li>
</ul>
<p>使用fltest_watchdog，此命令会打开看门狗并执行喂狗操作，因此系统不会重启</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ fltest_watchdog
Watchdog Ticking Away!
</pre></div>
</div>
<p>使用ctrl+c结束测试程序时，停止喂狗，看门狗处于打开状态，10s后系统复位;</p>
<p>若不想复位，请在结束程序之后10s内输入关闭看门狗命令：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ fltest_watchdog –d                                          //关闭看门狗
</pre></div>
</div>
<ul class="simple">
<li><p>启动看门狗，设置复位时间10s，不喂狗</p></li>
</ul>
<p>执行命令fltest_watchdogrestart, 此命令会打开看门狗，但不执行喂狗操作，系统会在10s后重启.</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ fltest_watchdogrestart
</pre></div>
</div>
</section>
<section id="id34">
<h2>4.6  RTC功能测试<a class="headerlink" href="#id34" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>注意：确保板子上已经安装了纽扣电池，并且电池电压正常</strong></p></li>
</ul>
<p><font style="color:#000000;">RTC 测试，主要通过使用 date 和 hwclock 工具设置软、硬件时间，测试当板子断电再上电的时候，软件时钟读取 RTC 时钟是否同步</font></p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ date -u 072216162021.00	               //设置软件时间
Thu Jul 22 16:16:00 UTC 2021
root@forlinx~/$ hwclock -w					                   //将软件时间同步到硬件时间
root@forlinx~/$ hwclock -r					                   //显示硬件时间
Thu Jul 22 16:16:14 2021  0.000000 seconds
</pre></div>
</div>
<p><font style="color:#000000;">然后给板子断电再上电，进入系统后读取系统时间，可以看到时间已经同步。</font></p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ date
Thu Jul 22 16:16:30 UTC 2021
</pre></div>
</div>
</section>
<section id="id35">
<h2>4.7  按键测试<a class="headerlink" href="#id35" title="Link to this heading"></a></h2>
<p>使用fltest_keytest命令行工具进行按键测试，目前fltest_keytest支持底板上5个按键VOL+、VOL-、MENU、ENTER、HOME的测试，键码分别为115、114、139、28、172。</p>
<p>执行如下命令：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ fltest_keytest
</pre></div>
</div>
<p>此时依次按下抬起按键，终端上可输出如下内容：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>key115 Presse                                                   // VOL+按下
key115 Released                                                 // VOL+抬起
key114 Presse                                                   // VOL-按下
key114 Released                                                 // VOL-抬起
key139 Presse                                                   // MENU按下
key139 Released                                                 // MENU抬起
key28 Presse                                                    // ENTER按下
key28 Released                                                  // ENTER抬起
key172 Presse                                                   // HOME按下
key172 Released                                                 // HOME抬起
</pre></div>
</div>
</section>
<section id="id36">
<h2>4.8  UART测试<a class="headerlink" href="#id36" title="Link to this heading"></a></h2>
<p>OKT507-C开发板设置3个UART口，在开发板上分别为:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p><strong>UART</strong></p></th>
<th class="head text-center"><p><strong>设备节点</strong></p></th>
<th class="head"><p><strong>说明</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>UART0</p></td>
<td class="text-center"><p>/dev/ttyS0</p></td>
<td><p>调试串口，不能直接用于该测试:</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>UART1</p></td>
<td class="text-center"><p>/dev/ttyS1</p></td>
<td><p>用于蓝牙，未单独引出，不能直接用于该测试</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>UART5</p></td>
<td class="text-center"><p>/dev/ttyS5</p></td>
<td><p>TTL电平，P28引出,可用于该测试</p></td>
</tr>
</tbody>
</table>
<p>本次测试采用UART5(ttyS5)，通过开发板的UART和电脑串口工具软件之间的数据收发，来进行串口测试。</p>
<p><img alt="Image" src="_images/1718935052047_b36ea73e_0a86_460e_9008_96211ebee53a.png" /></p>
<p>1、开发板和电脑通过TTL转USB模块连接好后，给开发板上电，在电脑设备管理器查看识别为COM4（用户以自己实际识别的COM口设置参数）</p>
<p><img alt="Image" src="_images/1718935052354_cd87cc7f_4800_4118_882b_ead97952b464.png" /></p>
<p>2、打开电脑串口工具，设置串口参数：波特率115200、8位数据位、1位停止位、无校验、无流控制，并打开串口。</p>
<p><img alt="Image" src="_images/1718935052633_52e13d3b_9335_4a28_b6e9_68f0abae2a92.png" /></p>
<p>在开发板串口中输入如下命令（测试程序固定波特率为115200）：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ fltest_uarttest -d /dev/ttyS5
</pre></div>
</div>
<p>打印信息如下：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>Welcome to uart test
Send test data:
forlinx_uart_test.1234567890...                                             //发送的数据
</pre></div>
</div>
<p>测试程序自动发送“forlinx_uart_test.1234567890…”，此时查看串口助手，接收到该信息：</p>
<p><img alt="Image" src="_images/1718935052941_7da79984_afa6_4db3_950d_5a6693b9b369.png" /></p>
<p>电脑串口工具发送“forlinx_uart_test.1234567890…”，此时开发板接收到信息，相关打印信息如下：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>Welcome to uart test
Send test data:
forlinx_uart_test.1234567890...
Read Test Data finished,Read:
forlinx_uart_test.1234567890...                                             //接收到数据
</pre></div>
</div>
</section>
<section id="gpadc">
<h2>4.9  GPADC测试<a class="headerlink" href="#gpadc" title="Link to this heading"></a></h2>
<p>开发板提供了4路GPADC，电压采样范围0~1.8V，测试可调电阻数值：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ fltest_adc
</pre></div>
</div>
<p><img alt="Image" src="_images/1718935053224_2f45cbcc_3ad4_48da_93d4_909b325c53c0.png" /></p>
</section>
<section id="tf">
<h2>4.10  TF卡测试<a class="headerlink" href="#tf" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>说明：</strong></p></li>
<li><p><strong>SD卡挂载目录为/run/media，支持热插拔，终端会打印关于SD卡的信息。</strong></p></li>
</ul>
<p>1、将TF卡插入开发板底板上的TF卡插槽，正常情况下开发板终端有如下打印信息：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ [ 4421.918947] sunxi-mmc sdc0: sdc set ios:clk 0Hz bm PP pm UP vdd
[ 4421.929301] sunxi-mmc sdc0: no vqmmc,Check if there is regulator
[ 4421.952271] sunxi-mmc sdc0: sdc set ios:clk 400000Hz bm PP pm ON vdd 22 width
[ 4421.978977] sunxi-mmc sdc0: sdc set ios:clk 400000Hz bm PP pm ON vdd 22 width
[ 4421.992246] sunxi-mmc sdc0: sdc set ios:clk 400000Hz bm PP pm ON vdd 22 width
[ 4422.005058] sunxi-mmc sdc0: sdc set ios:clk 400000Hz bm PP pm ON vdd 22 width
[ 4422.018410] sunxi-mmc sdc0: sdc set ios:clk 400000Hz bm PP pm ON vdd 22 width
[ 4422.180865] sunxi-mmc sdc0: sdc set ios:clk 0Hz bm PP pm ON vdd 22 width 1 ti
[ 4422.191179] sunxi-mmc sdc0: no vqmmc,Check if there is regulator
[ 4422.212274] sunxi-mmc sdc0: sdc set ios:clk 400000Hz bm PP pm ON vdd 22 width
[ 4422.232564] mmc1: host does not support reading read-only switch, assuming wr
[ 4422.242331] sunxi-mmc sdc0: sdc set ios:clk 400000Hz bm PP pm ON vdd 22 width
[ 4422.258770] sunxi-mmc sdc0: sdc set ios:clk 400000Hz bm PP pm ON vdd 22 width
[ 4422.269377] sunxi-mmc sdc0: sdc set ios:clk 150000000Hz bm PP pm ON vdd 22 wi
[ 4422.280261] mmc1: new ultra high speed SDR104 SDHC card at address e624
[ 4422.288449] mmcblk1: mmc1:e624 SL16G 14.8 GiB
[ 4422.299543]  mmcblk1: p1
</pre></div>
</div>
<p>2、查看挂载目录：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ ls /run/media                                //列出/run/media目录下的文件
mmcblk0p1   mmcblk1p1
</pre></div>
</div>
<p>3、写入测试：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ dd if=/dev/zero of=/run/media/mmcblk1p1/test bs=1M count=500 conv=fsync
500+0 records in
500+0 records out
524288000 bytes (524 MB, 500 MiB) copied, 28.8519 s, 18.2 MB/s
</pre></div>
</div>
<p>4、读取测试：</p>
<ul class="simple">
<li><p>**注意：**为确保数据准确，请重启开发板后测试读取速度。</p></li>
</ul>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ dd if=/run/media/mmcblk1p1/test of=/dev/null bs=1M
[   27.383663] random: crng init done
500+0 records in
500+0 records out
524288000 bytes (524 MB, 500 MiB) copied, 7.89095 s, 66.4 MB/s
</pre></div>
</div>
<p>5、TF卡使用完成后，在弹出TF卡前，需要使用umount卸载TF</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ umount /run/media/mmcblk1p1
</pre></div>
</div>
<ul class="simple">
<li><p><strong>注意：退出TF卡挂载路径后再插拔TF卡。</strong></p></li>
</ul>
</section>
<section id="emmc">
<h2>4.11  eMMC 测试<a class="headerlink" href="#emmc" title="Link to this heading"></a></h2>
<p>OKT507平台eMMC默认运行于HS400模式100MHz时钟，下面简单测试eMMC的读写速度，以读写ext4文件系统为例。</p>
<p>写入测试：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ dd if=/dev/zero of=/test bs=1M count=500 conv=fsync
500+0 records in
500+0 records out
524288000 bytes (524 MB, 500 MiB) copied, 25.2707 s, 20.7 MB/s
</pre></div>
</div>
<p>读取测试：</p>
<ul class="simple">
<li><p>**注意：**为确保数据准确，请重启开发板后测试读取速度。</p></li>
</ul>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ dd if=/test of=/dev/null bs=1M
500+0 records in
500+0 records out
524288000 bytes (524 MB, 500 MiB) copied, 3.15513 s, 166 MB/s
</pre></div>
</div>
</section>
<section id="usb">
<h2>4.12  USB鼠标测试<a class="headerlink" href="#usb" title="Link to this heading"></a></h2>
<p>将USB鼠标接入OKT507平台的usb接口，串口终端的打印信息如下：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ [  175.241765] sunxi-ehci 5311000.ehci3-controller: ehci_irq: highspeed device connect
[  175.354671] sunxi-ehci 5311000.ehci3-controller: ehci_irq: highspeed device disconnect
[  175.681225] usb 6-1: new low-speed USB device number 2 using sunxi-ohci
[  175.858790] input: USB OPTICAL MOUSE  as /devices/platform/soc/5311000.ohci3-controller/usb6/6-1/6-1:1.0/0003:2188:0AE1.0001/input/input8
[  175.873287] hid-generic 0003:2188:0AE1.0001: input,hidraw0: USB HID v1.11 Mouse [USB OPTICAL MOUSE ] on usb-sunxi-ohci-1/input0
</pre></div>
</div>
<p>此时在屏幕上出现箭头光标，鼠标已可正常使用。</p>
<p>当拔掉usb鼠标时，串口终端打印如下：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ [  897.305810] usb 6-1: USB disconnect, device number 4
evdevmouse: Could not read from input device (No such device)
</pre></div>
</div>
<p>此时屏幕上箭头光标消失，鼠标已成功去除。</p>
</section>
<section id="usb-2-0">
<h2>4.13  USB 2.0<a class="headerlink" href="#usb-2-0" title="Link to this heading"></a></h2>
<p>OKT507支持两个USB2.0接口用户可以在任何一个板载USB HOST接口上连接USB鼠标、USB键盘、U盘等设备，并支持以上设备的热插拔。这里用挂载U盘为例进行演示，目前U盘实际测试支持到32G，32G以上并未测试。</p>
<p>终端会打印关于U盘的信息，由于存在很多种U盘，显示的信息可能会有差别：</p>
<p>1、开发板启动后，连接USB接口u盘到开发板的USB host接口。</p>
<p>串口信息：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ [ 1463.598431] sunxi-ehci 5311000.ehci3-controller: ehci_irq: highspeed device connect
[ 1463.827617] usb 3-1: new high-speed USB device number 6 using sunxi-ehci
[ 1463.977375] usb-storage 3-1:1.0: USB Mass Storage device detected
[ 1463.984721] scsi host0: usb-storage 3-1:1.0
[ 1465.009615] scsi 0:0:0:0: Direct-Access   Generic  MassStorageClass 1536 PQ: 0 ANSI: 6
[ 1465.322727] sd 0:0:0:0: [sda] 31116288 512-byte logical blocks: (15.9 GB/14.8 GiB)
[ 1465.332619] sd 0:0:0:0: [sda] Write Protect is off
[ 1465.338052] sd 0:0:0:0: [sda] Mode Sense: 21 00 00 00
[ 1465.345094] sd 0:0:0:0: [sda] Write cache: disabled, read cache: enabled, doesn&#39;t support DPO or FUA
[ 1465.369092]  sda: sda1
[ 1465.376363] sd 0:0:0:0: [sda] Attached SCSI removable disk
</pre></div>
</div>
<p>2、查看挂载目录：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ ls /run/media/
mmcblk0p1  sda1
</pre></div>
</div>
<p>sda1为第一个插入的USB存储设备的第一个分区，依次类推</p>
<p>3、查看U盘内容：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ ls -l /run/media/sda1
total 8
drwxrwx--- 2 root disk 8192 Sep 23  2021 &#39;System Volume Information&#39;
-rwxrwx--- 1 root disk    0 Apr 25 09:25  test
</pre></div>
</div>
<p>4、写入测试，写入速度受限于具体的存储设备：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ dd if=/dev/zero of=/run/media/sda1/test bs=1M count=500 conv=fsync
500+0 records in
500+0 records out
524288000 bytes (524 MB, 500 MiB) copied, 89.5725 s, 5.9 MB/s
</pre></div>
</div>
<p>5、读取测试：</p>
<ul class="simple">
<li><p>**注意：**为确保数据准确，请重启开发板后测试读取速度。</p></li>
</ul>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ dd if=/run/media/sda1/test of=/dev/null bs=1M
500+0 records in
500+0 records out
524288000 bytes (524 MB, 500 MiB) copied, 15.7525 s, 33.3 MB/s
</pre></div>
</div>
<p>6、U盘使用完成后，在拔出U盘前，需要使用umount卸载</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ umount /run/media/sda1
</pre></div>
</div>
<ul class="simple">
<li><p><strong>注意：退出U盘挂载路径后再插拔U盘。</strong></p></li>
</ul>
</section>
<section id="otg">
<h2>4.14  OTG测试<a class="headerlink" href="#otg" title="Link to this heading"></a></h2>
<p>OKT507-C 包含一个OTG接口，Device模式可以用它来进行刷机，ADB文件传输、调试，Host模式可以插入普通的USB设备。当使用Micro USB线连接OKT507-C至PC时，OKT507-C将自动配置OTG为Device 模式，同样，使用OTG线插入U盘等设备时，系统会自动将OTG配置为Host模式。</p>
<p>Device模式：</p>
<p><img alt="Image" src="_images/1718935053449_15f705af_4829_444a_a296_61cf50b5cf10.png" /></p>
<p>Host模式：</p>
<p><img alt="Image" src="_images/1718935053770_c4773011_ad3d_44a5_8002_ef1bbccf8440.png" /></p>
</section>
<section id="id37">
<h2>4.15  以太网配置<a class="headerlink" href="#id37" title="Link to this heading"></a></h2>
<p>OKT507-C板载一个千兆网卡和一个百兆网卡，插入网线连接网络的情况下，出厂时默认配置千兆网卡为静态IP 192.168.0.232。OKT507-C的网卡可通过配置文件/etc/network/interfaces进行配置。</p>
<section id="ip">
<h3>4.15.1 千兆以太网固定IP方式<a class="headerlink" href="#ip" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>说明：内核中千兆以太网卡为eth0，默认ip为192.168.0.232</strong></p></li>
</ul>
<p>开发板上电，正常启动后，执行如下命令，打开网络配置文件/etc/network/interfaces</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ vi /etc/network/interfaces
</pre></div>
</div>
<p>内容如下（软件版本更新完成后可能会有细微差别，用户以实际信息为准）：</p>
<p>iface：用于指定需要固定IP的网卡；</p>
<p>address：用于指定需要固定的IP地址</p>
<p>netmask：用于设置子网掩码；</p>
<p>gateway：用于指定网关</p>
<p><img alt="Image" src="_images/1718935053984_9f93068e_6741_49d3_aa75_20aaa0ac889d.png" /></p>
<p>用户依据实际情况设置后，保存退出后，使用sync进行同步，重启开发板或者使用ifdown –a和ifup –a指令重新启停配置，配置文件才能生效。</p>
</section>
<section id="id38">
<h3>4.15.2 百兆以太网固定IP方式<a class="headerlink" href="#id38" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>说明：内核中千兆以太网卡为eth1，默认没有配置</strong></p></li>
</ul>
<p>设置方法可参考“<strong>4.15.1 千兆以太网固定IP方式</strong>”，以设置eth1的ip为192.168.1.232为例，修改完后的配置文件如下图：</p>
<p><img alt="Image" src="_images/1718935054166_3555c2b9_b29d_432b_b143_1701dbde174b.png" /></p>
<p>用户依据实际情况设置后，保存退出后，使用sync进行同步，重启开发板或者使用ifdown eth1和ifup eth1指令重新启停配置，配置文件才能生效。</p>
</section>
<section id="id39">
<h3>4.15.3 自动获取IP方法<a class="headerlink" href="#id39" title="Link to this heading"></a></h3>
<p>开发板上电，正常启动后，执行如下命令，打开网络配置文件/etc/network/interfaces</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ vi /etc/network/interfaces
</pre></div>
</div>
<p>去掉address、netmask、gateway属性，修改为如下：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>auto eth0
iface eth0 inet dhcp
auto eth1
iface eth1 inet dhcp
</pre></div>
</div>
<p>修改后的配置文件如下：</p>
<p><img alt="Image" src="_images/1718935054381_94a52915_975a_4ecd_9165_8df2a127b657.png" /></p>
<p>保存退出后，使用sync进行同步，重启开发板后配置文件生效。</p>
</section>
<section id="id40">
<h3>4.15.4 测试以太网网速<a class="headerlink" href="#id40" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>说明：</strong></p></li>
<li><p><strong>本次测试以ubuntu虚拟机做测试服务器，虚拟机的ip为192.168.0.233。</strong></p></li>
<li><p><strong>本次测试默认ubuntu虚拟机已安装iperf3工具。</strong></p></li>
</ul>
<p>通过使用网络速度测试工具iperf3，测试OKT507-C底板eth0/eth1网络速度。在ubuntu虚拟中通过ifconfig指令查看ip地址为192.168.0.233</p>
<p><img alt="Image" src="_images/1718935054599_2110e400_b52e_44ec_97c3_5c2e9cddbc44.png" /></p>
<p>Ubuntu虚拟机在服务器模式下运行：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>forlinx@ubuntu:~$ sudo iperf3 –s
</pre></div>
</div>
<p><img alt="Image" src="_images/1718935054880_914e7d62_2738_4489_b5ca_081246c63880.png" /></p>
<p>1、eth0 千兆网口速度测试</p>
<p>默认出厂eth0的ip为192.168.0.232，在OKT507 串口调试终端输入</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ iperf3 -c 192.168.0.233 -t 60 -i 1         //请根据实际情况填写服务器IP地址
</pre></div>
</div>
<p><img alt="Image" src="_images/1718935055091_17548a55_aeeb_4982_93f2_6f3b9c326343.png" /></p>
<p>OKT507-C 千兆网络传输带宽为811Mb/s</p>
<p>2、eth1 百兆网口速度测试</p>
<p>关闭eth0，将eth1的ip设为192.168.0.232，在OKT507 串口调试终端输入:</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ iperf3 -c 192.168.0.233 -t 60 -i 1         //请根据实际情况填写服务器IP地址
</pre></div>
</div>
<p><img alt="Image" src="_images/1718935055301_1ba5a229_8e96_4c1d_8523_2c287ca2a2e0.png" /></p>
<p>OKT507-C 百兆网络传输带宽为95Mb/s</p>
</section>
</section>
<section id="id41">
<h2>4.16  网络服务<a class="headerlink" href="#id41" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>说明：</strong></p></li>
<li><p><strong>默认eth0的ip为192.168.0.232</strong></p></li>
</ul>
<section id="web">
<h3>4.16.1  Web服务<a class="headerlink" href="#web" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>注意：PC机的ip需要和开发板的ip在同一网段下才可以正常使用该功能。</p></li>
</ul>
<p>OKT507开发板预装了lighttpdweb服务器，并且系统启动时已经自动启动了lighttpd服务，在浏览器中输入开发板的IP 地址即可浏览开发板webserver 中的网页，如下图所示：</p>
<p><img alt="Image" src="_images/1718935055623_f83ba49a_97f2_44bc_8130_edeabee53b84.png" /></p>
</section>
<section id="sftp">
<h3>4.16.2  SFTP<a class="headerlink" href="#sftp" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>安装包路径：OKT507-C（Linux20）用户资料\工具\FileZilla*</p></li>
</ul>
<p>OKT507-C开发板支持 SFTP 服务，系统启动时已自动开启。设置好 IP 地址后就可以作为一台 SFTP 服务器。下面介绍如何利用SFTP工具进行文件传输。</p>
<p>在 windows上安装好filezilla工具，并按照下图所示步骤进行设置。</p>
<p>打开filezilla工具，点击文件，选择站点管理器（site Manager)。</p>
<p><img alt="Image" src="_images/1718935055946_ccabc00f_9328_42dc_94e1_5a0ababe25a1.png" /></p>
<p><img alt="Image" src="_images/1718935056189_ae814f2d_4fa2_46b2_b9d3_a1e0aa174f64.png" /></p>
<p>登录成功后便可以进行上传下载操作。</p>
</section>
</section>
<section id="id42">
<h2>4.17  WIFI 测试<a class="headerlink" href="#id42" title="Link to this heading"></a></h2>
<section id="sta">
<h3>4.17.1  STA模式<a class="headerlink" href="#sta" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>说明：</strong></p></li>
<li><p><strong>由于网络环境的不同，所以在您做本实验时，请根据实际情况进行设置。</strong></p></li>
</ul>
<p>该模式即作为一个站点，连接到无线网络中。以下测试中，路由器采用wpa加密方式，连接的wifi热点名称为：H3C_708_5G，密码为：123456785.。由于网络环境的不同，用户在进行本次测试时，请根据实际情况进行设置：</p>
<p>1、开发板终端中输入如下命令：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ fltest_wifi.sh -i wlan0 -s H3C_708_5G -p 123456785.
</pre></div>
</div>
<p>命令中相关参数含义如下：</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p><strong>参数</strong></p></th>
<th class="head"><p><strong>含义</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>-i</p></td>
<td><p>Wifi设备名称：wlan0</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>-s</p></td>
<td><p>连接的实际wifi热点名称。</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>-p</p></td>
<td><p>后接参数Password指要连接的实际wifi热点的密码；   如果当前热点没有密码，-p后参数写NONE。</p></td>
</tr>
</tbody>
</table>
<p>串口打印如下：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>wifi wlan0
ssid H3C_708_5G
pasw 123456785.
[ 4466.451151] start_addr=(0x8000), end_addr=(0x10000), buffer_size=(0x8000), smp_number_max=(4096)
wpa connect status:SCANNING
wpa connect status:SCANNING
wpa connect status:SCANNING
wpa connect status:SCANNING
wpa connect status:ASSOCIATING
[ 4470.729419] IPv6: ADDRCONF(NETDEV_CHANGE): wlan0: link becomes ready
connect ok
udhcpc: started, v1.29.3
udhcpc: sending discover
udhcpc: sending select for 192.168.1.14
udhcpc: lease of 192.168.1.14 obtained, lease time 86400
deleting routers
adding dns 192.168.1.1
</pre></div>
</div>
<p>2、检查是否能ping外网，在终端中输入如下命令：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ ping -I wlan0 www.baidu.com -c 3                 //指定wlan0网卡ping3次
PING www.baidu.com (220.181.38.150): 56 data bytes
64 bytes from 220.181.38.150: seq=0 ttl=50 time=21.087 ms
64 bytes from 220.181.38.150: seq=1 ttl=50 time=34.342 ms
64 bytes from 220.181.38.150: seq=2 ttl=50 time=14.291 ms

--- www.baidu.com ping statistics ---
3 packets transmitted, 3 packets received, 0% packet loss
round-trip min/avg/max = 14.291/23.240/34.342 ms
</pre></div>
</div>
</section>
<section id="ap">
<h3>4.17.2  AP模式<a class="headerlink" href="#ap" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>说明：</strong></p></li>
<li><p><strong>进行该项测试前需要保证千兆网卡eth0连网，并且网络正常；</strong></p></li>
</ul>
<p>1、查看驱动加载状态，以8821模块为例</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ lsmod
Module               Size      Used by    Tainted: G
8821cs               3198976   0                            
mali_kbase           528384    3
</pre></div>
</div>
<p>没有8821cs需要手动加载</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ insmod /lib/modules/4.9.170/8821cs.ko
</pre></div>
</div>
<p>2、配置热点</p>
<p>WiFi热点名称：wifi_test</p>
<p>密码：12345678</p>
<p>热点名称和密码和通过/etc/hostapd.conf文件查看。</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ fltest_hostapd.sh
Starting dnsmasq: Configuration file: /etc/hostapd.conf
OK
root@forlinx:/# Using interface wlan0 with hwaddr b8:4d:43:09:b3:b6 and ssid &quot;wifi_test&quot;
wlan0: interface state UNINITIALIZED-&gt;ENABLED
wlan0: AP-ENABLED
</pre></div>
</div>
</section>
</section>
<section id="id43">
<h2>4.18  蓝牙测试<a class="headerlink" href="#id43" title="Link to this heading"></a></h2>
<p>OKT507开发板底板的8821CS模块，集成了蓝牙功能，本节演示使用手机与开发板之间通过蓝牙进行文件传输。</p>
<p>1、需要打开WIFI 节点，否则会出现连接失败：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ ifconfig wlan0 up
</pre></div>
</div>
<p>2、蓝牙配置</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ bluetoothctl                                     //打开bluez蓝牙工具
Agent registered
[bluetooth]# power on                                            //启动蓝牙设备
[bluetooth]# [ 4375.679671] rtk_btcoex: Open BTCOEX
[ 4375.961599] Bluetooth: hu ffffffc0789af000 retransmitting 1 pkts
[ 4375.970426] rtk_btcoex: BTCOEX hci_rev 0xaa99
[ 4375.975374] rtk_btcoex: BTCOEX lmp_subver 0x821a
[CHG] Controller 30:95:87:A4:19:39 Class: 0x00100000
Changing power on succeeded
[CHG] Controller 30:95:87:A4:19:39 Powered: yes
[bluetooth]# pairable on                                         //设置为配对模式
Changing pairable on succeeded
[bluetooth]# discoverable on                                     //设置为可发现模式
[bluetooth]# [ 4401.054954] Bluetooth: hu ffffffc0789af000 retransmitting 1 pkts
Changing discoverable on succeeded
[CHG] Controller 30:95:87:A4:19:39 Discoverable: yes
[bluetooth]# agent on                                            //启动代理
Agent is already registered
[bluetooth]# default-agent                                       //设置当前代理为默认
Default agent request successful
[bluetooth]# [ 4588.201588] Bluetooth: hu ffffffc0789af000 retransmitting 1 pkts
[CHG] Controller 30:95:87:A4:19:39 Discoverable: no
</pre></div>
</div>
<p>3、开发板被动配对</p>
<p>经过上述设置后，打开手机蓝牙搜索，会出现一个”BlueZ 5.50”的设备，点击此蓝牙尝试配对</p>
<p><img alt="Image" src="_images/1718935056454_f9fa572b_34da_4455_84b9_4a672ce92f2b.png" /></p>
<p>同时开发板上打印信息如下，输入yes</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>[NEW] Device C4:E1:A1:BA:A4:9E OPPO Reno Ace
[OPPO Reno Ace]# [  574.119213] rtk_btcoex: io capability request
Request confirmation
[agent] Confirm passkey 609166 (yes/no): yes
</pre></div>
</div>
<p>然后手机点击蓝牙进行配对。</p>
<p>查看和移除连接设备：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>[bluetooth]# devices		                                        //查看连接的蓝牙设备
Device C4:E1:A1:BA:A4:9E OPPO Reno Ace
[bluetooth]# remove C4:E1:A1:BA:A4:9E                           //移除设备
</pre></div>
</div>
<p>4、开发板主动配对</p>
<p>除了被动配对，也可以在开发板终端发送主动配对的请求。</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>[bluetooth]# scan on	                                            //搜索可被发现蓝牙
[bluetooth]# [ 4082.935317] Bluetooth: hu ffffffc079071400 retransmitting 1 pkts
[ 4082.945319] rtk_btcoex: hci (periodic)inq start
Discovery started
[CHG] Controller 30:95:87:A4:19:39 Discovering: yes
[NEW] Device 8C:5A:F8:E7:76:0B 8C-5A-F8-E7-76-0B
[NEW] Device 58:85:A2:D0:1A:6C wjy
[NEW] Device C4:E1:A1:BA:A4:9E OPPO Reno Ace
[CHG] Device C4:E1:A1:BA:A4:9E RSSI: -72
[CHG] Device C4:E1:A1:BA:A4:9E RSSI: -60
[bluetooth]# scan off		                                          //停止搜索
[bluetooth]# pair C4:E1:A1:BA:A4:9E                               //配对蓝牙
Attempting to pair with C4:E1:A1:BA:A4:9E
[bluetooth]# [ 4160.081893] Bluetooth: hu ffffffc079071400 retransmitting 1 pkts
[ 4160.090162] rtk_btcoex: hci create connection, start paging
[ 4160.927552] rtk_btcoex: connected, handle 0007, status 0x00
[ 4160.933879] rtk_btcoex: Page success
[ 4160.969754] rtk_btcoex: io capability request
[CHG] Device C4:E1:A1:BA:A4:9E Connected: yes
Request confirmation
[agent] Confirm passkey 206621 (yes/no): yes	                    //口令确认
</pre></div>
</div>
<p>同时手机界面出现配对请求点击配对，板端打印输入yes，手机端接受配对。</p>
<p>5、开发板接收文件</p>
<p>配对成功后，在手机端，可以使用蓝牙发送文件至OKT507-C中。</p>
<p><img alt="Image" src="_images/1718935056697_d3bf8d5c_555b_48b7_92b1_85bee6b12e49.png" /></p>
<p>接收到的文件保存在/root目录。</p>
<p>6、开发板发送文件</p>
<p>同样，可以OKT507-C可以发送文件至手机端，测试方法如下：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ fltest_obexctl.sh		                    //开启fltest_obexctl.sh
[NEW] Client /org/bluez/obex
[obex]# connect C4:E1:A1:BA:A4:9E	                      //连接需要通讯的蓝牙的MAC
……. 此处省略不关键信息
[NEW] Session /org/bluez/obex/client/session0 [default]
[NEW] ObjectPush /org/bluez/obex/client/session0
Connection successful 
[C4:E1:A1:BA:A4:9E]# send /forlinx/media/test.mp3	      //发送文件
</pre></div>
</div>
<p><img alt="Image" src="_images/1718935056980_6b3a368f_01d4_451e_9c5c_ee4713defc5d.png" /></p>
<p>手机将收到传入文件请求，点击接受，进行文件传输。</p>
</section>
<section id="id44">
<h2>4.19  4G测试<a class="headerlink" href="#id44" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>说明：</strong></p></li>
<li><p><strong>驱动支持华为ME909和移远EC20的4G模组。</strong></p></li>
</ul>
<p>OKT507支持4G模块，开发板启动前接入4G模块，安装4G天线，插入SIM卡，启动开发板。以下分别对ME909和EC20进行拨号上网操作。</p>
<section id="me909s4g">
<h3>4.19.1  华为ME909S4G测试<a class="headerlink" href="#me909s4g" title="Link to this heading"></a></h3>
<p>1、连接好模块，开发板和模块上电后，可通过lsusb指令查看USB状态</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ lsusb
Bus 005 Device 001: ID 1d6b:0001
Bus 003 Device 001: ID 1d6b:0002
Bus 002 Device 002: ID 12d1:15c1                               //ME909S的VID和PID
Bus 001 Device 001: ID 1d6b:0002
Bus 006 Device 001: ID 1d6b:0001
Bus 004 Device 001: ID 1d6b:0001
Bus 002 Device 001: ID 1d6b:0002
</pre></div>
</div>
<p>/dev下查看设备节点状态</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ ls /dev/ttyUSB*
/dev/ttyUSB0  /dev/ttyUSB1  /dev/ttyUSB2  /dev/ttyUSB3  /dev/ttyUSB4
</pre></div>
</div>
<p>2、设备识别成功后，可进行拨号上网测试</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ fltest_me909s.sh &amp;
</pre></div>
</div>
<p>打印信息如下：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ fltest_me909s.sh
udhcpc: started, v1.29.3
udhcpc: sending discover
udhcpc: sending select for 10.67.78.149
udhcpc: lease of 10.67.78.149 obtained, lease time 518400
deleting routers
adding dns 111.11.1.3
adding dns 111.11.11.3
</pre></div>
</div>
<p>3、拨号成功后，通过ifconfig查看网络节点为usb0（节点名可能不同，以实际情况为准），通过ping命令测试网络状态：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@imx6ulevk:~# ping -I usb0 www.baidu.com           //指定usb0网卡进行ping测试
PING www.a.shifen.com (39.156.66.18) from 10.3.125.94 eth2: 56(84) bytes of data.
64 bytes from 39.156.66.18: icmp_seq=1 ttl=51 time=62.0 ms
64 bytes from 39.156.66.18: icmp_seq=2 ttl=51 time=48.7 ms
64 bytes from 39.156.66.18: icmp_seq=3 ttl=51 time=93.6 ms
64 bytes from 39.156.66.18: icmp_seq=4 ttl=51 time=82.0 ms
64 bytes from 39.156.66.18: icmp_seq=5 ttl=51 time=91.6 ms
^C                                                   //此处用【Ctil+C】结束ping进程
--- www.a.shifen.com ping statistics ---
5 packets transmitted, 5 received, 0% packet loss, time 20526ms
round-trip min/avg/max = 48.758/75.631/93.652/17.485 ms
</pre></div>
</div>
<p>4、其他SIM APN</p>
<p>修改拨号脚本中的APN</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ vi /usr/bin/fltest_me909s.sh
</pre></div>
</div>
<p><font style="color:#000000;">移动APN：echo “AT^NDISDUP=1,1,”cmnet””&gt; /dev/ttyUSB2 </font></p>
<p><font style="color:#000000;">联通APN：echo “AT^NDISDUP=1,1,”3gnet””&gt; /dev/ttyUSB2</font></p>
<p><font style="color:#000000;">电信APN：echo “AT^NDISDUP=1,1,”ctnet””&gt; /dev/ttyUSB2</font></p>
</section>
<section id="ec20">
<h3>4.19.2  EC20模块测试<a class="headerlink" href="#ec20" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>说明：</strong></p></li>
<li><p><strong>使用物联网卡测试时，需确认模组固件版本，低版本固件不支持，需升级EC20固件</strong></p></li>
<li><p><strong>有些物联网卡拨号时需要设置专用账号和密码，用户需根据实际情况调整指令</strong></p></li>
<li><p><strong>可使用quectel-CM –help指令查看相关参数含义</strong></p></li>
</ul>
<p>1、连接好模块，开发板和模块上电后，可通过lsusb指令查看USB状态</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ lsusb
Bus 005 Device 001: ID 1d6b:0001
Bus 003 Device 001: ID 1d6b:0002
Bus 002 Device 002: ID 2c7c:0125	                                   //EC20的VID和PID
Bus 001 Device 001: ID 1d6b:0002
Bus 006 Device 001: ID 1d6b:0001
Bus 004 Device 001: ID 1d6b:0001
Bus 002 Device 001: ID 1d6b:0002
</pre></div>
</div>
<p>/dev下查看设备节点状态</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ ls /dev/ttyUSB*
/dev/ttyUSB0  /dev/ttyUSB1  /dev/ttyUSB2  /dev/ttyUSB3  
</pre></div>
</div>
<p>2、设备识别成功后，可进行拨号上网测试。ec20.sh会调用quectelCM，具体指令可查看/usr/bin/ec20</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ fltest_ec20.sh &amp;
</pre></div>
</div>
<p>打印信息如下：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>[10-14_10:28:06:667] Quectel_QConnectManager_Linux_V1.6.0.15
[10-14_10:28:06:668] Find /sys/bus/usb/devices/2-1 idVendor=0x2c7c idProduct=0x1                                                                                                              25, bus=0x002, dev=0x002
[10-14_10:28:06:668] Auto find qmichannel = /dev/cdc-wdm0
[10-14_10:28:06:668] Auto find usbnet_adapter = wwan0
[10-14_10:28:06:669] netcard driver = qmi_wwan_q, driver version = 22-Aug-2005
[10-14_10:28:06:669] ioctl(0x89f3, qmap_settings) failed: Operation not supporte                                                                                                              d, rc=-1
[10-14_10:28:06:669] Modem works in QMI mode
[10-14_10:28:06:680] cdc_wdm_fd = 7
[10-14_10:28:06:772] Get clientWDS = 18
[10-14_10:28:06:803] Get clientDMS = 1
[10-14_10:28:06:835] Get clientNAS = 3
[10-14_10:28:06:867] Get clientUIM = 1
[10-14_10:28:06:899] Get clientWDA = 1
[10-14_10:28:06:931] requestBaseBandVersion EC20CEHCR06A02M1G  //打印信息中的版本号为3Mxx不支持物联网卡，5Mxx才支持
[10-14_10:28:07:059] requestGetSIMStatus SIMStatus: SIM_READY
[10-14_10:28:07:091] requestGetProfile[1] 3gnet///0
[10-14_10:28:07:123] requestRegistrationState2 MCC: 460, MNC: 1, PS: Attached, D                                                                                                              ataCap: LTE
[10-14_10:28:07:155] requestQueryDataCall IPv4ConnectionStatus: DISCONNECTED
[10-14_10:28:07:155] ifconfig wwan0 0.0.0.0
[10-14_10:28:07:163] ifconfig wwan0 down
[10-14_10:28:07:219] requestSetupDataCall WdsConnectionIPv4Handle: 0x86ac9e70
[10-14_10:28:07:347] ifconfig wwan0 up
[10-14_10:28:07:356] udhcpc -f -n -q -t 5 -i wwan0
udhcpc: started, v1.29.3
udhcpc: sending discover
udhcpc: sending select for 10.203.238.118
udhcpc: lease of 10.203.238.118 obtained, lease time 7200
[10-14_10:28:07:528] deleting routers
[10-14_10:28:07:556] adding dns 202.99.160.68
[10-14_10:28:07:556] adding dns 202.99.166.4
</pre></div>
</div>
<p>能自动分配ip并添加DNS，则EC20拨号成功。</p>
<p>3、拨号成功后，通过ifconfig查看网络节点为wwan0（节点名可能不同，以实际情况为准），通过ping命令测试网络状态：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ ping -I wwan0 www.forlinx.com
PING www.forlinx.com (211.149.226.120): 56 data bytes
64 bytes from 211.149.226.120: seq=0 ttl=51 time=64.882 ms
64 bytes from 211.149.226.120: seq=1 ttl=51 time=64.636 ms
64 bytes from 211.149.226.120: seq=2 ttl=51 time=63.331 ms
^C                                                    /此处用【Ctil+C】结束ping进程
--- www.forlinx.com ping statistics ---
3 packets transmitted, 3 packets received, 0% packet loss
round-trip min/avg/max = 63.331/64.283/64.882 ms
</pre></div>
</div>
</section>
</section>
<section id="id45">
<h2>4.20  放/录音测试<a class="headerlink" href="#id45" title="Link to this heading"></a></h2>
<p>OKT507提供4个3.5mm音频插口和2个XH-2.54mm喇叭接口。LINE IN和LINE OUT接口由CPU内置codec引出。MIC和HeadPhone和喇叭接口由底板外置codec引出。底板采用WM8960音频芯片，支持左右声道播放声音，和MIC录音。WM8960内部自带的D类功放，Speaker接口可驱动8Ω喇叭，最高输出功率为1W，如果需要外接更大的功放，只能从耳机插座获取信号，不能从喇叭接口获取信号，片上耳机驱动器的输出功率为40mW（16Ω）。</p>
<p>在进行放音测试前，请将准备好的耳机插入听筒接口，或将扬声器插入底板上的对应插槽上，使用fltest_audioplayer命令进行测试； 按下键盘空格可以暂停或开始声音播放，按下键盘上箭头可以切换sink，按下键盘下箭头暂停播放，按下键盘左箭头后退播放4s，按下键盘右箭头快进播放4s。</p>
<section id="hdmi">
<h3>4.20.1 HDMI播放声音<a class="headerlink" href="#hdmi" title="Link to this heading"></a></h3>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ fltest_audioplayer /forlinx/media/test.mp3 -d hdmi  //播放音频文件test.mp3
======================================
|Space  key | start or pause    |
|Down   key | stop            	|
|Left   key | seek backend     	|
|Right  key | seek forward      |
|Up     key | audio sink       	|
======================================
[  181.217985] sunxi-&gt;update_param:1
[  181.221791] HDMI Audio Enable Successfully
[  182.452504] raw_flag value is 0
/forlinx/media/test.mp3 total ms:300016
[mp3 @ 0x40e7690] Could not update timestamps for skipped samples.
</pre></div>
</div>
</section>
<section id="lineout">
<h3>4.20.2 LINEOUT播放声音<a class="headerlink" href="#lineout" title="Link to this heading"></a></h3>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ fltest_audioplayer /forlinx/media/test.mp3 -d codec //播放音频文件test.mp3
======================================
|Space  key | start or pause    |
|Down   key | stop            	|
|Left   key | seek backend     	|
|Right  key | seek forward      |
|Up     key | audio sink       	|
======================================
/forlinx/media/test.mp3 total ms:300016
[mp3 @ 0x294e9690] Could not update timestamps for skipped samples
</pre></div>
</div>
<p><font style="color:#000000;">将耳机插到LINEOUT接口即可在听到声音了</font>。</p>
</section>
<section id="headphone">
<h3>4.20.3 HeadPhone 播放声音<a class="headerlink" href="#headphone" title="Link to this heading"></a></h3>
<p>在进行播放测试前，请将准备好的3.5mm耳机插入HeadPhone接口。使用扬声器播放声音，请将准备好的扬声器SPK_RP、SPKL_N引脚线插在P32或者P31接口。</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ fltest_audioplayer /forlinx/media/test.mp3 -d wm8960 
======================================
|Space  key | start or pause    |
|Down   key | stop              |
|Left   key | seek backend      |
|Right  key | seek forward      |
|Up     key | audio sink        |
======================================
[  403.682008] raw_flag value is 0
/forlinx/media/test.mp3 total ms:300016
[mp3 @ 0x2aab7690] Could not update timestamps for skipped samples.
</pre></div>
</div>
</section>
<section id="mic">
<h3>4.20.4 MIC录音测试<a class="headerlink" href="#mic" title="Link to this heading"></a></h3>
<p>在进行录音测试前，请将准备好的麦克插入mic接口。</p>
<p>1、修改录音时的增益，否则录音会有底噪。</p>
<ul class="simple">
<li><p>WM8960音频芯片：</p></li>
</ul>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx:/# amixer cset name=&#39;Left Input Boost Mixer LINPUT1 Volume&#39; 0,0 -c 3
root@forlinx:/# amixer cset name=&#39;Right Input Boost Mixer RINPUT1 Volume&#39; 0,0 -c 3
</pre></div>
</div>
<ul class="simple">
<li><p>NAU88C22音频芯片：</p></li>
</ul>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx:/# amixer cset name=&#39;PGA Volume&#39; 0,0 -c 3
</pre></div>
</div>
<p>2、录音指令如下：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ tinycap_ahub mic.wav -aD 1 -ad 1 -D 3 -d 0 -t 30 -b 16 -c 2 -p 1024
tinycap save : mic.wav
[  653.147728] raw_flag value is 0
Capturing sample: 2 ch, 44100 hz, 16 bit, malloc buffer:16384
^CCapture finish : Captured 655360 frames				      //此处用【Ctil+C】结束进程
</pre></div>
</div>
<p>即可开始录音，ctrl + c键停止录音，在当前目录下即可看到生成的录音文件mic.wav。</p>
</section>
<section id="id46">
<h3>4.20.5 调节声音大小<a class="headerlink" href="#id46" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>CPU内置codec引出lineout音量设置（默认声音从lineout输出）</p></li>
</ul>
<p>可以使用amixer进行设置：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ amixer sset &#39;LINEOUT volume&#39; 20
</pre></div>
</div>
<p>或者采用tinymix 进行设置：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ tinymix -D 0 4 20                          //设置LINEOUT 音量为20
</pre></div>
</div>
<ul class="simple">
<li><p>WM8960音频芯片引出的mic录音、耳机和喇叭播放音量设置：</p></li>
</ul>
<ol class="arabic simple">
<li><p>mic录音音量：</p></li>
</ol>
<p>可以使用amixer进行设置：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ amixer cset name=&#39;Capture Volume&#39; 50,50 -c 3
</pre></div>
</div>
<p>或者采用tinymix 进行设置：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ tinymix -D 3 0 50 50
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>耳机播放音量：</p></li>
</ol>
<p>可以使用amixer进行设置：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ amixer sset Headphone 101,101 -c 3
</pre></div>
</div>
<p>或者采用tinymix 进行设置：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ tinymix -D 3 10 110 110
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>喇叭播放音量：</p></li>
</ol>
<p>可以使用amixer进行设置：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ amixer sset Speaker Playback Volume 110,110 -c 3
</pre></div>
</div>
<p>或者采用tinymix 进行设置：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ tinymix -D 3 12 127 127
</pre></div>
</div>
<ul class="simple">
<li><p>NAU88C22音频芯片引出的mic录音、耳机和喇叭播放音量设置：</p></li>
</ul>
<ol class="arabic simple">
<li><p>mic录音音量：</p></li>
</ol>
<p>可以使用amixer进行设置：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx:/# amixer cset name=&#39;ADC Volume&#39; 220,220 -c 3
</pre></div>
</div>
<p>或者采用tinymix 进行设置：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx:/# tinymix -D 3 9 220 220
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>耳机播放音量：</p></li>
</ol>
<p>可以使用amixer进行设置：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx:/# amixer sset Headphone 40,40 -c 3
</pre></div>
</div>
<p>或者采用tinymix 进行设置：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx:/# tinymix -D 3 29 40 40
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>喇叭播放音量：</p></li>
</ol>
<p>可以使用amixer进行设置：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx:/# amixer sset Speaker Playback Volume 40,40 -c 3
</pre></div>
</div>
<p>或者采用tinymix 进行设置：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx:/# tinymix -D 3 32 40 40
</pre></div>
</div>
</section>
</section>
<section id="lcd">
<h2>4.21  LCD背光调节<a class="headerlink" href="#lcd" title="Link to this heading"></a></h2>
<p>背光的亮度设置范围为（0–255），255表示亮度最高，0表示关闭背光亮度。进入系统后在终端输入如下命令进行背光测试。</p>
<p>1、查看当前屏幕背光值：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ fltest_backlight get
get current brightness 150                                           //当前背光值为150
</pre></div>
</div>
<p>2、背光熄灭：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ fltest_backlight set 0
set brightness  0,ret 0                                              //关闭背光
</pre></div>
</div>
<p>3、LCD背光亮起：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ fltest_backlight set 125
set brightness  125,ret 0                                            //设置背光值为150
root@forlinx~/$ fltest_backlight get 
get current brightness 125                                           //背光修改成功
</pre></div>
</div>
</section>
<section id="id47">
<h2>4.22  关闭桌面<a class="headerlink" href="#id47" title="Link to this heading"></a></h2>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ /etc/init.d/S60Matrix_Browser stop                     //关闭桌面
root@forlinx~/$ fbinit 0                                               //清屏操作
cleanning /dev/fb0 ...
clean /dev/fb0 finish
root@forlinx~/$ fbinit 1
cleanning /dev/fb1 ...
clean /dev/fb1 finish
root@forlinx~/$ fbinit 2
cleanning /dev/fb2 ...
clean /dev/fb2 finish
</pre></div>
</div>
</section>
<section id="id48">
<h2>4.23  视频播放<a class="headerlink" href="#id48" title="Link to this heading"></a></h2>
<p>测试时，请先关闭桌面测试程序，执行清屏操作，参考“<strong>4.22 关闭桌面</strong>”章节。</p>
<section id="id49">
<h3>4.23.1 独显时视频播放<a class="headerlink" href="#id49" title="Link to this heading"></a></h3>
<p>1、直接执行 xplayerdemo ，播放默认视频。</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx:/# xplayerdemo 
</pre></div>
</div>
<p>2、播放指定视频</p>
<p>在执行应用后的下一个参数写上视频源即可播放</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx:/# xplayerdemo /forlinx/media/1080p_30fps_h265.mp4
</pre></div>
</div>
<p>3、视频缩放和偏移</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx:/# xplayerdemo /forlinx/media/1080p_30fps_h265.mp4 -s 1 -w 800 -h 480 -x 50 -y 50 
</pre></div>
</div>
<p>-s 1表示开启缩放偏移设置</p>
<p>-w -h -x -y 分别表示视频显示的宽、高、显示初始位置的x方向偏移量、显示初始位置的y方向偏移量</p>
<p><img alt="Image" src="_images/1735972219565_a2df3a13_85de_4611_8956_563094e4044d.png" /></p>
<p>4、切换音频输出</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx:/# xplayerdemo /forlinx/media/1080p_30fps_h265.mp4 -a 1
</pre></div>
</div>
<p>-a 1表示选择hdmi未音频输出，-a 0 或默认为底板音频输出</p>
<p>5、视频旋转</p>
<p>Linux系统下旋转桌面通过修改开机环境变量的方式，修改 /etc/env.sh 文件，重启后生效。播放视频，测试旋转效果。</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx:/# vi /etc/profile.d/env.sh
</pre></div>
</div>
<p>注：QT_QPA_EGLFS_ROTATION=90 是桌面顺时针旋转90度，用户根据自己的实际旋转度数。MEDIA_FOLLOWS_QT_ROTATION=1 表示视频会跟随QT的旋转角度旋转。</p>
<p><img alt="Image" src="_images/1735972219641_b561a729_5be9_42e4_b5bf_4eebf89ea7d4.png" /></p>
</section>
<section id="id50">
<h3>4.23.2 双屏显示时视频播放<a class="headerlink" href="#id50" title="Link to this heading"></a></h3>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx:/# xplayerdemo /forlinx/media/1080p_30fps_h265.mp4 -d 2 -s 1 -w 800 -h 480 -x 50 -y 50 -W 1000 -H 800 -X 150 -Y 150 
</pre></div>
</div>
<p>-d 指定显示设备 0为lcd  1为hdmi 2为双屏显示</p>
<p>w h x y分别为 lcd的偏移参数</p>
<p>W H X Y分别为hdmi的偏移参数</p>
<p><img alt="Image" src="_images/1735972219701_f9e1186c_6288_450e_8580_9c01ad5e227d.png" /></p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx:/# xplayerdemo /forlinx/media/1080p_30fps_h265.mp4 -d 0 -s 1 -w 600 -h 440 -x 100 -y 100
</pre></div>
</div>
<p><img alt="Image" src="_images/1735972219800_62205864_09eb_436d_b6d1_6a316cc2db54.png" /></p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx:/# xplayerdemo /forlinx/media/1080p_30fps_h265.mp4 -d 1 -s 1  -W 600 -H 400 -X 150 -Y 150 
</pre></div>
</div>
<p><img alt="Image" src="_images/1735972219875_030967f9_6238_4d48_ab2f_efe5428c5947.png" /></p>
</section>
</section>
<section id="ir">
<h2>4.24  IR测试<a class="headerlink" href="#ir" title="Link to this heading"></a></h2>
<p>OKT507-C底板焊接了一个红外探头，内核默认配置了NEC协议，可以使用支持NEC协议的遥控器进行测试，例如下图所示这类遥控器。</p>
<p><img alt="Image" src="_images/1718935057311_289caf39_e6ac_4338_a1c9_8b407408a216.png" /></p>
<p>测试方法如下：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ evtest
</pre></div>
</div>
<p>选择7 sunxi-ir</p>
<p><img alt="Image" src="_images/1718935057584_f0a26da9_651f_45d7_af6c_1ac80c998add.png" /></p>
<p>按下遥控器按键，将有对应的键值上报。</p>
<p><img alt="Image" src="_images/1718935057851_6f687ee3_7b23_444b_80c6_3a70a1fbc130.png" /></p>
</section>
<section id="led">
<h2>4.25  LED测试<a class="headerlink" href="#led" title="Link to this heading"></a></h2>
<p>OKT507-C核心板有一个可控蓝色LED灯，板卡上电启动时该蓝色LED灯闪烁。若用户关闭该功能，需要修改源码中设备树文件：kernel/linux-4.9/arch/arm64/boot/dts/sunxi/OKT507-C-Common.dtsi，将leds节点属性state = “on”改成”off”、linux,trigger=“heartbeat”改成”none”。</p>
<p><img alt="Image" src="_images/1718935058066_2deb9426_b9cd_4afa_9bf8_1167176fcf5b.png" /></p>
<p>测试方法如下：</p>
<p>1、查看触发条件</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ cat /sys/class/leds/heartbeat/trigger 
none rc-feedback rfkill0 mmc0 mmc1 mmc2 timer oneshot mtd nand-disk [heartbeat] backlight gpio cpu0 cpu1 cpu2 cpu3 default-on
</pre></div>
</div>
<p>其中[heartbeat]表示当前的触发条件为系统心跳灯，往trigger中写上述字符串，可以修改触发条件。</p>
<p>2、用户控制</p>
<p>当led触发条件设置为gpio时，用户可通过命令来控制led灯的亮灭</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ echo gpio &gt; /sys/class/leds/heartbeat/trigger          //设置触发条件为gpio
root@forlinx~/$ echo 1 &gt; /sys/class/leds/heartbeat/brightness          //点亮LED
root@forlinx~/$ echo 0 &gt; /sys/class/leds/heartbeat/brightness          //熄灭LED
</pre></div>
</div>
<p>3、将蓝色LED灯更改为心跳灯</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ echo heartbeat &gt; /sys/class/leds/heartbeat/trigger  //设置触发条件为heartbeat
</pre></div>
</div>
<p>此时LED有系统时钟控制，按一定节奏闪烁。</p>
</section>
<section id="id51">
<h2>4.26  SQLite3测试<a class="headerlink" href="#id51" title="Link to this heading"></a></h2>
<p>SQLite3是一款轻型的数据库，是遵守ACID的关系型数据库管理系统，占用资源低。OKT507-C开发板移植的是3.25.3版本的sqlit3。</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ sqlite3
SQLite version 3.25.3 2018-11-05 20:37:38
Enter &quot;.help&quot; for usage hints.
Connected to a transient in-memory database.
Use &quot;.open FILENAME&quot; to reopen on a persistent database.
sqlite&gt; create table tbl1 (one varchar(10), two smallint);  //创建表tbl1
sqlite&gt; insert into tbl1 values(&#39;hello!&#39;,10);               //tbl1表内插入数据hello!|10
sqlite&gt; insert into tbl1 values(&#39;goodbye&#39;, 20);             //tbl1表内插入数据goodbye|20
sqlite&gt; select * from tbl1;                                 //查询表tbl1中内容
hello!|10
goodbye|20
sqlite&gt; delete from tbl1 where one = &#39;hello!&#39;;              //删除数据
sqlite&gt; select * from tbl1;                                 //查询表tbl1中内容
goodbye|20
sqlite&gt; .quit 			                                        //退出数据库（或使用.exit命令）
root@forlinx~/$
</pre></div>
</div>
</section>
<section id="id52">
<h2>4.27  添加开机自启动脚本<a class="headerlink" href="#id52" title="Link to this heading"></a></h2>
<section id="id53">
<h3>4.27.1  临时添加自启动脚本<a class="headerlink" href="#id53" title="Link to this heading"></a></h3>
<p>1、先创建一个shell脚本：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ vi /usr/bin/while.sh
</pre></div>
</div>
<p>修改文件参考如下（用户需根据实际情况进行修改）：</p>
<p><img alt="Image" src="_images/1718935058318_dd1c9925_74f1_4265_add2_8b0c86dd5bfa.png" /></p>
<p>2、修改完后，保存并退出，给脚本添加执行权限</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ chmod +x /usr/bin/while.sh
</pre></div>
</div>
<p>3、在/etc/init.d/rcS文件尾部添加</p>
<p>/usr/bin/while.sh &amp;</p>
<p>保存退出。</p>
</section>
<section id="id54">
<h3>4.27.2  向烧写镜像里添加自启动脚本<a class="headerlink" href="#id54" title="Link to this heading"></a></h3>
<p>烧写镜像时添加开机自启动脚本，需要在开发环境源码中修改，操作方法如下：</p>
<p>1、进入OKT507-linux-sdk20源码包，在：OKT507-linux-sdk20/platform/framework/auto/rootfs/usr/bin路径下创建shell脚本</p>
<p>格式参考如下，用户根据实际需求修改：</p>
<p><img alt="Image" src="_images/1718935058514_a730d132_d23c_4086_8655_84c43a606db0.png" /></p>
<p>2、使用chmod +x while.sh指令给文件添加执行权限</p>
<p>3、将新创建shell脚本添加到OKT507 根文件系统rcS文件里。</p>
<p>rcS文件在源码包路径：OKT507-linux-sdk20/platform/framework/auto/rootfs/etc/init.d/rcS</p>
<p>在rcS文件尾部添加一条shell语句 ：/usr/bin/while.sh &amp; 。</p>
<p>4、重新编译打包</p>
<p>请参考《OKT507-C_Qt5.12+linux4.9.170用户编译手册_V1.0》编译章节，不在赘述。</p>
</section>
</section>
<section id="a53-coremark">
<h2>4.28  A53 CoreMark测试<a class="headerlink" href="#a53-coremark" title="Link to this heading"></a></h2>
<p>在嵌入式处理器领域最为知名和常见的 Benchmarks 为 Dhrystone 和 CoreMark，CoreMark 是一个综合基准，用于测量嵌入式系统中使用的中央处理器(CPU)的性能。它是在 2009 由 eembc 的 shay gal-on 开发的，旨在成为一个行业标准，取代过时的 dehrystone 基准。</p>
<p>OKT507-C 平台默认已经移植好了 CoreMark 测试程序，您可以使用以下命令进行测试：</p>
<p>1、将 CPU 设置为高性能模式</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ echo performance &gt; /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor
</pre></div>
</div>
<p>2、CoreMark测试</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ coremark.exe
</pre></div>
</div>
<p>打印信息如下：</p>
<p><img alt="Image" src="_images/1718935058709_31b691d9_30aa_4f4a_a90d_e8e5569be8fc.png" /></p>
<p>OKT507-C coremark性能分数为4900</p>
</section>
<section id="a53-dhrystone">
<h2>4.29  A53 Dhrystone测试<a class="headerlink" href="#a53-dhrystone" title="Link to this heading"></a></h2>
<p>Dhrystone 是于 1984 年由 Reinhold P. Weicker 设计的一套综合的基准程序，该程序用来测试 CPU（整数）计算性能。Dhrystone 并不包括浮点运算，其输出结果为每秒钟运行 Dhrystone 的次数，即每秒钟迭代主循环的次数。</p>
<p>OKT507-C 平台已经移植好了 Dhrystone 测试程序，您可以使用以下命令进行测试。</p>
<p>1、将 CPU 设置为高性能模式</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ echo performance &gt; /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor
</pre></div>
</div>
<p>2、dhrystone测试</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ echo 50000000 | dhrystone               //运行50000000次dhrystone测试
</pre></div>
</div>
<p>打印信息如下：</p>
<p><img alt="Image" src="_images/1718935058926_60ddcba9_74be_42d0_9e17_5924b62fa117.png" /></p>
<p>Dhrystone 测试结果：</p>
<p>OKT507-C A53 MIPS速度是4917。</p>
</section>
<section id="id55">
<h2>4.30  OpenGL测试<a class="headerlink" href="#id55" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>注意：</strong></p></li>
<li><p>在进行本节测试前，参考“<strong>4.22 关闭桌面</strong>”章节，先关闭桌面测试程序，执行清屏操作。</p></li>
<li><p>当前版本，在异显模式下不支持HDMI显示。</p></li>
</ul>
<p>OKT507支持OpenGL，测试OpenGL时需要在命令行输入下方命令，进入测试程序。</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ fltest_malitest   
</pre></div>
</div>
<p>测试界面如图所示：</p>
<p><img alt="Image" src="_images/1718935059204_e3269784_d244_468c_9d42_13ab283d94f7.png" /></p>
<p>测试结束后按ctrl + c 退出测试程序。</p>
<p>配置单显模式，对应的屏幕显示上图图片，配置同显模式， LCD/HDMI显示上图图片。</p>
</section>
<section id="demo">
<h2>4.31  车载DEMO测试<a class="headerlink" href="#demo" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>注意：</strong></p></li>
<li><p>当前版本，仅支持LCD显示，暂不支持拍照，且退出信号仅支持SIGINT和SIGQUIT。</p></li>
</ul>
<p>OKT507存在一个车载UI界面的DEMO，测试该DEMO时需要在命令行输入下方命令，进入测试程序。</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ fltest_qt_cameraui     
</pre></div>
</div>
<p>测试界面如图所示：</p>
<p><img alt="Image" src="_images/1718935059513_3629760f_ea6d_44b1_9557_083f468f58dd.png" /></p>
<p>界面左上角点击开始预览，即可显示摄像头预览画面，如上图图片所示。点击<img alt="Image" src="_images/1718935060183_9e288ab2_89d7_4899_8338_5f6b5fd710dd.png" />图标，可切换预览显示使用的摄像头。</p>
<p>测试结束后按ctrl + c 退出测试程序。</p>
</section>
</section>
<section id="id56">
<h1>05_OKT507平台多媒体测试<a class="headerlink" href="#id56" title="Link to this heading"></a></h1>
<p>OKT507平台音视频部分支持硬件编解码。本节所有的示例均是基于命令行形式。如果您需要带界面的播放器，您也可以使用qt的多媒体类，同样支持硬编解，可以参考Qt测试章节。</p>
<p>OKT507平台内部有一个视频处理单元VPU，支持以下格式的视频硬编解：</p>
<p>视频解码： H264,H265最大支持4K&#64;60fps</p>
<p>视频编码： H264，最大支持4K&#64;25fps</p>
<p>OKT507平台硬件解码参数表：</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Video Decoder</p></th>
<th class="head"><p>Format</p></th>
<th class="head"><p>Resolution</p></th>
<th class="head"><p>Frame rate</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p></p></td>
<td><p>H.265</p></td>
<td><p>4K</p></td>
<td><p>60 fps</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p></p></td>
<td><p>AVS2</p></td>
<td><p>4K</p></td>
<td><p>60 fps</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p></p></td>
<td><p>VP9</p></td>
<td><p>4K</p></td>
<td><p>60fps</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Video Encoder</p></td>
<td><p>H.264</p></td>
<td><p>4K</p></td>
<td><p>25 fps</p></td>
</tr>
</tbody>
</table>
<section id="ov5640-mipi">
<h2>5.1  OV5640_MIPI播放测试<a class="headerlink" href="#ov5640-mipi" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>注意：</strong></p></li>
<li><p>在进行本节测试前，参考“<strong>4.22 关闭桌面</strong>”章节，先关闭桌面测试程序，执行清屏操作。</p></li>
<li><p>使用V4L2采集时申请视频buffer需要按照width 和height 16字节对齐计算，DQBUF出队之后需要把多余的数据剪切掉。</p></li>
<li><p>H264编码是按照16字节对齐计算。</p></li>
</ul>
<p>OKT507当前OV5640_MIPI支持分辨率分别有640x480、1280x720、1920x1080、2594x1944。该摄像头识别的设备节点为/dev/video2，本此测试以HDMI作为显示设备。</p>
<ol class="arabic simple">
<li><p>采集测试</p></li>
</ol>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ csi_test_display -f video2 -o 1                //打开设备节点，由HDMI显示
</pre></div>
</div>
<p><img alt="Image" src="_images/1718935069960_d328d794_ad7a_4137_bf21_125ced1d7393.png" /></p>
<p>相关参数说明：</p>
<p><img alt="Image" src="_images/1718935070244_e3005ef8_2050_411c_b0b1_38c6aae9c35d.png" /></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p><strong>参数</strong></p></th>
<th class="head"><p><strong>含义</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>-f</p></td>
<td><p>指定视频设备节点</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>-o</p></td>
<td><p>指定显示设备</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>-w</p></td>
<td><p>设置采集分辨率宽度</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>-h</p></td>
<td><p>设置采集分辨率高度</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>-s</p></td>
<td><p>缩放图像，和-x –y -W -H 一起使用</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>-c</p></td>
<td><p>剪切图像，和-X -Y -W -H 一起使用</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>-L</p></td>
<td><p>图层选择， 0 ~ 3</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>-C</p></td>
<td><p>通道选择，0 ~ 3</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>-Z</p></td>
<td><p>图像显示优先级，高优先级能覆盖低优先级</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>E</p></td>
<td><p>扩展功能 1 拍照 2 采集进行h264编码</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>-?</p></td>
<td><p>打印命令参数说明</p></td>
</tr>
</tbody>
</table>
<ol class="arabic simple" start="2">
<li><p>更改采集分辨率测试</p></li>
</ol>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ csi_test_display -f video2 -o 1 -w 1920 -h 1080
</pre></div>
</div>
<p><img alt="Image" src="_images/1718935070417_46e5db2e_4e83_48b7_8810_e1afa699daa8.png" /></p>
<ol class="arabic simple" start="3">
<li><p>拍照测试</p></li>
</ol>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ csi_test_display -f video2 -o 1 -w 1920 -h 1080 -E 1
</pre></div>
</div>
<p>终端打印信息如下</p>
<p><img alt="Image" src="_images/1718935070612_608cae6a_6046_4faf_b026_aae6b68b5f50.png" /></p>
<p>当显示如上打印时，此时按回车键拍照，打印信息如下：</p>
<p><img alt="Image" src="_images/1718935070819_e7fa24f6_1964_4f54_a1dc_6b251b93b4e7.png" /></p>
<p>如上打印信息时，若按回车键则继续拍照，按Ctrl+c则退出。</p>
<p>图片保存到当前目录，文件名video_sgl_HH_MM_SS.jpg，”HH”代表当前时间小时，MM代表当前分钟，SS代表当前秒，使用window 自带开图工具直接打开。</p>
<ol class="arabic simple" start="4">
<li><p>H264编码测试</p></li>
</ol>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ csi_test_display -f video2 -o 1 -w 1920 -h 1080 -E 2
</pre></div>
</div>
<p>按下回车，终端打印信息如下：</p>
<p><img alt="Image" src="_images/1718935071022_05c7ec22_1e8f_4b7a_81a4_c4cf6c4f9657.png" /></p>
<p>当显示如上打印时，此时按回车键开始编码，打印信息如下：</p>
<p><img alt="Image" src="_images/1718935071255_bb440159_a2e4_4099_87eb_2137044f371f.png" /></p>
<p>再次按下回车，结束编码</p>
<p><img alt="Image" src="_images/1718935071464_f17202b1_7b13_47a5_9a4d_64ba6e31b3ad.png" /></p>
<p>如上打印信息时，若按回车键则继续编码测试，按Ctrl+c则退出。</p>
<p>编码文件保存到当前目录，文件名video_ encode_HH_MM_SS.h264，”HH”代表当前时间小时，MM代表当前分钟，SS代表当前秒，使用windows VLC软件播放。</p>
<ol class="arabic simple" start="5">
<li><p>采集缩放测试</p></li>
</ol>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ csi_test_display -f video2 -s 1 -x 0 -y 0 -W 640 -H 480 -o 1
</pre></div>
</div>
<p><img alt="Image" src="_images/1718935071809_46663802_73f0_40be_a770_136c09e9e118.png" /></p>
</section>
<section id="ov5640-dvp">
<h2>5.2  OV5640_DVP播放测试<a class="headerlink" href="#ov5640-dvp" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>注意：</strong></p></li>
<li><p>在进行本节测试前，参考“<strong>4.22 关闭桌面</strong>”章节，先关闭桌面测试程序，执行清屏操作。</p></li>
<li><p>使用V4L2采集时申请视频buffer需要按照width 和height 16字节对齐计算，DQBUF出队之后需要把多余的数据剪切掉。</p></li>
<li><p>H264编码是按照16字节对齐计算。</p></li>
<li><p>直接运行csi_test_display ，默认使用video0设备，采集分辨率1280x720，LCD屏显示</p></li>
</ul>
<p>OKT507当前OV5640_dvp支持分辨率分别有640x480、1280x720、1920x1080、2594x1944。该摄像头识别的设备节点为/dev/video3，本此测试以HDMI作为显示设备。</p>
<ol class="arabic simple">
<li><p>采集测试</p></li>
</ol>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ csi_test_display -f video3 -o 1                //打开设备节点，由HDMI显示
</pre></div>
</div>
<p><img alt="Image" src="_images/1718935072162_5433d593_8cfb_4436_8bcd_720c6e8171e2.png" /></p>
<p>相关参数说明：</p>
<p><img alt="Image" src="_images/1718935072488_9469ab42_3f13_4801_9da3_1d33d41e445a.png" /></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p><strong>参数</strong></p></th>
<th class="head"><p><strong>含义</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>-f</p></td>
<td><p>指定视频设备节点</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>-o</p></td>
<td><p>指定显示设备</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>-w</p></td>
<td><p>设置采集分辨率宽度</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>-h</p></td>
<td><p>设置采集分辨率高度</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>-s</p></td>
<td><p>缩放图像，和-x –y -W -H 一起使用</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>-c</p></td>
<td><p>剪切图像，和-X -Y -W -H 一起使用</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>-L</p></td>
<td><p>图层选择， 0 ~ 3</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>-C</p></td>
<td><p>通道选择，0 ~ 3</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>-Z</p></td>
<td><p>图像显示优先级，高优先级能覆盖低优先级</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>E</p></td>
<td><p>扩展功能 1 拍照 2 采集进行h264编码</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>-?</p></td>
<td><p>打印命令参数说明</p></td>
</tr>
</tbody>
</table>
<ol class="arabic simple" start="2">
<li><p>更改采集分辨率测试</p></li>
</ol>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ csi_test_display -f video3 -o 1 -w 1920 -h 1080
</pre></div>
</div>
<p><img alt="Image" src="_images/1718935072668_00549ee7_cfbb_4e65_9e03_755d268895b7.png" /></p>
<ol class="arabic simple" start="3">
<li><p>拍照测试</p></li>
</ol>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ csi_test_display -f video3 -o 1 -w 1920 -h 1080 -E 1
</pre></div>
</div>
<p>终端打印信息如下</p>
<p><img alt="Image" src="_images/1718935072867_83d42e4b_6c23_405b_baa1_0cee22ddb708.png" /></p>
<p>当显示如上打印时，此时按回车键拍照，打印信息如下：</p>
<p><img alt="Image" src="_images/1718935073076_f248d960_0a73_4c70_9962_009c35af432a.png" /></p>
<p>如上打印信息时，若按回车键则继续拍照，按Ctrl+c则退出。</p>
<p>图片保存到当前目录，文件名video_sgl_HH_MM_SS.jpg，”HH”代表当前时间小时，MM代表当前分钟，SS代表当前秒，使用window 自带开图工具直接打开。</p>
<ol class="arabic simple" start="4">
<li><p>H264编码测试</p></li>
</ol>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ csi_test_display -f video3 -o 1 -w 1920 -h 1080 -E 2
</pre></div>
</div>
<p>按下回车，终端打印信息如下：</p>
<p><img alt="Image" src="_images/1718935073285_c489f60b_dcc4_436a_b71c_4163994b8e43.png" /></p>
<p>当显示如上打印时，此时按回车键开始编码，打印信息如下：</p>
<p><img alt="Image" src="_images/1718935073529_5016a7db_321a_4a07_9bd3_5b1a1d27f2f5.png" /></p>
<p>再次按下回车，结束编码</p>
<p><img alt="Image" src="_images/1718935073782_6dd5f071_3a43_41dd_b8cb_90d319e494e4.png" /></p>
<p>如上打印信息时，若按回车键则继续编码测试，按Ctrl+c则退出。</p>
<p>编码文件保存到当前目录，文件名video_ encode_HH_MM_SS.h264，”HH”代表当前时间小时，MM代表当前分钟，SS代表当前秒，使用windows VLC软件播放。</p>
<ol class="arabic simple" start="5">
<li><p>采集缩放测试</p></li>
</ol>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ csi_test_display -f video3 -s 1 -x 0 -y 0 -W 640 -H 480 -o 1
</pre></div>
</div>
<p><img alt="Image" src="_images/1718935074091_63c47ce6_1a44_47cd_bfda_e037644b85b4.png" /></p>
</section>
<section id="tp2854m">
<h2>5.3  TP2854M测试<a class="headerlink" href="#tp2854m" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>说明：</strong></p></li>
<li><p>测试时，请先关闭桌面测试程序，执行清屏操作，参考“<strong>4.22 关闭桌面</strong>”章节</p></li>
</ul>
<p>OKT507 出厂默认源码配置MIPI摄像头为OV5640，若支持TP2854M 四合一AHD摄像头，需要通过UBOOT菜单或QT界面UbootMenu应用程序， 修改方法请参考各自对应章节，不在赘述。</p>
<p>测试方法如下，其中 0代表主屏，1代表副屏。独显时，请使用0。</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ mult_video_display -o 0   
</pre></div>
</div>
</section>
<section id="tp2815-tp2855">
<h2>5.4 <font style="color:rgb(51, 51, 51);">TP2815\TP2855测试</font><a class="headerlink" href="#tp2815-tp2855" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong><font style="color:rgb(51, 51, 51);">说明：</font></strong><font style="color:rgb(51, 51, 51);">最新版镜像支持MIPI转4模拟摄像头TP2855以及TP2815。</font></p></li>
<li><p><font style="color:rgb(51, 51, 51);">测试时，请先关闭桌面测试程序，执行清屏操作，参考“</font><strong><font style="color:rgb(51, 51, 51);">4.22 关闭桌面</font></strong><font style="color:rgb(51, 51, 51);">”章节</font></p></li>
</ul>
<p><font style="color:rgb(51, 51, 51);">OKT507 出厂默认源码配置MIPI摄像头为OV5640，若支持TP2815\TP2855 四合一AHD摄像头，需要通过UBOOT菜单， 修改方法请参考各自对应章节，不在赘述。</font></p>
<p><font style="color:rgb(51, 51, 51);">测试方法如下，其中 0代表主屏，1代表副屏。独显时，请使用0。</font></p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ mult_video_display -o 0   
</pre></div>
</div>
</section>
<section id="id57">
<h2>5.5  视频硬编码<a class="headerlink" href="#id57" title="Link to this heading"></a></h2>
<p>OKT507支持H264格式的视频编码，最大支持1080p30fps。</p>
<p>1、H264硬编码</p>
<p>将YUV420SP格式视频编码为H264格式视频：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ encoderTest    
</pre></div>
</div>
<p><img alt="Image" src="_images/1718935074386_a9fb6feb_ee07_46a3_bc37_612ca6d80e38.png" /></p>
<p><img alt="Image" src="_images/1718935074587_c47f0e42_f23e_49cb_9ae4_24ee00346d99.png" /></p>
<p>使用encTest.sh脚本测试H264编码和jpg压缩测试，终端输入以下命令：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ fltest_encTest.sh
</pre></div>
</div>
<p><img alt="Image" src="_images/1718935074789_0315f7df_e376_4715_bd02_ddede5418d1a.png" /></p>
<p><img alt="Image" src="_images/1718935075011_fe4bc166_fa41_4b0c_a861_2175c3a33b00.png" /></p>
</section>
<section id="id58">
<h2>5.6  视频硬解码<a class="headerlink" href="#id58" title="Link to this heading"></a></h2>
<p>OKT507支持 H264，H265、AVS2、VP9视频硬解码，H265最大支持4K&#64;60fps。</p>
<p>OKT507使用mppvideodec组件进行视频硬解码，它的输出格式为：NV21，YV12。</p>
<p>1、H264硬解码</p>
<p>H264格式视频解码之后保存成yv12格式</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ decoderTest -i /forlinx/media/HistoryOfTI-480p.264 -o /h264 -p 4 -f 0 -w 0 -t 1
</pre></div>
</div>
<p><img alt="Image" src="_images/1718935075233_c7835a6e_1d18_4dcd_b157_9f5d537e65c0.png" /></p>
<p>H264格式视频解码之后保存成nv21格式</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ decoderTest -i /forlinx/media/HistoryOfTI-480p.264 -o /h264 -p 5 -f 0 -w 0 -t 1 
</pre></div>
</div>
<p><img alt="Image" src="_images/1718935075412_ddf3e62f_284a_4874_af20_b75b7856ccb7.png" /></p>
<p>2、H265硬解码</p>
<p>H265格式视频解码之后保存成yv12格式：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ decoderTest -i /forlinx/media/TearOfSteel-Short-1280x720.265 -o /h265 -p 4 -f 2 -w 0 -t 1
</pre></div>
</div>
<p><img alt="Image" src="_images/1718935075625_959d9945_a8cd_4e13_8f98_5f36f53f36ad.png" /></p>
<p>H265格式视频解码之后保存成nv21格式：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ decoderTest -i /forlinx/media/TearOfSteel-Short-1280x720.265 -o /h265 -p 5 -f 2 -w 0 -t 1
</pre></div>
</div>
<p><img alt="Image" src="_images/1718935075843_1d3a1174_8667_4ba1_9a02_741c6bc6427a.png" /></p>
<p>3、MPEG硬解码</p>
<p>将jpg格式图片解码成nv21格式视频：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ decoderTest -i /forlinx/media/dogs.jpg -o /dogs -p 5 -f 1 -w 0 -t 1
</pre></div>
</div>
<p><img alt="Image" src="_images/1718935076071_b502b209_bc74_4f04_8559_43b69f08ac46.png" /></p>
<p>将jpg格式图片解码成yv12格式视频：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>root@forlinx~/$ decoderTest -i /forlinx/media/dogs.jpg -o /dogs -p 4 -f 1 -w 0 -t 1
</pre></div>
</div>
<p><img alt="Image" src="_images/1718935076306_48397f43_31f9_4e78_bbfb_89bd71dcc72e.png" /></p>
</section>
</section>
<section id="id59">
<h1>06_烧写系统<a class="headerlink" href="#id59" title="Link to this heading"></a></h1>
<p>OKT507-C开发板目前支持OTG和TF卡两种烧写方式。在用户资料中提供了相应的烧写工具，用户可选择任意一种方式进行镜像烧写。</p>
<section id="id60">
<h2>6.1  烧写所需镜像<a class="headerlink" href="#id60" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>镜像路径：OKT507-C（Linux20）用户资料\镜像</p></li>
</ul>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-center"><p><strong>镜像</strong></p></th>
<th class="head"><p><strong>说明</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>t507_linux_okt507_uart0.img</p></td>
<td><p>出厂默认镜像，支持OV5640_MIPI，不支持TP2854M的测试</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id61">
<h2>6.2  OTG烧写<a class="headerlink" href="#id61" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>说明：OTG烧写过程拨码开关设置为1001（拨码开关设置参考“<strong>1.3  烧写及启动设置</strong>”章节）</p></li>
</ul>
<section id="id62">
<h3>6.2.1  OTG驱动安装<a class="headerlink" href="#id62" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>说明：该驱动为电脑本身自带驱动，若电脑不能自动安装，可参考该章节进行安装</strong>。</p></li>
<li><p>驱动路径：OKT507-C（Linux20）用户资料\工具\USBDriver.zip(USBDriver_64.zip)</p></li>
</ul>
<p>将USBDriver.zip(32位系统)或者USBDriver_64.zip(64位系统)解压到桌面并解压。</p>
<p>使用Micro USB线连接开发板和主机，先按住FEL键不要松开然后按RESET键系统复位，先松开RESET键，大约两秒后松开FEL键。</p>
<ul class="simple">
<li><p>**注意：一定要先松RESET键，再松开FEL键。 **</p></li>
</ul>
<p>打开windows设备管理器，发现有黄色感叹号未知设备</p>
<p>如下界面所示</p>
<p><img alt="Image" src="_images/1718935086047_df000e68_ff22_4aaf_8cb8_51b8f5766c50.png" /></p>
<p>右键点击”未知设备”🡪“更新驱动”</p>
<p>在如下界面中，点击”浏览我的电脑以查找驱动程序”</p>
<p><img alt="Image" src="_images/1718935086774_8b3af300_8213_4b97_b4e3_48b74a0b2692.png" /></p>
<p>在如下界面中，选择刚才解压USBDriver_64目录</p>
<p><img alt="Image" src="_images/1718935087014_ad5f2843_5ba5_4d6f_8051_c9b5f59fc66c.png" /></p>
<p>点击”下一步”等待驱动安装完成。</p>
<p>如下界面所示</p>
<p><img alt="Image" src="_images/1718935087337_0edda707_b144_4ae2_a776_8510c2e63c6b.png" /></p>
</section>
<section id="id63">
<h3>6.2.2  OTG 烧写方法<a class="headerlink" href="#id63" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>烧写工具路径：OKT507-C（Linux20）用户资料\Linux\工具\PhoenixSuit_v1.13.zip</p></li>
</ul>
<p>1、OTG完全烧写测试</p>
<p>该烧写方式会将整个img镜像进行烧录。</p>
<p>将用户资料工具目录的PhoenixSuit_v1.13.zip拷贝到windows任意目录，双击PhoenixSuit_v1.13目录里PhoenixSuit.exe文件</p>
<p>如下界面所示</p>
<p><img alt="Image" src="_images/1718935087637_53550b55_1633_4a16_9319_e9ab8019eaf6.png" /></p>
<p>在如下界面中， 点击”一键刷机” 再点击”浏览” 选择固件镜像文件</p>
<p><img alt="Image" src="_images/1718935088043_6a8b05fe_2a04_4b8c_841d_724e21516230.png" /></p>
<p>使用Micro USB线连接开发板和主机，给板子供电，同时按下FEL键和RESET键，先松开RESET键，在松开FEL键。</p>
<ul class="simple">
<li><p><strong>注意：一定要先松RESET键，再松开FEL键。</strong></p></li>
</ul>
<p>在如下界面中，点击”是” 进入格式化升级模式</p>
<p><img alt="Image" src="_images/1718935088505_c2f0cd0f_f916_43f4_b0e3_41ecd63a8ec8.png" /></p>
<p>等待烧写完成，烧写完成弹出如下界面</p>
<p><img alt="Image" src="_images/1718935088877_e646a29f_5003_4bc9_a308_d9ceb66b3ab3.png" /></p>
<p>烧写完成拔掉Micro USB USB线，将BOOT拨码开关拨成1001，上电启动OKT507板卡。</p>
<p>2、单独更新镜像</p>
<p>1）OTG uboot单独烧写测试</p>
<p>在如下界面中， 勾选复选框”单或多分区下载(勾选此项，刷机工具下载你选择的分区)”，勾选”BOOT-RESOURCE”和”ENV” 复选框</p>
<p><img alt="Image" src="_images/1718935089180_e69940d8_ebdf_4f98_ba9b_f16b20c07775.png" /></p>
<p>使用Micro USB线连接开发板和主机，给板子供电，同时按下FEL键和RESET键，先松开RESET键，在松开FEL键。等待烧写，烧写完成弹出如下界面：</p>
<ul class="simple">
<li><p><strong>注意：一定要先松RESET键，再松开FEL键。</strong></p></li>
</ul>
<p><img alt="Image" src="_images/1718935089513_65853084_5e15_4185_b75f_4ea690c1efd2.png" /></p>
<p>2）OTG 烧写内核镜像以及设备树dtb文件</p>
<p>在如下界面中， 勾选复选框”单或多分区下载(勾选此项，刷机工具下载你选择的分区)”，勾选”BOOT”</p>
<p><img alt="Image" src="_images/1718935089844_05b0cf91_3645_47b6_8de7_1cd5f6773d41.png" /></p>
<p>使用Micro USB线连接开发板和主机，给板子供电，同时按下FEL键和RESET键，先松开RESET键，在松开FEL键。等待烧写，烧写完成弹出如下界面：</p>
<ul class="simple">
<li><p><strong>注意：一定要先松RESET键，再松开FEL键。</strong></p></li>
</ul>
<p><img alt="Image" src="_images/1718935090152_023a1b25_2e72_4d1d_b683_177d5a939e49.png" /></p>
<p>3） OTG 烧写文件系统</p>
<p>在如下界面中， 勾选复选框”单或多分区下载(勾选此项，刷机工具下载你选择的分区)”，勾选”ROOTFS”</p>
<p><img alt="Image" src="_images/1718935090475_4d136f97_b3d0_4695_81a6_6c1a834a3a8b.png" /></p>
<p>使用Micro USB线连接开发板和主机，给板子供电，同时按下FEL键和RESET键，先松开RESET键，在松开FEL键。等待烧写，烧写完成弹出如下界面：</p>
<ul class="simple">
<li><p><strong>注意：一定要先松RESET键，再松开FEL键。</strong></p></li>
</ul>
<p><img alt="Image" src="_images/1718935090712_6253cbeb_8c7a_4a0c_bd12_ac3dbeb84bc9.png" /></p>
</section>
<section id="id64">
<h3>6.2.3  OTG 烧写常见问题<a class="headerlink" href="#id64" title="Link to this heading"></a></h3>
<p>1、驱动安装不成功</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>有些用户按照手册中的方法安装完USB驱动后，仍显示未知设备，点开未知设备后有第三方 INF不包含数字签名信息的信息，如下图：
</pre></div>
</div>
<p><img alt="Image" src="_images/1718935090984_cb31c68b_8d34_4cbc_ae0d_e2ddf7a6dbf6.png" /></p>
<p>这是由于有些windows系统为了不让第三方程序影响系统稳定性，导致部分未签名驱动无法通过验证，导致驱动安装失败。用户需要先对电脑禁用驱动程序强制签名设置，然后在安装手册方法进行驱动安装。</p>
<p>2、RESET和FEL按键使用不当</p>
<p>烧写时，需要同时按下RESET键和FEL键，松开的时候，先松开RESET键，然后松开FEL键。</p>
</section>
</section>
<section id="id65">
<h2>6.3  TF卡烧写<a class="headerlink" href="#id65" title="Link to this heading"></a></h2>
<section id="id66">
<h3>6.3.1  制作TF烧写卡<a class="headerlink" href="#id66" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>制卡工具路径：OKT507-C（Linux20）用户资料\Linux\工具\PhoenixCard_V4.1.9.zip</p></li>
</ul>
<p>1、通过读卡器把容量大小为8GB/16GB/32GB TF卡插入PC机 USB接口上。</p>
<p>2、将制卡工具PhoenixCard_V4.1.9.zip拷贝到windows任意目录，双击PhoenixCard_V4.1.9目录里PhoenixCard.exe文件。</p>
<p>如下界面所示：</p>
<p><img alt="Image" src="_images/1718935091242_7bbd03ac_677a_4f77_907b_cebe24c5319a.png" /></p>
<ul class="simple">
<li><p>**注意：**当TF卡存在多个分区时，请先点击”恢复卡”，在点击“烧卡”，否则可能烧卡失败。</p></li>
</ul>
<p>3、点击”固件”浏览OKT507固件镜像，选择”量产卡”，点击”烧卡”。</p>
<p>等待烧写完成，如下界面所示：</p>
<p><img alt="Image" src="_images/1718935091466_0e9dd3ef_d9d1_47a2_bf6c_003550b51cf7.png" /></p>
</section>
<section id="id67">
<h3>6.3.2  TF卡烧写方法<a class="headerlink" href="#id67" title="Link to this heading"></a></h3>
<p>1、将TF卡插入开发板并将BOOT拨码开关拨成0000，上电启动板卡，系统将自动进入烧写流程。（拨码开关设置参考“<strong>1.3  烧写及启动设置</strong>”章节）。</p>
<p>烧写完成后屏幕和串口都将提示：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>CARD  OK
[129.829]sprite  success
Sprite_next_work=3
Next  work  3
SUNXI_UPDATE_NEXT_ACTION_SHUTDOWN
[132.837][mmc]: mmc  exit  start
[132.856][mmc]: mmc  2  exit  ok
</pre></div>
</div>
<p>2、拔出TF卡，将BOOT拨码开关拨成1001，上电启动板卡，即可启动系统。</p>
<p>批量生产时，可以根据核心板的绿灯来判断烧写是否完成，烧写过程中的绿灯变化如下：</p>
<ul class="simple">
<li><p>烧写准备阶段：核心板绿灯，常亮。</p></li>
<li><p>烧写完成阶段：核心板绿灯，熄灭。</p></li>
</ul>
<p>3、TF卡还原</p>
<p>将TF卡插入windows主机中，以管理员身份运行PhoenixCard.exe。</p>
<p><img alt="Image" src="_images/1718935091725_5c1a1472_03b6_4dae_b3c6_06446f4becb9.png" /></p>
<p>点击”恢复卡”，将烧写TF卡恢复成普通的TF卡。</p>
</section>
</section>
</section>
<section id="logo">
<h1>附录1：更换开机静态Logo和动画<a class="headerlink" href="#logo" title="Link to this heading"></a></h1>
<p>OKT507平台的开机logo分为两个阶段，分别为u-boot阶段的logo和内核阶段的logo，两者采用的是同一个logo图片，可以无缝衔接。</p>
<p>如果需要更换开机logo只需要替换longan/device/config/chips/t507/boot-resource/boot-resource/bootlogo.bmp，如果logo的尺寸小于屏幕尺寸将在其余空白处填充黑色背景，为了避免图像放大失真或者周围的黑色填充，您可以选择与屏幕尺寸相同的logo图片。</p>
<p>更换完OKT507开机静态logo，需要重新编译打包。</p>
<p>配置编译环境</p>
<p>进入longan目录，执行以下命令：</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>$ cd longan
$ ./build.sh config
</pre></div>
</div>
<p><img alt="Image" src="_images/1718935097711_631caff4_c9d1_42dc_af3b_9978d48ae96f.png" /></p>
<p>终端输入1，选择linux。</p>
<p>选择IC平台</p>
<p><img alt="Image" src="_images/1718935097884_e9de574e_5778_4471_846a_4e6c327c4e62.png" /></p>
<p>终端输入0，选择okt507。</p>
<p>选择闪存启动方式</p>
<p><img alt="Image" src="_images/1718935098152_e391c2e1_c0cc_4cdb_8c0a_f4e1402e6c79.png" /></p>
<p>终端输入0,选择default。</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>$ ./build.sh
$ ./build.sh pack
</pre></div>
</div>
<p>烧写固件longan/out/t507_linux_okt507_uart0.img即可。</p>
<p>注意：logo的尺寸不能大于设备树中的fbX_width和fbX_height属性值。</p>
<p>在kernel/linux-4.9/arch/arm64/boot/dts/sunxi/OKT507-C-Linux.dts中的设备树中，设置fbX_widht和fbX_height属性值，如下图：</p>
<p><img alt="Image" src="_images/1718935098375_dbc95bd2_4bce_4dd5_943f_be7d3ebdc7c1.png" /></p>
</section>
<section id="ubootgpio">
<h1>附录2：uboot阶段的GPIO配置<a class="headerlink" href="#ubootgpio" title="Link to this heading"></a></h1>
<p>如果您需要在uboot阶段设置GPIO输出高低电平，可以在设备树中进行配置，可参考飞凌的LVDS的电源引脚。</p>
<p><img alt="Image" src="_images/1718935103499_77befb4c_989f_46fa_a5f0_3baa078354a5.png" /></p>
<p><img alt="Image" src="_images/1718935103789_e5e8d468_567e_4d14_9362_ab2fbb8c1d4c.png" /></p>
<p>目前支持gpio0-gpio31共计2个引脚进行配置。关于pinctrl的含义请参考网盘资料\原厂资料目录的《T507_pinctrl接口使用说明文档.pdf》。</p>
</section>
<section id="id68">
<h1>附录3：修改分区<a class="headerlink" href="#id68" title="Link to this heading"></a></h1>
<p>您可以修改longan20/device/product/configs/okt507/longan/sys_partition.fex文件的内容来修改现有分区大小或者添加新的分区。注意，此文件中的size单位为扇区，一个扇区大小为512字节。下面是修改和添加分区的示例。</p>
<p>修改现有rootfs分区大小为4GB，4<em>1024</em>1024*1024/512=8388608。只需将size修改为8388608扇区并重新编译文件系统并烧写即可。</p>
<p><img alt="Image" src="_images/1718935107709_b459222f_f637_4bd8_af6a_38fc67930767.png" /></p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>$ cd longan
$ rm -rf ./out/pack
$ ./build.sh
$ ./build.sh pack
</pre></div>
</div>
<p>烧写固件longan/out/t507_linux_okt507_uart0.img即可。</p>
<p>添加新的分区private大小为1GB，。在rootfs下方添加新的条目并计算好扇区数目。注意：分区大小总和不可超过eMMC容量，且分区大小最好保证为16M的整数倍。随后重新编译并烧写即可。</p>
<p><img alt="Image" src="_images/1718935107886_2aa49d8a_fb55_440f_874a_0b4478a1ebb5.png" /></p>
</section>
<section id="id69">
<h1>附录4：添加新文件到文件系统<a class="headerlink" href="#id69" title="Link to this heading"></a></h1>
<p>您可以通过向longan/platform/framework/auto/rootf/目录添加内容来添加新文件到文件系统。longan/platform/framework/auto/rootf/目录下的内容会被拷贝到longan/out/t507/okt507/longan/buildroot/target目录，随后此目录中的内容会被打包为根文件系统。</p>
<p>将您想要添加到文件系统的文件拷贝到longan20/platform/framework/auto/rootf/目录，随后编译rootfs并打包。</p>
<div class="highlight-plain notranslate"><div class="highlight"><pre><span></span>$ cd longan
$ cp XXX platform/framework/auto/rootf/
$ ./build.sh rootfs
$ ./build.sh pack
</pre></div>
</div>
<p>最后烧写固件longan/out/t507_linux_okt507_uart0.img即可。</p>
<ul class="simple">
<li><p><strong>注意：</strong></p></li>
<li><p>当前暂不支持使用脚本自动删除拷贝到longan/out/t507/okt507/longan/buildroot/target目录中的内容，需要用户手动删除。</p></li>
<li><p>XXX 代表需要拷贝的文件或者目录</p></li>
</ul>
</section>


           </div>
          </div>
          <div class="forlinx-footer-social" style="margin-top: 15px; padding: 0 16px;">
  <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">

    <!-- 左侧版权信息 -->
    <span style="font-size: 14px; color: #444;">
      © <a href="https://www.forlinx.net/" target="_blank" style="color: inherit; text-decoration: none;">Forlinx Embedded</a>
    </span>

    <!-- 右侧社交图标 -->
    <div>
      <a href="https://www.facebook.com/Forlinx-Embedded-177890724336237" target="_blank">
        <i class="fab fa-facebook fa-lg" style="margin: 0 6px; color:#3b5998;"></i>
      </a>
      <a href="https://www.linkedin.com/company/forlinx-embedded-technology-co-ltd/" target="_blank">
        <i class="fab fa-linkedin fa-lg" style="margin: 0 6px; color:#0077b5;"></i>
      </a>
      <a href="https://x.com/ForlinxOfficial" target="_blank">
        <i class="fab fa-x-twitter fa-lg" style="margin: 0 6px; color:#000;"></i>
      </a>
      <a href="https://www.youtube.com/@forlinxembedded" target="_blank">
        <i class="fab fa-youtube fa-lg" style="margin: 0 6px; color:#FF0000;"></i>
      </a>
      <a href="https://github.com/ForlinxEmbedded" target="_blank">
        <i class="fab fa-github fa-lg" style="margin: 0 6px; color:#333;"></i>
      </a>
      <a href="https://www.forlinx.net/" target="_blank">
        <i class="fas fa-globe fa-lg" style="margin: 0 6px; color:#2274A5;"></i>
      </a>
    </div>

  </div>
</div>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>